[
  {
    "objectID": "dms-viz/viz-description.html",
    "href": "dms-viz/viz-description.html",
    "title": "CHIKV p62 DMS Structures",
    "section": "",
    "text": "The study utilized to generate these visualizations can be found at the following reference:\nDeep mutationally scanned (DMS) CHIKV E3/E2 virus library maps viral amino acid preferences and predicts viral escape mutants of neutralizing CHIKV antibodies\nMegan M. Stumpf, Tonya Brunetti, Bennett J. Davenport, Tonya Brunetti, Thomas E. Morrison\nThe associated code and analysis used to generate these files can be found on GitHub here.\nIn brief, full-length chikungunya virus (CHIKV) strain AF15561 was mutagenized using deep mutational scanning, specifically by mutating just the ectodomain of the E3/E2 (‘p62’) surface glycoprotein complex. The virus library was then generated under various selective processes (see Manuscript) and challenged against individual monoclonal antibodies (mAbs) to determine functional neutralization escape for each mAb.\n\n\n\nPDB: 3J2W | CHIKV E2/E1 Trimer (without E3)\nPDB: 3N42 | p62/E1 Heterodimer (containing E3)\n\nNote: Currently no CHIKV trimeric structures have been visualized containing E3. To view E3, select visualizations using PDB 3N42.\nNote: All numbering across all visualizations represents p62 numbering (includes the 64 residues of E3).\n\n\n\n\nTo visualize the mutational tolerance of CHIKV to individual mutations in p62, the number of detected amino acids (ndet) at each position in p62 was calculated following transfection of a mutagenized plasmid library in HEK293 cells, as well as adsorption of the transfection viral supernatant onto Vero81 cells.\n\n\n\n\n\nThe monoclonal antibodies (mAbs) utilized to validate the CHIKV-p62-DMS virus library are CHK-11, CHK-152, and CHK-265. MAb escape scores can be found by either A) hovering over each residue in a site of interest in all 'ndet' files, or B) selecting each individual mAb escape file (i.e., CHK-11 Escape (3J2W)). To view the escape scores plotted on each CHIKV structure, make sure to select each escape file individually.\n\n\n\n\nNote: Modification of metric settings will result in differences in interpretation of findings and should be considered carefully when drawing conclusions.\n\n\n\n\nClick 'Select All Sites' to activate the heatmap for the entire E2/p62 region for the entire trimer for chikv_all.json. When viewing the JSON containing the different domains, chikv_all_domain.json click 'Select All Sites' then select the domain of interest from the “Domain” dropdown.\nBy default, the Summary Metric will correspond to the SUM of AA detected. Because 'ndet' is a binary metric in the dataset for each possible residue at each site, SUM will report the total number of AA detected at each p62 position.\nNote: Not all mutagenized p62 sites are available in each protein structure. For detailed information on sites not shown here, please refer to the manuscript and/or GitHub repository data.\n\n\n\n\n\n\nClick 'Select All Sites' to activate the heatmap for the entire E2/p62 region for the entire trimer for chikv_all.json. When viewing the JSON containing the different domains, chikv_all_domain.json click 'Select All Sites' then select the domain of interest from the “Domain” dropdown.\nBy default, the Summary Metric will correspond to the SUM of mutdiffsel scores for all mutants at that site. Because 'mutdiffsel' can be a positive (escape) or negative (depletion) score, the default Floor setting for these maps is set to TRUE, mapping only sites with a net-positive site escape score.\nTo view both positively- and negatively-depleted site scores, please uncheck Floor from the CHART OPTIONS settings.\nTo see the 'ndet' value for a site without swapping files, hover over any residue at your site of interest for the AA Detected value for that site.\nNote: Not all mutagenized p62 sites are available in each protein structure. For detailed information on sites not shown here, please refer to the manuscript and/or GitHub repository data."
  },
  {
    "objectID": "dms-viz/viz-description.html#study-design",
    "href": "dms-viz/viz-description.html#study-design",
    "title": "CHIKV p62 DMS Structures",
    "section": "",
    "text": "The study utilized to generate these visualizations can be found at the following reference:\nDeep mutationally scanned (DMS) CHIKV E3/E2 virus library maps viral amino acid preferences and predicts viral escape mutants of neutralizing CHIKV antibodies\nMegan M. Stumpf, Tonya Brunetti, Bennett J. Davenport, Tonya Brunetti, Thomas E. Morrison\nThe associated code and analysis used to generate these files can be found on GitHub here.\nIn brief, full-length chikungunya virus (CHIKV) strain AF15561 was mutagenized using deep mutational scanning, specifically by mutating just the ectodomain of the E3/E2 (‘p62’) surface glycoprotein complex. The virus library was then generated under various selective processes (see Manuscript) and challenged against individual monoclonal antibodies (mAbs) to determine functional neutralization escape for each mAb.\n\n\n\nPDB: 3J2W | CHIKV E2/E1 Trimer (without E3)\nPDB: 3N42 | p62/E1 Heterodimer (containing E3)\n\nNote: Currently no CHIKV trimeric structures have been visualized containing E3. To view E3, select visualizations using PDB 3N42.\nNote: All numbering across all visualizations represents p62 numbering (includes the 64 residues of E3)."
  },
  {
    "objectID": "dms-viz/viz-description.html#mutational-tolerance-of-chikv-p62",
    "href": "dms-viz/viz-description.html#mutational-tolerance-of-chikv-p62",
    "title": "CHIKV p62 DMS Structures",
    "section": "",
    "text": "To visualize the mutational tolerance of CHIKV to individual mutations in p62, the number of detected amino acids (ndet) at each position in p62 was calculated following transfection of a mutagenized plasmid library in HEK293 cells, as well as adsorption of the transfection viral supernatant onto Vero81 cells."
  },
  {
    "objectID": "dms-viz/viz-description.html#differential-selection-of-chikv-p62-by-mabs",
    "href": "dms-viz/viz-description.html#differential-selection-of-chikv-p62-by-mabs",
    "title": "CHIKV p62 DMS Structures",
    "section": "",
    "text": "The monoclonal antibodies (mAbs) utilized to validate the CHIKV-p62-DMS virus library are CHK-11, CHK-152, and CHK-265. MAb escape scores can be found by either A) hovering over each residue in a site of interest in all 'ndet' files, or B) selecting each individual mAb escape file (i.e., CHK-11 Escape (3J2W)). To view the escape scores plotted on each CHIKV structure, make sure to select each escape file individually."
  },
  {
    "objectID": "dms-viz/viz-description.html#navigating-dms-viz",
    "href": "dms-viz/viz-description.html#navigating-dms-viz",
    "title": "CHIKV p62 DMS Structures",
    "section": "",
    "text": "Note: Modification of metric settings will result in differences in interpretation of findings and should be considered carefully when drawing conclusions.\n\n\n\n\nClick 'Select All Sites' to activate the heatmap for the entire E2/p62 region for the entire trimer for chikv_all.json. When viewing the JSON containing the different domains, chikv_all_domain.json click 'Select All Sites' then select the domain of interest from the “Domain” dropdown.\nBy default, the Summary Metric will correspond to the SUM of AA detected. Because 'ndet' is a binary metric in the dataset for each possible residue at each site, SUM will report the total number of AA detected at each p62 position.\nNote: Not all mutagenized p62 sites are available in each protein structure. For detailed information on sites not shown here, please refer to the manuscript and/or GitHub repository data.\n\n\n\n\n\n\nClick 'Select All Sites' to activate the heatmap for the entire E2/p62 region for the entire trimer for chikv_all.json. When viewing the JSON containing the different domains, chikv_all_domain.json click 'Select All Sites' then select the domain of interest from the “Domain” dropdown.\nBy default, the Summary Metric will correspond to the SUM of mutdiffsel scores for all mutants at that site. Because 'mutdiffsel' can be a positive (escape) or negative (depletion) score, the default Floor setting for these maps is set to TRUE, mapping only sites with a net-positive site escape score.\nTo view both positively- and negatively-depleted site scores, please uncheck Floor from the CHART OPTIONS settings.\nTo see the 'ndet' value for a site without swapping files, hover over any residue at your site of interest for the AA Detected value for that site.\nNote: Not all mutagenized p62 sites are available in each protein structure. For detailed information on sites not shown here, please refer to the manuscript and/or GitHub repository data."
  },
  {
    "objectID": "docs/index.html",
    "href": "docs/index.html",
    "title": "Deep mutationally scanned (DMS) CHIKV E3/E2 virus library maps viral amino acid preferences and predicts viral escape mutants of neutralizing CHIKV antibodies",
    "section": "",
    "text": "Introduction\n  1 Software Requirements\n  2 Analysis Pipeline\n  3 Sample Preparation\n  4 Library Preparation\n  5 Read Preparation and Analysis\n  \n  5.1 FastQC/MultiQC/CutAdapt\n  5.2 VirVarSeq\n  5.3 \\(ndet\\)\n  5.4 \\(neff\\)\n  5.5 megalogo\n  5.6 batchdiffsel\n  5.7 dmslogo\n  5.8 dms-viz\n  \n  Citation"
  },
  {
    "objectID": "docs/index.html#introduction",
    "href": "docs/index.html#introduction",
    "title": "Deep mutationally scanned (DMS) CHIKV E3/E2 virus library maps viral amino acid preferences and predicts viral escape mutants of neutralizing CHIKV antibodies",
    "section": "Introduction",
    "text": "Introduction\nThis document describes the analysis pipeline and software inputs used to analyze sequencing data generated in the following manuscript (currently available as a preprint):\n\n\n\n\n\n\nReference\n\n\n\n\nM. Stumpf M, Brunetti T, J. Davenport B, K. McCarthy M, E. Morrison T. 2025 (in press). Deep mutationally scanned (DMS) CHIKV E3/E2 virus library maps viral amino acid preferences and predicts viral escape mutants of neutralizing CHIKV antibodies. J. Virol."
  },
  {
    "objectID": "docs/index.html#software-requirements",
    "href": "docs/index.html#software-requirements",
    "title": "Deep mutationally scanned (DMS) CHIKV E3/E2 virus library maps viral amino acid preferences and predicts viral escape mutants of neutralizing CHIKV antibodies",
    "section": "1 Software Requirements",
    "text": "1 Software Requirements\nFor this analysis:\n\nfastqc\nmultiqc\ncutadapt\nseqtk\nvirvarseq\ndms_tools2\nmegalogo\ndmslogo\ndms-viz\nR &gt;= v4.2.1"
  },
  {
    "objectID": "docs/index.html#analysis-pipeline",
    "href": "docs/index.html#analysis-pipeline",
    "title": "Deep mutationally scanned (DMS) CHIKV E3/E2 virus library maps viral amino acid preferences and predicts viral escape mutants of neutralizing CHIKV antibodies",
    "section": "2 Analysis Pipeline",
    "text": "2 Analysis Pipeline\n\nDiagram 1. Analysis Pipeline Workflow\n\n\n\n\n\nflowchart TB\n  A{\"Raw FASTQ&lt;br&gt;Files\"}\n  A --&gt; B[\"Trim Reads&lt;br&gt;&lt;code&gt;CutAdapt&lt;/code&gt;\"]\n  A -.-&gt; C(\"QC Check&lt;br&gt;&lt;code&gt;FastQC&lt;/code&gt;&lt;br&gt;&lt;code&gt;MultiQC&lt;/code&gt;\")\n  B -.-&gt; D(\"QC Check&lt;br&gt;&lt;code&gt;FastQC&lt;/code&gt;&lt;br&gt;&lt;code&gt;MultiQC&lt;/code&gt;\")\n  B --&gt; E[\"Subsample&lt;br&gt;Reads&lt;br&gt;&lt;code&gt;seqtk&lt;/code&gt;\"]\n  E -.-&gt; F(\"QC Check&lt;br&gt;&lt;code&gt;FastQC&lt;/code&gt;&lt;br&gt;&lt;code&gt;MultiQC&lt;/code&gt;\")\n  E --&gt; G[\"Alignment/&lt;br&gt;Codon Inference\"&lt;br&gt;&lt;code&gt;VirVarSeq&lt;/code&gt;]\n  G --&gt; H[\"Formatting for&lt;br&gt;&lt;code&gt;batchdiffsel&lt;/code&gt;\"]\n  G --&gt; I[\"Calculate&lt;br&gt;&lt;code&gt;ndet&lt;/code&gt;\"]\n  G -.-&gt; J(\"QC Check\")\n  I --&gt; K[\"Visualization&lt;br&gt;&lt;code&gt;dms-viz&lt;/code&gt;\"]\n  H --&gt; L[\"Differential&lt;br&gt;Selection&lt;br&gt;&lt;code&gt;batchdiffsel&lt;/code&gt;\"]\n  L --&gt; K\n  L --&gt; M[\"Visualization&lt;br&gt;&lt;code&gt;dmslogo&lt;/code&gt;\"]\n  I --&gt; N[\"Visualization&lt;br&gt;&lt;code&gt;megaLogo&lt;/code&gt;\"]"
  },
  {
    "objectID": "docs/index.html#sample-preparation",
    "href": "docs/index.html#sample-preparation",
    "title": "Deep mutationally scanned (DMS) CHIKV E3/E2 virus library maps viral amino acid preferences and predicts viral escape mutants of neutralizing CHIKV antibodies",
    "section": "3 Sample Preparation",
    "text": "3 Sample Preparation\nBrief Methods: (For full detailed methods, see Manuscript)\n\nViral supernatants were treated with RNase ONE to remove non-virion associated RNAs.\nRNA was isolated from treated supernatants using Trizol and treated with DNase H on-column and aliquoted into 3 x 10 uL aliquots and frozen at -80°C.\nRNA aliquots were thawed and reverse transcribed using SuperScript IV following manufacturer recommendations.\nFull cDNA reaction volume served as a template for an amplicon PCR reaction to amplify the mutagenized CHIKV p62 region for sequencing.\nPCR products were PCR purified and eluted in molecular grade water."
  },
  {
    "objectID": "docs/index.html#library-preparation",
    "href": "docs/index.html#library-preparation",
    "title": "Deep mutationally scanned (DMS) CHIKV E3/E2 virus library maps viral amino acid preferences and predicts viral escape mutants of neutralizing CHIKV antibodies",
    "section": "4 Library Preparation",
    "text": "4 Library Preparation\nCompleted at the CU Anschutz Genomics Shared Resource\n\nLibraries were mechanically sheared via Covaris\nFragments were barcoded using Ovation Ultralow System V2 (Tecan)\nBarcoded libraries were batched and loaded onto an Illumina NovaSeq 6000\nEach sample was sequenced with 2x150bp reads at a depth of 25M paired-end reads (50M pairs)\nSamples were demultiplexed and RAW fastq files delivered"
  },
  {
    "objectID": "docs/index.html#read-preparation-and-analysis",
    "href": "docs/index.html#read-preparation-and-analysis",
    "title": "Deep mutationally scanned (DMS) CHIKV E3/E2 virus library maps viral amino acid preferences and predicts viral escape mutants of neutralizing CHIKV antibodies",
    "section": "5 Read Preparation and Analysis",
    "text": "5 Read Preparation and Analysis\nOverview of code breakdown and purpose(s) for execution of each code block.\nAll raw FASTQ files can be found at the following Zenodo DOIs:\nhttps://doi.org/10.5281/zenodo.14269994\nhttps://doi.org/10.5281/zenodo.14510616\nhttps://doi.org/10.5281/zenodo.14510626\n\n5.1 FastQC/MultiQC/CutAdapt\nChecking quality metrics and removing adapter sequences prior to aligning to the CHIKV reference genome.\n\nRaw fastq files were analyzed for QC metrics using FastQC and summary reports generated via MultiQC\nSamples were trimmed of Illumina universal adapters via cutadapt\nQC metrics were evaluated again with FastQC and MultiQC\nTrimmed samples were subsampled to 25M reads per pair via seqtk\nQC metrics were evaluated once more with FastQC and MultiQC\n\n\n\n\n\n\n\nNote\n\n\n\nSamples were prepared and sequenced across 3 separate runs (12/12/2022, 06/13/2023, and 08/01/2023) depending on the sample type and code was executed independently for each run on individual seeds.\nAll three runs have been combined within code blocks for brevity but each contain their own wtDNA control for error-correction in downstream analyses.\n\n\nTo clean and prep all reads, the following shell scripts were run:\n\n\nExpand to View Code Blocks\n\n\n\nstep1a_raws_qc.sh\n\n#!/bin/bash\n\n# Run fastqc to check raw read sequencing quality for each run\n~/software/FastQC/fastqc --outdir ./12122022/raw_fastqc_reports/ --threads 1 ./12122022/raw_fastq_files/*.fastq.gz\n~/software/FastQC/fastqc --outdir ./06132023/raw_fastqc_reports/ --threads 1 ./06132023/raw_fastq_files/*.fastq.gz\n~/software/FastQC/fastqc --outdir ./08012023/raw_fastqc_reports/ --threads 9 ./08012023/raw_fastq_files/*.fastq.gz\n\n# Combine raw fastqc files into multiqc report for each run\nmultiqc ./12122022/raw_fastqc_reports/ --filename raw_multiqc_report.html --outdir ./12122022/multiqc_reports/\nmultiqc ./06132023/raw_fastqc_reports/ --filename raw_multiqc_report.html --outdir ./06132023/multiqc_reports/\nmultiqc ./08012023/raw_fastqc_reports/ --filename raw_multiqc_report.html --outdir ./08012023/multiqc_reports/\n\n\n\nstep1b_trimming.sh\n\n#!/bin/bash\n\n# Trim reads using cutadapt for all samples for each run\n### 12122022\n## wtDNA\ncutadapt -a AGATCGGAAGAG -A AGATCGGAAGAG -o ./12122022/trimmed_fastq_files/tr_wtDNA_S17_L003_R1_001.fastq -p ./12122022/trimmed_fastq_files/tr_wtDNA_S17_L003_R2_001.fastq wtDNA_S17_L003_R1_001.fastq.gz wtDNA_S17_L003_R2_001.fastq.gz --nextseq-trim=20 -m 10 --json=wtDNA.cutadapt.json\n\n## mutDNA\ncutadapt -a AGATCGGAAGAG -A AGATCGGAAGAG -o ./12122022/trimmed_fastq_files/tr_mutDNA_lib1_S18_L003_R1_001.fastq -p ./12122022/trimmed_fastq_files/tr_mutDNA_lib1_S18_L003_R2_001.fastq mutDNA_lib1_S18_L003_R1_001.fastq.gz mutDNA_lib1_S18_L003_R2_001.fastq.gz --nextseq-trim=20 -m 10 --json=mutDNA.cutadapt.json\n\n### 06132023\n## wtDNA\ncutadapt -a AGATCGGAAGAG -A AGATCGGAAGAG -o ./06132023/trimmed_fastq_files/tr_wtDNA_S25_L002_R1_001.fastq -p ./06132023/trimmed_fastq_files/tr_wtDNA_S25_L002_R2_001.fastq wtDNA_S25_L002_R1_001.fastq.gz wtDNA_S25_L002_R2_001.fastq.gz --nextseq-trim=20 -m 10 --json=wtDNA.cutadapt.json\n\n## mutVirus_p1\ncutadapt -a AGATCGGAAGAG -A AGATCGGAAGAG -o ./06132023/trimmed_fastq_files/tr_mutVirus_lib1_p1_S26_L002_R1_001.fastq -p ./06132023/trimmed_fastq_files/tr_mutVirus_lib1_p1_S26_L002_R2_001.fastq mutVirus_lib1_p1_S26_L002_R1_001.fastq.gz mutVirus_lib1_p1_S26_L002_R2_001.fastq.gz --nextseq-trim=20 -m 10 --json=mutVirus.p1.cutadapt.json\n\n## mutVirus_p2\ncutadapt -a AGATCGGAAGAG -A AGATCGGAAGAG -o ./06132023/trimmed_fastq_files/tr_mutVirus_lib1_p2_S27_L002_R1_001.fastq -p ./06132023/trimmed_fastq_files/tr_mutVirus_lib1_p2_S27_L002_R2_001.fastq mutVirus_lib1_p2_S27_L002_R1_001.fastq.gz mutVirus_lib1_p2_S27_L002_R2_001.fastq.gz --nextseq-trim=20 -m 10 --json=mutVirus.p2.cutadapt.json\n\n### 08012023\n## wtDNA\ncutadapt -a AGATCGGAAGAG -A AGATCGGAAGAG -o ./08012023/trimmed_fastq_files/tr_wtDNA_S73_L003_R1_001.fastq -p ./08012023/trimmed_fastq_files/tr_wtDNA_S73_L003_R2_001.fastq wtDNA_S73_L003_R1_001.fastq.gz wtDNA_S73_L003_R2_001.fastq.gz --nextseq-trim=20 -m 10 --json=wtDNA.cutadapt.json\n\n## mutVirus_CHK11_1-1\ncutadapt -a AGATCGGAAGAG -A AGATCGGAAGAG -o ./08012023/trimmed_fastq_files/tr_mutVirus_CHK11_1_1_S80_L003_R1_001.fastq -p ./08012023/trimmed_fastq_files/tr_mutVirus_CHK11_1_1_S80_L003_R2_001.fastq mutVirus_CHK11_1_1_S80_L003_R1_001.fastq.gz mutVirus_CHK11_1_1_S80_L003_R2_001.fastq.gz --nextseq-trim=20 -m 10 --json=mutVirus.CHK11_1-1.cutadapt.json\n\n## mutVirus_CHK11_3-1\ncutadapt -a AGATCGGAAGAG -A AGATCGGAAGAG -o ./08012023/trimmed_fastq_files/tr_mutVirus_CHK11_3_1_S81_L003_R1_001.fastq -p ./08012023/trimmed_fastq_files/tr_mutVirus_CHK11_3_1_S81_L003_R2_001.fastq mutVirus_CHK11_3_1_S81_L003_R1_001.fastq.gz mutVirus_CHK11_3_1_S81_L003_R2_001.fastq.gz --nextseq-trim=20 -m 10 --json=mutVirus.CHK11_3-1.cutadapt.json\n\n## mutVirus_CHK152_1-2\ncutadapt -a AGATCGGAAGAG -A AGATCGGAAGAG -o ./08012023/trimmed_fastq_files/tr_mutVirus_CHK152_1_2_S76_L003_R1_001.fastq -p ./08012023/trimmed_fastq_files/tr_mutVirus_CHK152_1_2_S76_L003_R2_001.fastq mutVirus_CHK152_1_2_S76_L003_R1_001.fastq.gz mutVirus_CHK152_1_2_S76_L003_R2_001.fastq.gz --nextseq-trim=20 -m 10 --json=mutVirus.CHK152_1-2.cutadapt.json\n\n## mutVirus_CHK152_2-1\ncutadapt -a AGATCGGAAGAG -A AGATCGGAAGAG -o ./08012023/trimmed_fastq_files/tr_mutVirus_CHK152_2_1_S77_L003_R1_001.fastq -p ./08012023/trimmed_fastq_files/tr_mutVirus_CHK152_2_1_S77_L003_R2_001.fastq mutVirus_CHK152_2_1_S77_L003_R1_001.fastq.gz mutVirus_CHK152_2_1_S77_L003_R2_001.fastq.gz --nextseq-trim=20 -m 10 --json=mutVirus.CHK152_2-1.cutadapt.json\n\n## mutVirus_CHK265_1-2\ncutadapt -a AGATCGGAAGAG -A AGATCGGAAGAG -o ./08012023/trimmed_fastq_files/tr_mutVirus_CHK265_1_2_S78_L003_R1_001.fastq -p ./08012023/trimmed_fastq_files/tr_mutVirus_CHK265_1_2_S78_L003_R2_001.fastq mutVirus_CHK265_1_2_S78_L003_R1_001.fastq.gz mutVirus_CHK265_1_2_S78_L003_R2_001.fastq.gz --nextseq-trim=20 -m 10 --json=mutVirus.CHK265_1-2.cutadapt.json\n\n## mutVirus_CHK265_2-3\ncutadapt -a AGATCGGAAGAG -A AGATCGGAAGAG -o ./08012023/trimmed_fastq_files/tr_mutVirus_CHK265_2_3_S79_L003_R1_001.fastq -p ./08012023/trimmed_fastq_files/tr_mutVirus_CHK265_2_3_S79_L003_R2_001.fastq mutVirus_CHK265_2_3_S79_L003_R1_001.fastq.gz mutVirus_CHK265_2_3_S79_L003_R2_001.fastq.gz --nextseq-trim=20 -m 10 --json=mutVirus.CHK265_2-3.cutadapt.json\n\n## mutVirus_only_1-2\ncutadapt -a AGATCGGAAGAG -A AGATCGGAAGAG -o ./08012023/trimmed_fastq_files/tr_mutVirus_only_1_2_S74_L003_R1_001.fastq -p ./08012023/trimmed_fastq_files/tr_mutVirus_only_1_2_S74_L003_R2_001.fastq mutVirus_only_1_2_S74_L003_R1_001.fastq.gz mutVirus_only_1_2_S74_L003_R2_001.fastq.gz --nextseq-trim=20 -m 10 --json=mutVirus.only_1-2.cutadapt.json\n\n## mutVirus_only_2-1\ncutadapt -a AGATCGGAAGAG -A AGATCGGAAGAG -o ./08012023/trimmed_fastq_files/tr_mutVirus_only_2_1_S75_L003_R1_001.fastq -p ./08012023/trimmed_fastq_files/tr_mutVirus_only_2_1_S75_L003_R2_001.fastq mutVirus_only_2_1_S75_L003_R1_001.fastq.gz mutVirus_only_2_1_S75_L003_R2_001.fastq.gz --nextseq-trim=20 -m 10 --json=mutVirus.only_2-1.cutadapt.json\n\n\n\nstep1c_trimmed_qc.sh\n\n#!/bin/bash\n\n# Recheck quality of all trimmed samples for each run\n~/software/FastQC/fastqc --outdir ./12122022/trimmed_fastqc_reports/ --threads 9 ./12122022/trimmed_fastqc_files/*.fastq\n~/software/FastQC/fastqc --outdir ./06132023/trimmed_fastqc_reports/ --threads 2 ./06132023/trimmed_fastqc_files/*.fastq\n~/software/FastQC/fastqc --outdir ./08012023/trimmed_fastqc_reports/ --threads 9 ./08012023/trimmed_fastqc_files/*.fastq\n\n# Combine trimmed fastqc files into multiqc report for each run\nmultiqc ./12122022/trimmed_fastqc_reports/ --filename trimmed_multiqc_report.html --outdir ./12122022/multiqc_reports/\nmultiqc ./06132023/trimmed_fastqc_reports/ --filename trimmed_multiqc_report.html --outdir ./06132023/multiqc_reports/\nmultiqc ./08012023/trimmed_fastqc_reports/ --filename trimmed_multiqc_report.html --outdir ./08012023/multiqc_reports/\n\n\n\nstep1d_subsampling.sh\n\n#!/bin/bash\n\n# Subsample trimmed fastq files to 25000000 for each run\n### 12122022\n/usr/bin/time seqtk sample -s12282022 ./12122022/trimmed_fastq_files/tr_wtDNA_S17_L003_R1_001.fastq 25000000 | gzip &gt; ./12122022/subsampled_fastq_files/wtDNA_seed12282022_subsampled_25000000_R1.fastq.gz\n/usr/bin/time seqtk sample -s12282022 ./12122022/trimmed_fastq_files/tr_wtDNA_S17_L003_R2_001.fastq 25000000 | gzip &gt; ./12122022/subsampled_fastq_files/wtDNA_seed12282022_subsampled_25000000_R2.fastq.gz\n/usr/bin/time seqtk sample -s12282022 ./12122022/trimmed_fastq_files/tr_mutDNA_lib1_S18_L003_R1_001.fastq 25000000 | gzip &gt; ./12122022/subsampled_fastq_files/mutDNA_lib1_seed12282022_subsampled_25000000_R1.fastq.gz\n/usr/bin/time seqtk sample -s12282022 ./12122022/trimmed_fastq_files/tr_mutDNA_lib1_S18_L003_R2_001.fastq 25000000 | gzip &gt; ./12122022/subsampled_fastq_files/mutDNA_lib1_seed12282022_subsampled_25000000_R2.fastq.gz\n\n### 06132023\n/usr/bin/time seqtk sample -s06212023 ./06132023/trimmed_fastq_files/tr_wtDNA_S25_L002_R1_001.fastq 25000000 | gzip &gt; ./06132023/subsampled_fastq_files/wtDNA_seed06212023_subsampled_25000000_R1.fastq.gz\n/usr/bin/time seqtk sample -s06212023 ./06132023/trimmed_fastq_files/tr_wtDNA_S25_L002_R2_001.fastq 25000000 | gzip &gt; ./06132023/subsampled_fastq_files/wtDNA_seed06212023_subsampled_25000000_R2.fastq.gz\n/usr/bin/time seqtk sample -s06212023 ./06132023/trimmed_fastq_files/tr_mutVirus_lib1_p1_S26_L002_R1_001.fastq 25000000 | gzip &gt; ./06132023/subsampled_fastq_files/mutVirus_p1_seed06212023_subsampled_25000000_R1.fastq.gz\n/usr/bin/time seqtk sample -s06212023 ./06132023/trimmed_fastq_files/tr_mutVirus_lib1_p1_S26_L002_R2_001.fastq 25000000 | gzip &gt; ./06132023/subsampled_fastq_files/mutVirus_p1_seed06212023_subsampled_25000000_R2.fastq.gz\n/usr/bin/time seqtk sample -s06212023 ./06132023/trimmed_fastq_files/tr_mutVirus_lib1_p2_S27_L002_R1_001.fastq 25000000 | gzip &gt; ~./06132023/subsampled_fastq_files/mutVirus_p2_seed06212023_subsampled_25000000_R1.fastq.gz\n/usr/bin/time seqtk sample -s06212023 ./06132023/trimmed_fastq_files/tr_mutVirus_lib1_p2_S27_L002_R2_001.fastq 25000000 | gzip &gt; ./06132023/subsampled_fastq_files/mutVirus_p2_seed06212023_subsampled_25000000_R2.fastq.gz\n\n### 08012023\n/usr/bin/time seqtk sample -s08122023 ./08012023/trimmed_fastq_files/tr_wtDNA_S73_L003_R2_001.fastq 25000000 | gzip &gt; ./08012023/subsampled_fastq_files/wtDNA_seed08122023_subsampled_25000000_R2.fastq.gz\n/usr/bin/time seqtk sample -s08122023 ./08012023/trimmed_fastq_files/tr_mutVirus_CHK11_1_1_S80_L003_R1_001.fastq 25000000 | gzip &gt; ./08012023/subsampled_fastq_files/mutVirus_CHK11_1_1_seed08122023_subsampled_25000000_R1.fastq.gz\n/usr/bin/time seqtk sample -s08122023 ./08012023/trimmed_fastq_files/tr_mutVirus_CHK11_1_1_S80_L003_R2_001.fastq 25000000 | gzip &gt; ./08012023/subsampled_fastq_files/mutVirus_CHK11_1_1_seed08122023_subsampled_25000000_R2.fastq.gz\n/usr/bin/time seqtk sample -s08122023 ./08012023/trimmed_fastq_files/tr_mutVirus_CHK11_3_1_S81_L003_R1_001.fastq 25000000 | gzip &gt; ./08012023/subsampled_fastq_files/mutVirus_CHK11_3_1_seed08122023_subsampled_25000000_R1.fastq.gz\n/usr/bin/time seqtk sample -s08122023 ./08012023/trimmed_fastq_files/tr_mutVirus_CHK11_3_1_S81_L003_R2_001.fastq 25000000 | gzip &gt; ./08012023/subsampled_fastq_files/mutVirus_CHK11_3_1_seed08122023_subsampled_25000000_R2.fastq.gz\n/usr/bin/time seqtk sample -s08122023 ./08012023/trimmed_fastq_files/tr_mutVirus_CHK152_1_2_S76_L003_R1_001.fastq 25000000 | gzip &gt; ./08012023/subsampled_fastq_files/mutVirus_CHK152_1_2_seed08122023_subsampled_25000000_R1.fastq.gz\n/usr/bin/time seqtk sample -s08122023 ./08012023/trimmed_fastq_files/tr_mutVirus_CHK152_1_2_S76_L003_R2_001.fastq 25000000 | gzip &gt; ./08012023/subsampled_fastq_files/mutVirus_CHK152_1_2_seed08122023_subsampled_25000000_R2.fastq.gz\n/usr/bin/time seqtk sample -s08122023 ./08012023/trimmed_fastq_files/tr_mutVirus_CHK152_2_1_S77_L003_R1_001.fastq 25000000 | gzip &gt; ./08012023/subsampled_fastq_files/mutVirus_CHK152_2_1_seed08122023_subsampled_25000000_R1.fastq.gz\n/usr/bin/time seqtk sample -s08122023 ./08012023/trimmed_fastq_files/tr_mutVirus_CHK152_2_1_S77_L003_R2_001.fastq 25000000 | gzip &gt; ./08012023/subsampled_fastq_files/mutVirus_CHK152_2_1_seed08122023_subsampled_25000000_R2.fastq.gz\n/usr/bin/time seqtk sample -s08122023 ./08012023/trimmed_fastq_files/tr_mutVirus_CHK265_1_2_S78_L003_R1_001.fastq 25000000 | gzip &gt; ./08012023/subsampled_fastq_files/mutVirus_CHK265_1_2_seed08122023_subsampled_25000000_R1.fastq.gz\n/usr/bin/time seqtk sample -s08122023 ./08012023/trimmed_fastq_files/tr_mutVirus_CHK265_1_2_S78_L003_R2_001.fastq 25000000 | gzip &gt; ./08012023/subsampled_fastq_files/mutVirus_CHK265_1_2_seed08122023_subsampled_25000000_R2.fastq.gz\n/usr/bin/time seqtk sample -s08122023 ./08012023/trimmed_fastq_files/tr_mutVirus_CHK265_2_3_S79_L003_R1_001.fastq 25000000 | gzip &gt; ./08012023/subsampled_fastq_files/mutVirus_CHK265_2_3_seed08122023_subsampled_25000000_R1.fastq.gz\n/usr/bin/time seqtk sample -s08122023 ./08012023/trimmed_fastq_files/tr_mutVirus_CHK265_2_3_S79_L003_R2_001.fastq 25000000 | gzip &gt; ./08012023/subsampled_fastq_files/mutVirus_CHK265_2_3_seed08122023_subsampled_25000000_R2.fastq.gz\n/usr/bin/time seqtk sample -s08122023 ./08012023/trimmed_fastq_files/tr_mutVirus_only_1_2_S74_L003_R1_001.fastq 25000000 | gzip &gt; ./08012023/subsampled_fastq_files/mutVirus_only_1_2_seed08122023_subsampled_25000000_R1.fastq.gz\n/usr/bin/time seqtk sample -s08122023 ./08012023/trimmed_fastq_files/tr_mutVirus_only_1_2_S74_L003_R2_001.fastq 25000000 | gzip &gt; ./08012023/subsampled_fastq_files/mutVirus_only_1_2_seed08122023_subsampled_25000000_R2.fastq.gz\n/usr/bin/time seqtk sample -s08122023 ./08012023/trimmed_fastq_files/tr_mutVirus_only_2_1_S75_L003_R1_001.fastq 25000000 | gzip &gt; ./08012023/subsampled_fastq_files/mutVirus_only_2_1_seed08122023_subsampled_25000000_R1.fastq.gz\n/usr/bin/time seqtk sample -s08122023 ./08012023/trimmed_fastq_files/tr_mutVirus_only_2_1_S75_L003_R2_001.fastq 25000000 | gzip &gt; ./08012023/subsampled_fastq_files/mutVirus_only_2_1_seed08122023_subsampled_25000000_R2.fastq.gz\n\n\n\nstep1e_subsampled_qc.sh\n\n#!/bin/bash\n\n# Recheck quality of subsampled reads for each run\n~/software/FastQC/fastqc --outdir ./12222022/subsampled_fastqc_reports/ --threads 6 ./12222022/subsampled_fastqc_files/*.fastq.gz\n~/software/FastQC/fastqc --outdir ./06132023/subsampled_fastqc_reports/ --threads 6 ./06132023/subsampled_fastqc_files/*.fastq.gz\n~/software/FastQC/fastqc --outdir ./08012023/subsampled_fastqc_reports/ --threads 9 ./08012023/subsampled_fastqc_files/*.fastq.gz\n\n# Combine subsampled/trimmed fastqc files into multiqc report for each run\nmultiqc ./12122022/subsampled_fastqc_reports/ --filename trimmed_subsampled_multiqc_report.html --outdir ./12122022/multiqc_reports/\nmultiqc ./06132023/subsampled_fastqc_reports/ --filename trimmed_subsampled_multiqc_report.html --outdir ./06132023/multiqc_reports/\nmultiqc ./08012023/subsampled_fastqc_reports/ --filename trimmed_subsampled_multiqc_report.html --outdir ./08012023/multiqc_reports/\n\n\n\n\n5.2 VirVarSeq\nAlignment of subsampled clean reads to the WT mutagenized CHIKV p62 fragment sequence and codon metric calling with VirVarSeq software.\nSoftware was downloaded from SourceForge and the relevant manuscript can be found here.\n\n12-12-2022\nSamples prefix file input for VirVarSeq:\nsamples.txt\n\n\n                                             \n wtDNA_seed12282022_subsampled_25000000      \n mutDNA_lib1_seed12282022_subsampled_25000000\n\n\n To execute VirVarSeq, the following shell script was run:\n\n\nExpand to View Code Block\n\n\n\nstep2_run12292022.sh\n\n#!/bin/bash\n\nexport R_LIBS_USER=./12292022/VirVarSeq/R/lib\nexport PERL5LIB=./12292022/VirVarSeq/lib\nindir=./12292022/VirVarSeq/fastq\noutdir=./12292022/VirVarSeq/results\nsamples=./12292022/VirVarSeq/samples.txt\nref=../ref/pCHIKV_AF15561.fasta\nstartpos=9821\nendpos=15701\nregion_start=9821\nregion_len=1218\nqv=0\n\n./map_vs_ref.pl --samplelist $samples --ref $ref --indir $indir --outdir $outdir --mapping paired &gt; VirVarSeq.log 2&gt;&1\n./consensus.pl --samplelist $samples --ref $ref --indir $indir --outdir $outdir --start $startpos --end $endpos &gt;&gt; VirVarSeq.log 2&gt;&1\n./map_vs_consensus.pl --samplelist $samples --indir $indir --outdir $outdir --mapping paired &gt;&gt; VirVarSeq.log 2&gt;&1\n./codon_table.pl --samplelist $samples --ref $ref --outdir $outdir --start=$region_start --len=$region_len --trimming=0 --qual=$qv &gt;&gt; VirVarSeq.log 2&gt;&1\n./mixture_model.pl --samplelist $samples --outdir $outdir --ref $ref --start=$region_start --len=$region_len --qual=$qv &gt;&gt; VirVarSeq.log 2&gt;&1 \n\n\n\n\n06-13-2023\nSamples prefix file input for VirVarSeq:\nsamples.txt\n\n\n                                             \n wtDNA_seed06212023_subsampled_25000000      \n mutVirus_p1_seed06212023_subsampled_25000000\n mutVirus_p2_seed06212023_subsampled_25000000\n\n\n To execute VirVarSeq, the following shell script was run:\n\n\nExpand to View Code Block\n\n\n\nstep2_run06132023.sh\n\n#!/bin/bash\n\nexport R_LIBS_USER=./06132023/VirVarSeq/R/lib\nexport PERL5LIB=./06132023/VirVarSeq/lib\nindir=./06132023/VirVarSeq/subsampled_fastq_files\noutdir=./06132023/VirVarSeq/results\nsamples=./06132023/VirVarSeq/samples.txt\nref=../ref/pCHIKV_AF15561.fasta\nstartpos=9821\nendpos=15701\nregion_start=9821\nregion_len=1218\nqv=0\n\n/usr/bin/time ./map_vs_ref.pl --samplelist $samples --ref $ref --indir $indir --outdir $outdir --mapping paired &gt; VirVarSeq.log 2&gt;&1\n/usr/bin/time ./consensus.pl --samplelist $samples --ref $ref --indir $indir --outdir $outdir --start $startpos --end $endpos &gt;&gt; VirVarSeq.log 2&gt;&1\n/usr/bin/time ./map_vs_consensus.pl --samplelist $samples --indir $indir --outdir $outdir --mapping paired &gt;&gt; VirVarSeq.log 2&gt;&1\n/usr/bin/time ./codon_table.pl --samplelist $samples --ref $ref --outdir $outdir --start=$region_start --len=$region_len --trimming=0 --qual=$qv &gt;&gt; VirVarSeq.log 2&gt;&1\n/usr/bin/time ./mixture_model.pl --samplelist $samples --outdir $outdir --ref $ref --start=$region_start --len=$region_len --qual=$qv &gt;&gt; VirVarSeq.log 2&gt;&1 \n\n\n\n\n08-01-2023\nSamples prefix file input for VirVarSeq:\nsamples.txt\n\n\n                                                     \n wtDNA_seed08122023_subsampled_25000000              \n mutVirus_CHK11_1_1_seed08122023_subsampled_25000000 \n mutVirus_CHK11_3_1_seed08122023_subsampled_25000000 \n mutVirus_CHK152_1_2_seed08122023_subsampled_25000000\n mutVirus_CHK152_2_1_seed08122023_subsampled_25000000\n mutVirus_CHK265_1_2_seed08122023_subsampled_25000000\n mutVirus_CHK265_2_3_seed08122023_subsampled_25000000\n mutVirus_only_1_2_seed08122023_subsampled_25000000  \n mutVirus_only_2_1_seed08122023_subsampled_25000000  \n\n\n To execute VirVarSeq, the following shell script was run:\n\n\nExpand to View Code Block\n\n\n\nstep2_run08132023.sh\n\n#!/bin/bash\n\nexport R_LIBS_USER=./08012023/VirVarSeq/R/lib\nexport PERL5LIB=./08012023/VirVarSeq/lib\nindir=./08012023/subsampled_fastq_files\noutdir=./08012023/VirVarSeq/results\nsamples=./08012023/VirVarSeq/samples.txt\nref=../ref/pCHIKV_AF15561.fasta\nstartpos=9821\nendpos=15701\nregion_start=9821\nregion_len=1218\nqv=0\n\n/usr/bin/time ./map_vs_ref.pl --samplelist $samples --ref $ref --indir $indir --outdir $outdir --mapping paired &gt; VirVarSeq.log 2&gt;&1\n/usr/bin/time ./consensus.pl --samplelist $samples --ref $ref --indir $indir --outdir $outdir --start $startpos --end $endpos &gt;&gt; VirVarSeq.log 2&gt;&1\n/usr/bin/time ./map_vs_consensus.pl --samplelist $samples --indir $indir --outdir $outdir --mapping paired &gt;&gt; VirVarSeq.log 2&gt;&1\n/usr/bin/time ./codon_table.pl --samplelist $samples --ref $ref --outdir $outdir --start=$region_start --len=$region_len --trimming=0 --qual=$qv &gt;&gt; VirVarSeq.log 2&gt;&1\n/usr/bin/time ./mixture_model.pl --samplelist $samples --outdir $outdir --ref $ref --start=$region_start --len=$region_len --qual=$qv &gt;&gt; VirVarSeq.log 2&gt;&1 \n\n\n\n\n\n5.3 \\(ndet\\)\nCreation of lineplots to visualize mutagenesis efficiency and selection results for virus library generation.\n\n5.3.1 Calculation\nTo calculate the level of diversity tolerated for all iterations of the CHIKV-p62-DMS virus libraries, the number of detected amino acids (\\(ndet\\)) was determined using the following in-house R code.\nIn brief we first filtered the VirVarSeq output codon matrices with the following conditions:\n\nMust have greater than 100 counts for that codon-position pair\nMust have an average forward and reverse read minimum Phred quality score of 24.\n\nThen, the remaining unique residues were summed for each position (\\(ndet\\)).\n\n\n\n\n\n\nWarning\n\n\n\nThe code process below is heavily R dependent and not well suited for large batches of samples. Moving forward, pipeline will be converted to a loop-based algorithm and executed with remote compute nodes.\n\n\n\n\nExpand to View Code Block\n\n\n\nstep3a_diversity_analysis.R\n\n#!/usr/bin/Rscript\n\n# GOAL: Count matrix processing for 'ndet' calculations\n# Packages to load\nlibrary(plyr)\nlibrary(dplyr)\nlibrary(reshape2)\nlibrary(tidyr)\nlibrary(stringr)\n\n# Set working directory to find VirVarSeq output matrices\nsetwd(\"./06132023/VirVarSeq/results/mixture_model/\")\n\n# List file names but then need to open in excel and save as CSV file\nlist.files(path = \".\", pattern = \".codon\")\n\n# Confirm all files successfully converted to .csv\nlist.files(path = \".\", pattern = \"Q.10.csv\")\n\n# Read in CSV files from VirVarSeq\ndf1 &lt;- read.csv(\"wtDNA_seed06212023_subsampled_25000000.Q.10.csv\")\ndf2 &lt;- read.csv(\"mutVirus_p1_seed06212023_subsampled_25000000.Q.10.csv\")\ndf3 &lt;- read.csv(\"mutVirus_p2_seed06212023_subsampled_25000000.Q.10.csv\")\ndf4 &lt;- read.csv(\"mutDNA/mutDNA_r1_standard_prep_seed12282022_subsampled_25000000.Q.10.csv\")\n\n# Merge position and AA into single field in order to be able to sort/combine/melt/etc.\ndf1$MERGE &lt;- paste(df1$POSITION, df1$CODON)\ndf2$MERGE &lt;- paste(df2$POSITION, df2$CODON)\ndf3$MERGE &lt;- paste(df3$POSITION, df3$CODON)\ndf4$MERGE &lt;- paste(df4$POSITION, df4$CODON)\n\n# Subset out only the mutated regions\ndf1_subset &lt;- df1 %&gt;%\n  filter(POSITION &lt;= 398) %&gt;%\n  filter(POSITION &gt;= 9)\n\ndf2_subset &lt;- df2 %&gt;%\n  filter(POSITION &lt;= 398) %&gt;%\n  filter(POSITION &gt;= 9)\n\ndf3_subset &lt;- df3 %&gt;%\n  filter(POSITION &lt;= 398) %&gt;%\n  filter(POSITION &gt;= 9)\n\ndf4_subset &lt;- df4 %&gt;%\n  filter(POSITION &lt;= 398) %&gt;%\n  filter(POSITION &gt;= 9)\n\n# Check which sample set has the most unique codons (aka: rows)\nprint(dim(df1_subset))\nprint(dim(df2_subset))\nprint(dim(df3_subset))\nprint(dim(df4_subset))\n\n# Adding column name identifiers to prepare for a dataset merge\ncolnames(df1_subset) &lt;- paste(colnames(df1_subset), \"df1\", sep = \"_\")\ncolnames(df2_subset) &lt;- paste(colnames(df2_subset), \"df2\", sep = \"_\")\ncolnames(df3_subset) &lt;- paste(colnames(df3_subset), \"df3\", sep = \"_\")\ncolnames(df4_subset) &lt;- paste(colnames(df4_subset), \"df4\", sep = \"_\")\n\n# Renaming MERGE_df# column name to be merge-able across all data sets in the sheet via same column name\ncolnames(df1_subset) [22] &lt;- \"MERGE\"\ncolnames(df2_subset) [22] &lt;- \"MERGE\"\ncolnames(df3_subset) [22] &lt;- \"MERGE\"\ncolnames(df4_subset) [22] &lt;- \"MERGE\"\n\n# Create mergable field with position and corresponding amino acid (mutant and REF) to remove codon redundancy\ndf1_subset$MERGE_AA &lt;- paste(df1_subset$POSITION_df1, df1_subset$AA_df1)\ndf2_subset$MERGE_AA &lt;- paste(df2_subset$POSITION_df2, df2_subset$AA_df2)\ndf3_subset$MERGE_AA &lt;- paste(df3_subset$POSITION_df3, df3_subset$AA_df3)\ndf4_subset$MERGE_AA &lt;- paste(df4_subset$POSITION_df4, df4_subset$AA_df4)\n\n# Count and quality filtering\nfiltered_df1 &lt;- df1_subset %&gt;%\n  filter(CNT_df1 &gt; 100) %&gt;%\n  filter(FWD_MEAN_MIN_QUAL_df1 &gt;= 24) %&gt;%\n  filter(REV_MEAN_MIN_QUAL_df1 &gt;= 24)\n\nfiltered_df2 &lt;- df2_subset %&gt;%\n  filter(CNT_df2 &gt; 100) %&gt;%\n  filter(FWD_MEAN_MIN_QUAL_df2 &gt;= 24) %&gt;%\n  filter(REV_MEAN_MIN_QUAL_df2 &gt;= 24)\n\nfiltered_df3 &lt;- df3_subset %&gt;%\n  filter(CNT_df3 &gt; 100) %&gt;%\n  filter(FWD_MEAN_MIN_QUAL_df3 &gt;= 24) %&gt;%\n  filter(REV_MEAN_MIN_QUAL_df3 &gt;= 24)\n\nfiltered_df4 &lt;- df4_subset %&gt;%\n  filter(CNT_df4 &gt; 100) %&gt;%\n  filter(FWD_MEAN_MIN_QUAL_df4 &gt;= 24) %&gt;%\n  filter(REV_MEAN_MIN_QUAL_df4 &gt;= 24)\n\n# Calculate ndet per position with filtering metrics applied\nfiltered_df1 &lt;- filtered_df1 %&gt;%\n  group_by(POSITION_df1) %&gt;%\n  mutate(ndet = length(unique(MERGE_AA)))\n\nfiltered_df2 &lt;- filtered_df2 %&gt;%\n  group_by(POSITION_df2) %&gt;%\n  mutate(ndet = length(unique(MERGE_AA)))\n\nfiltered_df3 &lt;- filtered_df3 %&gt;%\n  group_by(POSITION_df3) %&gt;%\n  mutate(ndet = length(unique(MERGE_AA)))\n\nfiltered_df4 &lt;- filtered_df4 %&gt;%\n  group_by(POSITION_df4) %&gt;%\n  mutate(ndet = length(unique(MERGE_AA)))\n\n# Determination of avg. # of AAs per position based on filtering including WT\nprint(mean(filtered_df1$ndet))\nprint(mean(filtered_df2$ndet))\nprint(mean(filtered_df3$ndet))\nprint(mean(filtered_df4$ndet))\n\n# Adjusting the POSITION field\nfiltered_df1 &lt;- filtered_df1 %&gt;%\n  mutate(POSITION = POSITION_df1 - 8)\n\nfiltered_df2&lt;- filtered_df2 %&gt;%\n  mutate(POSITION = POSITION_df2 - 8)\n\nfiltered_df3 &lt;- filtered_df3 %&gt;%\n  mutate(POSITION = POSITION_df3 - 8)\n\nfiltered_df4 &lt;- filtered_df4 %&gt;%\n  mutate(POSITION = POSITION_df4 - 8)\n\n# Add MERGE_FRAC for megalogo\nfiltered_df1$MERGE_FRAC &lt;- 1/filtered_df1$ndet\nfiltered_df2$MERGE_FRAC &lt;- 1/filtered_df2$ndet\nfiltered_df3$MERGE_FRAC &lt;- 1/filtered_df3$ndet\nfiltered_df4$MERGE_FRAC &lt;- 1/filtered_df4$ndet\n\n# Write to CSV\nwrite.csv(filtered_df1, \"./ndet/df1_ndet.csv\", row.names = FALSE)\nwrite.csv(filtered_df2, \"./ndet/df2_ndet.csv\", row.names = FALSE)\nwrite.csv(filtered_df3, \"./ndet/df3_ndet.csv\", row.names = FALSE)\nwrite.csv(filtered_df4, \"./ndet/df4_ndet.csv\", row.names = FALSE)\n\n# Remove duplicate MERGE_AA rows for the purpose of megalogo plotting, keeping highest CNT row\nfiltered_df1_mega &lt;- filtered_df1 %&gt;%\n  group_by(MERGE_AA) %&gt;%\n  slice_max(order_by = CNT_df1, with_ties = FALSE) %&gt;%\n  ungroup()\n\nfiltered_df2_mega &lt;- filtered_df2 %&gt;%\n  group_by(MERGE_AA) %&gt;%\n  slice_max(order_by = CNT_df2, with_ties = FALSE) %&gt;%\n  ungroup()\n\nfiltered_df3_mega &lt;- filtered_df3 %&gt;%\n  group_by(MERGE_AA) %&gt;%\n  slice_max(order_by = CNT_df3, with_ties = FALSE) %&gt;%\n  ungroup()\n\nfiltered_df4_mega &lt;- filtered_df4 %&gt;%\n  group_by(MERGE_AA) %&gt;%\n  slice_max(order_by = CNT_df4, with_ties = FALSE) %&gt;%\n  ungroup()\n\n\n# Rename POSITION_df# column\nfiltered_df1_mega &lt;- filtered_df1_mega %&gt;%\n  rename(POSITION_p62 = POSITION)\n\nfiltered_df2_mega &lt;- filtered_df2_mega %&gt;%\n  rename(POSITION_p62 = POSITION)\n\nfiltered_df3_mega &lt;- filtered_df3_mega %&gt;%\n  rename(POSITION_p62 = POSITION)\n\nfiltered_df4_mega &lt;- filtered_df4_mega %&gt;%\n  rename(POSITION_p62 = POSITION)\n\n# Remove suffixes for megalogo\nnames(filtered_df1_mega) &lt;- gsub(\"_df1$\", \"\", names(filtered_df1_mega))\nnames(filtered_df2_mega) &lt;- gsub(\"_df2$\", \"\", names(filtered_df2_mega))\nnames(filtered_df3_mega) &lt;- gsub(\"_df3$\", \"\", names(filtered_df3_mega))\nnames(filtered_df4_mega) &lt;- gsub(\"_df4$\", \"\", names(filtered_df4_mega))\n\n# Confirm removal was successful\ncolnames(filtered_df1_mega)\ncolnames(filtered_df2_mega)\ncolnames(filtered_df3_mega)\ncolnames(filtered_df4_mega)\ncolnames(filtered_df4_mega)\n\n# Sort on position\nfiltered_df1_mega &lt;- filtered_df1_mega[order(filtered_df1_mega$POSITION_p62), ]\nfiltered_df2_mega &lt;- filtered_df2_mega[order(filtered_df2_mega$POSITION_p62), ]\nfiltered_df3_mega &lt;- filtered_df3_mega[order(filtered_df3_mega$POSITION_p62), ]\nfiltered_df4_mega &lt;- filtered_df4_mega[order(filtered_df4_mega$POSITION_p62), ]\n\n# Write to CSV\nwrite.csv(filtered_df1_mega, \"./megalogo/filtered_wtDNA_mega.csv\", row.names = FALSE)\nwrite.csv(filtered_df2_mega, \"./megalogo/filtered_mutVirus_p1_mega.csv\", row.names = FALSE)\nwrite.csv(filtered_df3_mega, \"./megalogo/filtered_mutVirus_p2_mega.csv\", row.names = FALSE)\nwrite.csv(filtered_df4_mega, \"./megalogo/filtered_mutDNA_mega.csv\", row.names = FALSE)\n\n\n\n5.3.2 Visualization\nThe following R code was used to generate line plots displaying \\(ndet\\) diversity at each position.\n\n\nExpand to View Code Block\n\n\n\nstep3b_diversity_lineplots.R\n\n#!/usr/bin/Rscript\n\n# GOAL: Generate diversity line plots for each virus library iteration\n# Packages to load\nlibrary(ggplot2)\nlibrary(reshape2)\nlibrary(ggprism)\nlibrary(gridExtra)\nlibrary(grid)\n\n# Read back in filtered CSV files\nfiltered_df1_mega &lt;- read.csv(\"./megalogo/filtered_wtDNA_mega.csv\")\nfiltered_df2_mega &lt;- read.csv(\"./megalogo/filtered_mutVirus_p1_mega.csv\")\nfiltered_df3_mega &lt;- read.csv(\"./megalogo/filtered_mutVirus_p2_mega.csv\")\nfiltered_df4_mega &lt;- read.csv(\"./megalogo/filtered_mutDNA_mega.csv\")\n\n# Plotting 'ndet' for each position for all virus library iterations\nwt &lt;- ggplot(filtered_df1_mega, aes(POSITION_p62, ndet)) +\n  geom_line(color = \"#FC5F60\") +\n  xlim(0,400) +\n  ylim(0,21) +\n  ggtitle(\"wtDNA\") +\n  theme_prism(base_size = 11, base_line_size = 0.5) + \n  labs(x = \"Position\", y = \"AA detected per pos. (ndet)\") + \n  theme(axis.title.y = element_text(size = 11))\n\nmutVirusp1 &lt;- ggplot(filtered_df2_mega, aes(POSITION_p62, ndet)) +\n  geom_line(color = \"#B44385\") +\n  xlim(0,400) +\n  ylim(0,21) +\n  ggtitle(\"mutVirus.p1\") +\n  scale_color_prism() +\n  theme_prism(base_size = 11, base_line_size = 0.5) + \n  labs(x = \"Position\", y = \"AA detected per pos. (ndet)\") + \n  theme(axis.title.y = element_text(size = 11))\n\nmutVirusp2 &lt;- ggplot(filtered_df3_mega, aes(POSITION_p62, ndet)) +\n  geom_line(color = \"#164A62\") +\n  xlim(0,400) +\n  ylim(0,21) +\n  ggtitle(\"mutVirus.p2\") +\n  theme_prism(base_size = 11, base_line_size = 0.5) + \n  labs(x = \"Position\", y = \"AA detected per pos. (ndet)\") + \n  theme(axis.title.y = element_text(size = 11))\n\nmutDNA &lt;- ggplot(filtered_df4_mega, aes(POSITION_p62, ndet)) +\n  geom_line(color = \"#5D578F\") +\n  xlim(0,400) +\n  ylim(0,21) +\n  ggtitle(\"mutDNA\") +\n  theme_prism(base_size = 11, base_line_size = 0.5) + \n  labs(x = \"Position\", y = \"AA detected per pos. (ndet)\") + \n  theme(axis.title.y = element_text(size = 11))\n\n# Print and save each 'ndet' plot\nprint(wt)\nggsave(\"./ndet/wtDNA.png\", plot = wt, device = \"png\", height = 4)\n\nprint(mutDNA)\nggsave(\"./ndet/mutDNA.png\", plot = mutDNA, device = \"png\", height = 4)\n\nprint(mutVirusp1)\nggsave(\"./ndet/mutVirusp1.png\", plot = mutVirusp1, device = \"png\", height = 4)\n\nprint(mutVirusp2)\nggsave(\"./ndet/mutVirusp2.png\", plot = mutVirusp2, device = \"png\", height = 4)\n\n# Combine into a grid plot\ngrid &lt;- grid.arrange(wt, mutVirusp1, mutVirusp2, mutDNA, ncol = 2, top = textGrob(\"Unique AA per codon position\", gp = gpar(fontsize = 14, fontface = \"bold\")))\ngrid\n\n# Export grid plot at given dpi and picture format\nggsave(\"./ndet/gridplot.png\", plot = grid, device = \"png\", dpi = 1200, width = 14, height = 10)\n\n\n\n\n\n\n\n\n\n\n\n\n\n(a) mutVirus.p2\n\n\n\n\n\n\n\n\n\n\n\n\n\n(b) mutDNA\n\n\n\n\n\n\n\n\n\n\n\n(c) mutVirus.p1\n\n\n\n\n\n\n\n\n\n\n\n(d) wtDNA\n\n\n\n\n\n\n\nFigure 1: \\(ndet\\) Lineplots\n\n\n\n\n\n5.3.3 mutDNA Replicate Comparison\nAn independent replicate of the mutDNA plasmid library was generated to check the rigor of the library mutagenesis. To compare the mutagenesis efficiency of replicate 1 and replicate 2, the following R analyses were performed.\n\n\nExpand to View Code Block\n\n\n\nlibrary_correlates.R\n\n#!/usr/bin/Rscript\n\n# GOAL: Generate comparison plots for virus library replicates\n# Packages to load\nlibrary(plyr)\nlibrary(dplyr)\nlibrary(tidyr)\nlibrary(stringr)\nlibrary(ggplot2)\nlibrary(reshape2)\nlibrary(ggprism)\nlibrary(gridExtra)\nlibrary(grid)\nlibrary(cowplot)\n\n# Read in CSV file from VirVarSeq for rep2\ndf5 &lt;- read.csv(\"mutDNA/mutDNA_r2_standard_prep_seed10252022_subSampled_25000000.Q.10.csv\")\n\n# Merge position and AA into single field\ndf5$MERGE &lt;- paste(df5$POSITION, df5$CODON)\n\n# Subset out only the mutated regions\ndf5_subset &lt;- df5 %&gt;%\n  filter(POSITION &lt;= 398) %&gt;%\n  filter(POSITION &gt;= 9)\n\n# Create mergable field on AA in adition to codon\ndf5_subset$MERGE_AA &lt;- paste(df5_subset$POSITION, df5_subset$AA)\n\n# Count and quality filtering\nfiltered_df5 &lt;- df5_subset %&gt;%\n  filter(CNT &gt; 100) %&gt;%\n  filter(FWD_MEAN_MIN_QUAL &gt;= 24) %&gt;%\n  filter(REV_MEAN_MIN_QUAL &gt;= 24)\n\n# Calculate ndet per position after filtering\nfiltered_df5 &lt;- filtered_df5 %&gt;%\n  group_by(POSITION) %&gt;%\n  mutate(ndet = length(unique(MERGE_AA)))\n\n# Determine avg. # of AAs per position based on filtering\nprint(mean(filtered_df5$ndet))\n\n# Adjust the POSITION field\nfiltered_df5 &lt;- filtered_df5 %&gt;%\n  mutate(POSITION_p62 = POSITION - 8)\n\n# Add MERGE_FRAC for megalogo\nfiltered_df5$MERGE_FRAC &lt;- 1 / filtered_df5$ndet\n\n# Write to CSV\nwrite.csv(filtered_df5, \"ndet/df5_ndet.csv\", row.names = FALSE)\n\n# Remove duplicate MERGE_AA rows for megalogo plotting purposes\nfiltered_df5_mega &lt;- filtered_df5 %&gt;%\n  group_by(MERGE_AA) %&gt;%\n  slice_max(order_by = CNT, with_ties = FALSE) %&gt;%\n  ungroup()\n\n# Sort on position\nfiltered_df5_mega &lt;- filtered_df5_mega[order(filtered_df5_mega$POSITION_p62), ]\n\n# Write to CSV\nwrite.csv(filtered_df5_mega, \"./megalogo/filtered_df5_mega.csv\", row.names = FALSE)\n\n# Plotting 'ndet' for each position for library rep2\nmutDNA &lt;- ggplot(filtered_df4_mega, aes(POSITION_p62, ndet)) +\n  geom_line(color = \"#5D578F\") +\n  xlim(0,400) +\n  ylim(0,21) +\n  ggtitle(\"mutDNA\") +\n  theme_prism(base_size = 11, base_line_size = 0.5) + \n  labs(x = \"Position\", y = \"AA detected per pos. (ndet)\") + \n  theme(axis.title.y = element_text(size = 11))\n\nprint(plot5)\nggsave(\"ndet/df5.png\", plot = plot5, device = \"png\", height = 4)\n\n# Subset dataframes of mutDNA rep1 (df3 from previous code block) and rep2\nfiltered_df3_subset &lt;- filtered_df3 %&gt;% \n  select(SAMPLE, POSITION, POSITION_p62, REF_CODON, REF_AA, ndet) %&gt;%\n  unique()\n\nfiltered_df5_subset &lt;- filtered_df5 %&gt;% \n  select(SAMPLE, POSITION, POSITION_p62, REF_CODON, REF_AA, ndet) %&gt;%\n  unique()\n\n# Add column suffixes for merging\ncolnames(filtered_df3_subset) &lt;- paste(colnames(filtered_df3_subset), \"df3\", sep = \"_\")\n\ncolnames(filtered_df5_subset) &lt;- paste(colnames(filtered_df5_subset), \"df5\", sep = \"_\")\n\n# Merge data frames\ncombined_wide_abb &lt;- bind_cols(filtered_df3_subset, filtered_df5_subset)\n\n# Calculate differences in ndet for each position of rep1 (df3) and rep2 (df5)\ncombined_wide_abb$residual &lt;- combined_wide_abb$ndet_df3 - combined_wide_abb$ndet_df5\n\n\ncombined_wide_abb &lt;- combined_wide_abb %&gt;%\n  mutate(residual_sample = case_when(\n    residual &gt; 0  ~ \"rep1\",\n    residual &lt; 0  ~ \"rep2\",\n    residual == 0 ~ NA\n  ))\n\ncombined_wide_abb &lt;- combined_wide_abb %&gt;%\n  mutate_at(c('residual'), ~na_if(., 0))\n\n# Remove suffixes for long df\nnames(filtered_df3_subset) &lt;- gsub(\"_df3$\", \"\", names(filtered_df3_subset))\nnames(filtered_df5_subset) &lt;- gsub(\"_df5$\", \"\", names(filtered_df5_subset))\n\ncombined_long_abb &lt;- bind_rows(filtered_df3_subset, filtered_df5_subset)\n\n\n# Plot overlapping lineplot of rep1 and rep2\nlineplot &lt;- ggplot(combined_long_abb, aes(x = POSITION_p62, y = ndet, color = SAMPLE)) +\n  geom_line(alpha = 0.9, size = 0.5, linetype = \"solid\") +\n  scale_color_manual(values = c(\"#5D578F\", \"#0496FF\"), \n                     labels = c(\"rep1\", \"rep2\"), \n                     name = \"Replicate\") +\n  scale_y_continuous(limits = c(0, 21),\n                     breaks = seq(0, 20, by = 5)) +\n  scale_x_continuous(limits = c(0, 400)) +\n  labs(title = \"mutDNA\",\n       x = NULL,\n       y = \"AA detected per pos. (ndet)\") +\n  theme_prism(base_size = 12) + \n  theme(axis.title = element_text(size = 12),\n        axis.text = element_text(size = 12),  \n        plot.title = element_text(size = 16, face = \"bold\"), \n        legend.title = element_text(),\n        axis.ticks.x = element_blank(),\n        axis.text.x = element_blank())\n\nprint(lineplot)\nggsave(\"ndet/lineplot.png\", plot = lineplot, height = 3, width = 7, dpi = 600)\n\n# Plot differences in rep1 and rep2 via positive/negative lollipop graph\nresiduals &lt;- ggplot(combined_wide_abb, aes(x = POSITION_p62_df5, y = residual, fill = residual_sample)) +\n  annotate(\"rect\", xmin = 0, xmax = 400, ymin = 0, ymax = 10, alpha = 0.1, fill = \"#5D578F\") +\n  annotate(\"rect\", xmin = 0, xmax = 400, ymin = -10, ymax = 0, alpha = 0.1, fill = \"#0496FF\") +\n  geom_col(aes(fill = residual_sample), width = 0.5, na.rm = TRUE) +\n  geom_point(alpha = 1, shape = 21, fill = \"white\", color = \"#3C3C3C\", size = 1, show.legend = TRUE, na.rm = TRUE) +\n  scale_y_continuous(limits = c(-10, 10),\n                     breaks = seq(-10, 10, by = 10)) +\n  scale_fill_manual(values = c(\"rep1\" = \"#5D578F\", \"rep2\"= \"#0496FF\"), \n                     labels = c(\"rep1\" = \"\\U2191 rep1\", \"rep2\" = \"\\U2191 rep2\"), \n                     name = \"Replicate\", \n                     breaks = c(\"rep1\", \"rep2\"),\n                     na.translate = FALSE) +\n  scale_color_manual(values = c(\"rep1\" = \"#5D578F\", \"rep2\"= \"#0496FF\"), \n                     labels = c(\"rep1\" = \"rep1\", \"rep2\" = \"rep2\"), \n                     name = \"Replicate\", \n                     breaks = c(\"rep1\", \"rep2\"),\n                     na.translate = FALSE) +\n  geom_hline(yintercept = 0) +\n  labs(title = NULL,\n       x = \"Position\",\n       y = \"+/- (ndet)\") +\n  theme_prism(base_size = 12) +\n  theme(axis.title = element_text(size = 12),\n        axis.text = element_text(size = 12),  \n        plot.title = element_text(size = 16, face = \"bold\"), \n        legend.title = element_text(), \n        legend.text = element_text(family = \"arial\"),\n        axis.ticks = element_line()\n  )\n\nprint(residuals)\nggsave(\"ndet/residuals.png\", plot = residuals, height = 2, width = 7)\n\n# Combine into single figure\nreplicates_grid &lt;- plot_grid(lineplot, residuals, align = \"v\", nrow = 2, rel_heights = c(3, 2))\nprint(grid)\n\nggsave(\"ndet/replicates_grid.png\", plot = grid, width = 7)\n\n\n\n\n\n\n\n\n\n\n\n(a) \\(ndet\\) Lineplots\n\n\n\n\n\n\n\n\n\n(b) \\(ndet\\) Residuals\n\n\n\n\n\nFigure 2: mutDNA Replicate Comparison of \\(ndet\\)\n\n\n\n\n\n\n5.4 \\(neff\\)\nComparing the \\(ndet\\) metric with a traditional DMS metric, \\(neff\\).\n\n5.4.1 Calculation\nTo compare the results of our new metric, \\(ndet\\), with a traditional metric of mutational tolerance referred to as \\(neff\\), or number of effective AAs (also referred to as “preferences”), the following script was run to calculate the preference of mutVirus.p2 when compared with the baseline mutDNA library.\nBecause these samples were sequenced on different runs, each sample was independently error corrected with their run’s corresponding wtDNA sequencing control.\n\n\nstep3c_prefs.sh\n\n#!/bin/bash\n\ndms2_prefs --chartype codon_to_aa --excludestop yes --pre mutDNA_wide_sum.txt --post mutVirusp2_wide_sum.txt --name p2errorvsDNA --err wtDNA_DNArun_wide_sum.txt  wtDNA_p2run_wide_sum.txt --ncpus 4\n\n\n\n5.4.2 Visualization\nTo visually compare the \\(neff\\) metric for mutVirus.p2 with the corresponding \\(ndet\\) lineplot, the following R script was run.\n\n\nExpand to View Code Block\n\n\n\nneff_comparison.R\n\n#!/usr/bin/Rscript\n\n# GOAL: To plot neff for mutVirus.p2 over mutDNA (minus wtDNA) for comparison with the corresponding ndet plot.\n# Packages to load\nlibrary(ggplot2)\n\n# Load in prefs file from dms_tools2 \nprefs &lt;- read.csv(\"~/p2vsDNAerror_prefs_entropy.csv\")\n\n# Plot lineplot using ggplot2\nlineplot_neff &lt;- ggplot(prefs, aes(x = POSITION, y = neff)) +\n  geom_line(color = \"red\") + \n  xlim(0,400) +\n  ylim(0,21) +\n  ggtitle(\"mutVirus.p2\") +\n  theme_prism(base_size = 11, base_line_size = 0.5) + \n  labs(x = \"Position\", \n       y = \"AA effective per pos. (neff)\") + \n  theme(axis.title.y = element_text(size = 11))\n\nprint(lineplot_neff)\n\nggsave(\"neff.png\", plot = lineplot_neff, device = \"png\", height = 3, width = 5, dpi = 600)\n\n\n\n\n\n\n\n\n\nFigure 3: mutVirus.p2 (\\(neff\\))\n\n\n\n\n\n\n\n5.5 megalogo\nCreating logoplots to visualize per-position amino acid diversity.\n\n5.5.1 \\(\\text{MERGE\\_FRAC}\\) Calculation\nSee step3_diversity_analysis.R code block lines 128-132 for calculation of \\(\\text{MERGE\\_FRAC}\\) to pass to the megalogo software.\nIn brief, the math is as follows:\n\\[F_{site} = \\frac{1}{ndet}\\]\nFor plotting the filtered residues into logoplots, each position stack was set to total a value of 1.0 and the height of the AA (\\(F_{site}\\)) is inversely proportional to the number of total AAs (\\(ndet\\)) at the site. Thus, the size of each residue does not indicate the relative frequencies of these amino acids in the virus library but rather the mutational tolerance at that codon position.\n\n\n5.5.2 Visualization\nTo generate logoplots, we developed software, megalogo, to visualize the \\(ndet\\) metric with customizable line breaks, annotatable domain labels and WT residues, as well as logical tick break intervals. The code to execute the logoplots for this manuscript can be found below.\n\n\nExpand to View Code Block\n\n\n\nstep4_megalogo_lib_characterization.sh\n\n#!/bin/bash\n\npython3 megalogo.py --input ./06132023/dedup_logo_files/wtDNA_filtered_df1_dedup.csv --sampleName wtDNA --annotConfig ../ref/annotations_config.csv --refAA ../ref/wildtype.csv --codonStartPos 1 --output ./06132023/dedup_logo_files/output/wtDNA.png \n\npython3 megalogo.py --input ./06132023/dedup_logo_files/mutDNA_filtered_df4_dedup.csv --sampleName mutDNA --annotConfig ../ref/annotations_config.csv --refAA ../ref/wildtype.csv --codonStartPos 1 --output ./06132023/dedup_logo_files/output/mutDNA.png \n\npython3 megalogo.py --input ./06132023/dedup_logo_files/mutVirusp1_filtered_df2_dedup.csv --sampleName mutVirus.p1 --annotConfig ../ref/annotations_config.csv --refAA ../ref/wildtype.csv --codonStartPos 1 --output ./06132023/dedup_logo_files/output/mutVirusp1.png \n\npython3 megalogo.py --input ./06132023/dedup_logo_files/mutVirusp2_filtered_df3_dedup.csv --sampleName mutVirus.p2 --annotConfig ../ref/annotations_config.csv --refAA ../ref/wildtype.csv --codonStartPos 1 --output ./06132023/dedup_logo_files/output/mutVirusp2.png \n\n\n\n\n\n\n\n\n\n\n\n\n\n(a) mutVirus.p2\n\n\n\n\n\n\n\n\n\n\n\n\n\n(b) mutDNA\n\n\n\n\n\n\n\n\n\n\n\n(c) mutVirus.p1\n\n\n\n\n\n\n\n\n\n\n\n(d) wtDNA\n\n\n\n\n\n\n\nFigure 4: \\(ndet\\) Logoplots\n\n\n\n\n\n\n5.6 batchdiffsel\nCalculating differential selection for monoclonal antibody escape assays.\n\n5.6.1 Formatting\nBecause the output format for VirVarSeq does not meet the requirements to calculate differential selection, in-house R code (below) was utilized to format per the dms_tools2 requirements.\n\n\n\n\n\n\nWarning\n\n\n\nThe code process below is heavily R dependent and not well suited for large batches of samples. Moving forward, pipeline will be converted to a loop-based algorithm and executed with remote compute nodes.\n\n\n\n\nExpand to View Code Block\n\n\n\nstep5_dmstools_prep.R\n\n#!/usr/bin/Rscript\n\n# GOAL: To reformat the VirVarSeq output for differential selection calculation per dms_tools2 formatting requirements.\n# Packages to load\nlibrary(plyr)\nlibrary(dplyr)\nlibrary(ggplot2)\nlibrary(reshape2)\nlibrary(tidyr)\nlibrary(stringr)\n\n# Set working directory to find VirVarSeq output matrices\nsetwd(\"./08012023/VirVarSeq/results/mixture_model/diffsel\")\n\n# List file names but then need to open in excel and save as .csv file\n# List.files(path = \".\", pattern = \".Q.10.codon\")\n\n# Confirm all files successfully converted to .csv\nlist.files(path = \".\", pattern = \".Q.10.csv\")\n\n# Read in .csv files from VirVarSeq\ndf1 &lt;- read.csv(\"wtDNA_seed08122023_subsampled_25000000.Q.10.csv\")\ndf2 &lt;- read.csv(\"mutVirus_p2_seed06212023_subsampled_25000000.Q.10.csv\")\ndf3 &lt;- read.csv(\"mutVirus_CHK11_1_1_seed08122023_subsampled_25000000.Q.10.csv\")\ndf4 &lt;- read.csv(\"mutVirus_CHK11_3_1_seed08122023_subsampled_25000000.Q.10.csv\")\ndf5 &lt;- read.csv(\"mutVirus_CHK152_1_2_seed08122023_subsampled_25000000.Q.10.csv\")\ndf6 &lt;- read.csv(\"mutVirus_CHK152_2_1_seed08122023_subsampled_25000000.Q.10.csv\")\ndf7 &lt;- read.csv(\"mutVirus_CHK265_1_2_seed08122023_subsampled_25000000.Q.10.csv\")\ndf8 &lt;- read.csv(\"mutVirus_CHK265_2_3_seed08122023_subsampled_25000000.Q.10.csv\")\ndf9 &lt;- read.csv(\"mutVirus_only_1_2_seed08122023_subsampled_25000000.Q.10.csv\")\ndf10 &lt;- read.csv(\"mutVirus_only_2_1_seed08122023_subsampled_25000000.Q.10.csv\")\n\n# Merge position and AA into single field in order to be able to sort/combine/melt/etc.\ndf1$MERGE &lt;- paste(df1$POSITION, df1$AA)\ndf2$MERGE &lt;- paste(df2$POSITION, df2$AA)\ndf3$MERGE &lt;- paste(df3$POSITION, df3$AA)\ndf4$MERGE &lt;- paste(df4$POSITION, df4$AA)\ndf5$MERGE &lt;- paste(df5$POSITION, df5$AA)\ndf6$MERGE &lt;- paste(df6$POSITION, df6$AA)\ndf7$MERGE &lt;- paste(df7$POSITION, df7$AA)\ndf8$MERGE &lt;- paste(df8$POSITION, df8$AA)\ndf9$MERGE &lt;- paste(df9$POSITION, df9$AA)\ndf10$MERGE &lt;- paste(df10$POSITION, df10$AA)\n\n# Subset out only the mutated regions\ndf1_subset &lt;- df1 %&gt;%\n  filter(POSITION &lt;= 398) %&gt;%\n  filter(POSITION &gt;= 9)\n\ndf2_subset &lt;- df2 %&gt;%\n  filter(POSITION &lt;= 398) %&gt;%\n  filter(POSITION &gt;= 9)\n\ndf3_subset &lt;- df3 %&gt;%\n  filter(POSITION &lt;= 398) %&gt;%\n  filter(POSITION &gt;= 9)\n\ndf4_subset &lt;- df4 %&gt;%\n  filter(POSITION &lt;= 398) %&gt;%\n  filter(POSITION &gt;= 9)\n\ndf5_subset &lt;- df5 %&gt;%\n  filter(POSITION &lt;= 398) %&gt;%\n  filter(POSITION &gt;= 9)\n\ndf6_subset &lt;- df6 %&gt;%\n  filter(POSITION &lt;= 398) %&gt;%\n  filter(POSITION &gt;= 9)\n\ndf7_subset &lt;- df7 %&gt;%\n  filter(POSITION &lt;= 398) %&gt;%\n  filter(POSITION &gt;= 9)\n\ndf8_subset &lt;- df8 %&gt;%\n  filter(POSITION &lt;= 398) %&gt;%\n  filter(POSITION &gt;= 9)\n\ndf9_subset &lt;- df9 %&gt;%\n  filter(POSITION &lt;= 398) %&gt;%\n  filter(POSITION &gt;= 9)\n\ndf10_subset &lt;- df10 %&gt;%\n  filter(POSITION &lt;= 398) %&gt;%\n  filter(POSITION &gt;= 9)\n\n# Calculate the total reads for each amino acid, not codon, per position\ndf1_subset_sum &lt;- df1_subset %&gt;%\n  group_by(MERGE) %&gt;%\n  summarise(SUM = sum(CNT))\n\ndf2_subset_sum &lt;- df2_subset %&gt;%\n  group_by(MERGE) %&gt;%\n  summarise(SUM = sum(CNT))\n\ndf3_subset_sum &lt;- df3_subset %&gt;%\n  group_by(MERGE) %&gt;%\n  summarise(SUM = sum(CNT))\n\ndf4_subset_sum &lt;- df4_subset %&gt;%\n  group_by(MERGE) %&gt;%\n  summarise(SUM = sum(CNT))\n\ndf5_subset_sum &lt;- df5_subset %&gt;%\n  group_by(MERGE) %&gt;%\n  summarise(SUM = sum(CNT))\n\ndf6_subset_sum &lt;- df6_subset %&gt;%\n  group_by(MERGE) %&gt;%\n  summarise(SUM = sum(CNT))\n\ndf7_subset_sum &lt;- df7_subset %&gt;%\n  group_by(MERGE) %&gt;%\n  summarise(SUM = sum(CNT))\n\ndf8_subset_sum &lt;- df8_subset %&gt;%\n  group_by(MERGE) %&gt;%\n  summarise(SUM = sum(CNT))\n\ndf9_subset_sum &lt;- df9_subset %&gt;%\n  group_by(MERGE) %&gt;%\n  summarise(SUM = sum(CNT))\n\ndf10_subset_sum &lt;- df10_subset %&gt;%\n  group_by(MERGE) %&gt;%\n  summarise(SUM = sum(CNT))\n\n# Combine this field with the original dataframe\ndf1_subset_sum &lt;- merge(df1_subset, df1_subset_sum, by = \"MERGE\", all = T)\ndf2_subset_sum &lt;- merge(df2_subset, df2_subset_sum, by = \"MERGE\", all = T)\ndf3_subset_sum &lt;- merge(df3_subset, df3_subset_sum, by = \"MERGE\", all = T)\ndf4_subset_sum &lt;- merge(df4_subset, df4_subset_sum, by = \"MERGE\", all = T)\ndf5_subset_sum &lt;- merge(df5_subset, df5_subset_sum, by = \"MERGE\", all = T)\ndf6_subset_sum &lt;- merge(df6_subset, df6_subset_sum, by = \"MERGE\", all = T)\ndf7_subset_sum &lt;- merge(df7_subset, df7_subset_sum, by = \"MERGE\", all = T)\ndf8_subset_sum &lt;- merge(df8_subset, df8_subset_sum, by = \"MERGE\", all = T)\ndf9_subset_sum &lt;- merge(df9_subset, df9_subset_sum, by = \"MERGE\", all = T)\ndf10_subset_sum &lt;- merge(df10_subset, df10_subset_sum, by = \"MERGE\", all = T)\n\n# Filter based on TB filter requirements\nfiltered_df1_subset_sum &lt;- df1_subset_sum %&gt;%\n  filter(CNT &gt; 100) %&gt;%\n  filter(FWD_MEAN_MIN_QUAL &gt;= 24) %&gt;%\n  filter(REV_MEAN_MIN_QUAL &gt;= 24)\n\nfiltered_df2_subset_sum &lt;- df2_subset_sum %&gt;%\n  filter(CNT &gt; 100) %&gt;%\n  filter(FWD_MEAN_MIN_QUAL &gt;= 24) %&gt;%\n  filter(REV_MEAN_MIN_QUAL &gt;= 24)\n\nfiltered_df3_subset_sum &lt;- df3_subset_sum %&gt;%\n  filter(CNT &gt; 100) %&gt;%\n  filter(FWD_MEAN_MIN_QUAL &gt;= 24) %&gt;%\n  filter(REV_MEAN_MIN_QUAL &gt;= 24)\n\nfiltered_df4_subset_sum &lt;- df4_subset_sum %&gt;%\n  filter(CNT &gt; 100) %&gt;%\n  filter(FWD_MEAN_MIN_QUAL &gt;= 24) %&gt;%\n  filter(REV_MEAN_MIN_QUAL &gt;= 24)\n\nfiltered_df5_subset_sum &lt;- df5_subset_sum %&gt;%\n  filter(CNT &gt; 100) %&gt;%\n  filter(FWD_MEAN_MIN_QUAL &gt;= 24) %&gt;%\n  filter(REV_MEAN_MIN_QUAL &gt;= 24)\n\nfiltered_df6_subset_sum &lt;- df6_subset_sum %&gt;%\n  filter(CNT &gt; 100) %&gt;%\n  filter(FWD_MEAN_MIN_QUAL &gt;= 24) %&gt;%\n  filter(REV_MEAN_MIN_QUAL &gt;= 24)\n\nfiltered_df7_subset_sum &lt;- df7_subset_sum %&gt;%\n  filter(CNT &gt; 100) %&gt;%\n  filter(FWD_MEAN_MIN_QUAL &gt;= 24) %&gt;%\n  filter(REV_MEAN_MIN_QUAL &gt;= 24)\n\nfiltered_df8_subset_sum &lt;- df8_subset_sum %&gt;%\n  filter(CNT &gt; 100) %&gt;%\n  filter(FWD_MEAN_MIN_QUAL &gt;= 24) %&gt;%\n  filter(REV_MEAN_MIN_QUAL &gt;= 24)\n\nfiltered_df9_subset_sum &lt;- df9_subset_sum %&gt;%\n  filter(CNT &gt; 100) %&gt;%\n  filter(FWD_MEAN_MIN_QUAL &gt;= 24) %&gt;%\n  filter(REV_MEAN_MIN_QUAL &gt;= 24)\n\nfiltered_df10_subset_sum &lt;- df10_subset_sum %&gt;%\n  filter(CNT &gt; 100) %&gt;%\n  filter(FWD_MEAN_MIN_QUAL &gt;= 24) %&gt;%\n  filter(REV_MEAN_MIN_QUAL &gt;= 24)\n\n# Calculate the per amino acid position mutational frequency (not codon)\nfiltered_df1_subset_sum$grouped_freq &lt;- filtered_df1_subset_sum$SUM/filtered_df1_subset_sum$DENOM\nfiltered_df2_subset_sum$grouped_freq &lt;- filtered_df2_subset_sum$SUM/filtered_df2_subset_sum$DENOM\nfiltered_df3_subset_sum$grouped_freq &lt;- filtered_df3_subset_sum$SUM/filtered_df3_subset_sum$DENOM\nfiltered_df4_subset_sum$grouped_freq &lt;- filtered_df4_subset_sum$SUM/filtered_df4_subset_sum$DENOM\nfiltered_df5_subset_sum$grouped_freq &lt;- filtered_df5_subset_sum$SUM/filtered_df5_subset_sum$DENOM\nfiltered_df6_subset_sum$grouped_freq &lt;- filtered_df6_subset_sum$SUM/filtered_df6_subset_sum$DENOM\nfiltered_df7_subset_sum$grouped_freq &lt;- filtered_df7_subset_sum$SUM/filtered_df7_subset_sum$DENOM\nfiltered_df8_subset_sum$grouped_freq &lt;- filtered_df8_subset_sum$SUM/filtered_df8_subset_sum$DENOM\nfiltered_df9_subset_sum$grouped_freq &lt;- filtered_df9_subset_sum$SUM/filtered_df9_subset_sum$DENOM\nfiltered_df10_subset_sum$grouped_freq &lt;- filtered_df10_subset_sum$SUM/filtered_df10_subset_sum$DENOM\n\n\n# Subset out only the relevant fields to prepare for dms_tools2\ndf1deduplicated &lt;- filtered_df1_subset_sum[,c(\"POSITION\", \"REF_CODON\", \"CODON\", \"CNT\")]\ndf2deduplicated &lt;- filtered_df2_subset_sum[,c(\"POSITION\", \"REF_CODON\", \"CODON\", \"CNT\")]\ndf3deduplicated &lt;- filtered_df3_subset_sum[,c(\"POSITION\", \"REF_CODON\", \"CODON\", \"CNT\")]\ndf4deduplicated &lt;- filtered_df4_subset_sum[,c(\"POSITION\", \"REF_CODON\", \"CODON\", \"CNT\")]\ndf5deduplicated &lt;- filtered_df5_subset_sum[,c(\"POSITION\", \"REF_CODON\", \"CODON\", \"CNT\")]\ndf6deduplicated &lt;- filtered_df6_subset_sum[,c(\"POSITION\", \"REF_CODON\", \"CODON\", \"CNT\")]\ndf7deduplicated &lt;- filtered_df7_subset_sum[,c(\"POSITION\", \"REF_CODON\", \"CODON\", \"CNT\")]\ndf8deduplicated &lt;- filtered_df8_subset_sum[,c(\"POSITION\", \"REF_CODON\", \"CODON\", \"CNT\")]\ndf9deduplicated &lt;- filtered_df9_subset_sum[,c(\"POSITION\", \"REF_CODON\", \"CODON\", \"CNT\")]\ndf10deduplicated &lt;- filtered_df10_subset_sum[,c(\"POSITION\", \"REF_CODON\", \"CODON\", \"CNT\")]\n\n# Subset only the distinct (deduplicated) rows\ndf1deduplicated &lt;- distinct(df1deduplicated)\ndf2deduplicated &lt;- distinct(df2deduplicated)\ndf3deduplicated &lt;- distinct(df3deduplicated)\ndf4deduplicated &lt;- distinct(df4deduplicated)\ndf5deduplicated &lt;- distinct(df5deduplicated)\ndf6deduplicated &lt;- distinct(df6deduplicated)\ndf7deduplicated &lt;- distinct(df7deduplicated)\ndf8deduplicated &lt;- distinct(df8deduplicated)\ndf9deduplicated &lt;- distinct(df9deduplicated)\ndf10deduplicated &lt;- distinct(df10deduplicated)\n\n# Write to csv in current working directory)\nwrite.csv(df1deduplicated, \"df1_deduplicated.csv\")\nwrite.csv(df2deduplicated, \"df2_deduplicated.csv\")\nwrite.csv(df3deduplicated, \"df3_deduplicated.csv\")\nwrite.csv(df4deduplicated, \"df4_deduplicated.csv\")\nwrite.csv(df5deduplicated, \"df5_deduplicated.csv\")\nwrite.csv(df6deduplicated, \"df6_deduplicated.csv\")\nwrite.csv(df7deduplicated, \"df7_deduplicated.csv\")\nwrite.csv(df8deduplicated, \"df8_deduplicated.csv\")\nwrite.csv(df9deduplicated, \"df9_deduplicated.csv\")\nwrite.csv(df10deduplicated, \"df10_deduplicated.csv\")\n\n# Convert to wide format\ndf1_wide_sum &lt;- df1deduplicated %&gt;%\n  spread(CODON, CNT)\ndf2_wide_sum &lt;- df2deduplicated %&gt;%\n  spread(CODON, CNT)\ndf3_wide_sum &lt;- df3deduplicated %&gt;%\n  spread(CODON, CNT)\ndf4_wide_sum &lt;- df4deduplicated %&gt;%\n  spread(CODON, CNT)\ndf5_wide_sum &lt;- df5deduplicated %&gt;%\n  spread(CODON, CNT)\ndf6_wide_sum &lt;- df6deduplicated %&gt;%\n  spread(CODON, CNT)\ndf7_wide_sum &lt;- df7deduplicated %&gt;%\n  spread(CODON, CNT)\ndf8_wide_sum &lt;- df8deduplicated %&gt;%\n  spread(CODON, CNT)\ndf9_wide_sum &lt;- df9deduplicated %&gt;%\n  spread(CODON, CNT)\ndf10_wide_sum &lt;- df10deduplicated %&gt;%\n  spread(CODON, CNT)\n\n# Rename column names to be easily read by dms_tools2.prefs\ncolnames(df1_wide_sum)[1] = \"site\"\ncolnames(df2_wide_sum)[1] = \"site\"\ncolnames(df3_wide_sum)[1] = \"site\"\ncolnames(df4_wide_sum)[1] = \"site\"\ncolnames(df5_wide_sum)[1] = \"site\"\ncolnames(df6_wide_sum)[1] = \"site\"\ncolnames(df7_wide_sum)[1] = \"site\"\ncolnames(df8_wide_sum)[1] = \"site\"\ncolnames(df9_wide_sum)[1] = \"site\"\ncolnames(df10_wide_sum)[1] = \"site\"\n\ncolnames(df1_wide_sum)[2] = \"wildtype\" \ncolnames(df2_wide_sum)[2] = \"wildtype\" \ncolnames(df3_wide_sum)[2] = \"wildtype\" \ncolnames(df4_wide_sum)[2] = \"wildtype\" \ncolnames(df5_wide_sum)[2] = \"wildtype\" \ncolnames(df6_wide_sum)[2] = \"wildtype\"\ncolnames(df7_wide_sum)[2] = \"wildtype\" \ncolnames(df8_wide_sum)[2] = \"wildtype\"\ncolnames(df9_wide_sum)[2] = \"wildtype\" \ncolnames(df10_wide_sum)[2] = \"wildtype\" \n\n# Remove NAs and replace with zeros\ndf1_wide_sum[is.na(df1_wide_sum)] &lt;- 0\ndf2_wide_sum[is.na(df2_wide_sum)] &lt;- 0\ndf3_wide_sum[is.na(df3_wide_sum)] &lt;- 0\ndf4_wide_sum[is.na(df4_wide_sum)] &lt;- 0\ndf5_wide_sum[is.na(df5_wide_sum)] &lt;- 0\ndf6_wide_sum[is.na(df6_wide_sum)] &lt;- 0\ndf7_wide_sum[is.na(df7_wide_sum)] &lt;- 0\ndf8_wide_sum[is.na(df8_wide_sum)] &lt;- 0\ndf9_wide_sum[is.na(df9_wide_sum)] &lt;- 0\ndf10_wide_sum[is.na(df10_wide_sum)] &lt;- 0\n\n# Set site numbers to start at 1, not 9\ndf1_wide_sum$site &lt;- c(1:390)\ndf2_wide_sum$site &lt;- c(1:390)\ndf3_wide_sum$site &lt;- c(1:390)\ndf4_wide_sum$site &lt;- c(1:390)\ndf5_wide_sum$site &lt;- c(1:390)\ndf6_wide_sum$site &lt;- c(1:390)\ndf7_wide_sum$site &lt;- c(1:390)\ndf8_wide_sum$site &lt;- c(1:390)\ndf9_wide_sum$site &lt;- c(1:390)\ndf10_wide_sum$site &lt;- c(1:390)\n\n# Write to csv in current working directory\nwrite.csv(df1_wide_sum, \"wtDNA_codoncounts.csv\", row.names = FALSE)\nwrite.csv(df2_wide_sum, \"mutVirus-only-old_codoncounts.csv\", row.names = FALSE)\nwrite.csv(df3_wide_sum, \"CHK-11-1_codoncounts.csv\", row.names = FALSE)\nwrite.csv(df4_wide_sum, \"CHK-11-2_codoncounts.csv\", row.names = FALSE)\nwrite.csv(df5_wide_sum, \"CHK-152-1_codoncounts.csv\", row.names = FALSE)\nwrite.csv(df6_wide_sum, \"CHK-152-2_codoncounts.csv\", row.names = FALSE)\nwrite.csv(df7_wide_sum, \"CHK-265-1_codoncounts.csv\", row.names = FALSE)\nwrite.csv(df8_wide_sum, \"CHK-265-2_codoncounts.csv\", row.names = FALSE)\nwrite.csv(df9_wide_sum, \"mutVirus-only-1_codoncounts.csv\", row.names = FALSE)\nwrite.csv(df10_wide_sum, \"mutVirus-only-2_codoncounts.csv\", row.names = FALSE)\n\n# Write to txt in current working directory (actual input for dms_tools2)\nwrite.csv(df1_wide_sum, \"wtDNA_codoncounts.txt\", sep = \"\\t\", row.names = FALSE)\nwrite.csv(df2_wide_sum, \"mutVirus-only-old_codoncounts.txt\", sep = \"\\t\", row.names = FALSE)\nwrite.csv(df3_wide_sum, \"CHK-11-1_codoncounts.txt\", sep = \"\\t\", row.names = FALSE)\nwrite.csv(df4_wide_sum, \"CHK-11-2_codoncounts.txt\", sep = \"\\t\", row.names = FALSE)\nwrite.csv(df5_wide_sum, \"CHK-152-1_codoncounts.txt\", sep = \"\\t\", row.names = FALSE)\nwrite.csv(df6_wide_sum, \"CHK-152-2_codoncounts.txt\", sep = \"\\t\", row.names = FALSE)\nwrite.csv(df7_wide_sum, \"CHK-265-1_codoncounts.txt\", sep = \"\\t\", row.names = FALSE)\nwrite.csv(df8_wide_sum, \"CHK-265-2_codoncounts.txt\", sep = \"\\t\", row.names = FALSE)\nwrite.csv(df9_wide_sum, \"mutVirus-only-1_codoncounts.txt\", sep = \"\\t\", row.names = FALSE)\nwrite.csv(df10_wide_sum, \"mutVirus-only-2_codoncounts.txt\", sep = \"\\t\", row.names = FALSE)\n\n\n\n\n5.6.2 Execution\n\n\n\n\nTable 1: batchfile.csv\n\n\n\n\n\n\ngroup\nname\nsel\nmock\nerr\n\n\n\n\nCHK-11\nreplicate-1-v1\nCHK-11-1\nmutVirus-only-1\nwtDNA\n\n\nCHK-11\nreplicate-2-v1\nCHK-11-2\nmutVirus-only-1\nwtDNA\n\n\nCHK-11\nreplicate-1-v2\nCHK-11-1\nmutVirus-only-2\nwtDNA\n\n\nCHK-11\nreplicate-2-v2\nCHK-11-2\nmutVirus-only-2\nwtDNA\n\n\nCHK-152\nreplicate-1-v1\nCHK-152-1\nmutVirus-only-1\nwtDNA\n\n\nCHK-152\nreplicate-2-v1\nCHK-152-2\nmutVirus-only-1\nwtDNA\n\n\nCHK-152\nreplicate-1-v2\nCHK-152-1\nmutVirus-only-2\nwtDNA\n\n\nCHK-152\nreplicate-2-v2\nCHK-152-2\nmutVirus-only-2\nwtDNA\n\n\nCHK-265\nreplicate-1-v1\nCHK-265-1\nmutVirus-only-1\nwtDNA\n\n\nCHK-265\nreplicate-2-v1\nCHK-265-2\nmutVirus-only-1\nwtDNA\n\n\nCHK-265\nreplicate-1-v2\nCHK-265-1\nmutVirus-only-2\nwtDNA\n\n\nCHK-265\nreplicate-2-v2\nCHK-265-2\nmutVirus-only-2\nwtDNA\n\n\n\n\n\n\n\n\n With the above batch file, the following code was executed to generate summary results for each replicate against all other replicates.\n\n\nstep6_dmstools_diffsel.sh\n\n#!/bin/bash\n\ndms2_batch_diffsel --outdir output --indir ./input/ --ncpus 10 --batchfile ./input/batchfile.csv --summaryprefix summary\n\n\n\n\n5.7 dmslogo\nPlotting sites of escape for validation experiments and previously-identified critical antibody sites.\n\n5.7.1 Visualization\n\n\nJupyter analysis notebook for analyzing differential selection data using dmslogo software for logoplot generation.\n\n5.7.2 Import Packages\n\n\n5.7.3 Import Data\n\n\n\n\n\n\n\n\n\nsite\nwildtype\nmutation\nmutdiffsel\n\n\n\n\n3013\n1\nS\nA\n0.000022\n\n\n3004\n1\nS\nC\n0.000022\n\n\n2999\n1\nS\nD\n0.000022\n\n\n3002\n1\nS\nE\n0.000022\n\n\n3005\n1\nS\nF\n0.000022\n\n\n...\n...\n...\n...\n...\n\n\n3094\n390\nL\nS\n0.000013\n\n\n3084\n390\nL\nT\n0.000013\n\n\n3091\n390\nL\nV\n0.000013\n\n\n3095\n390\nL\nW\n0.000013\n\n\n3097\n390\nL\nY\n0.000013\n\n\n\n\n7410 rows × 4 columns\n\n\n\n\n\n\n\n\n\n\n\n\nsite\nwildtype\nmutation\nmutdiffsel\n\n\n\n\n3070\n1\nS\nA\n1.293007e-05\n\n\n3069\n1\nS\nC\n1.293007e-05\n\n\n3080\n1\nS\nD\n1.293007e-05\n\n\n3072\n1\nS\nE\n1.293007e-05\n\n\n3071\n1\nS\nF\n1.293007e-05\n\n\n...\n...\n...\n...\n...\n\n\n3361\n390\nL\nS\n1.601713e-16\n\n\n3362\n390\nL\nT\n1.601713e-16\n\n\n3363\n390\nL\nV\n1.601713e-16\n\n\n3364\n390\nL\nW\n1.601713e-16\n\n\n3347\n390\nL\nY\n1.601713e-16\n\n\n\n\n7800 rows × 4 columns\n\n\n\n\n\n\n\n\n\n\n\n\nsite\nwildtype\nmutation\nmutdiffsel\n\n\n\n\n3125\n1\nS\nA\n2.401568e-05\n\n\n3124\n1\nS\nC\n2.401568e-05\n\n\n3126\n1\nS\nD\n2.401568e-05\n\n\n3128\n1\nS\nE\n2.401568e-05\n\n\n3129\n1\nS\nF\n2.401568e-05\n\n\n...\n...\n...\n...\n...\n\n\n3637\n390\nL\nS\n-1.601713e-16\n\n\n3639\n390\nL\nT\n-1.601713e-16\n\n\n3640\n390\nL\nV\n-1.601713e-16\n\n\n3641\n390\nL\nW\n-1.601713e-16\n\n\n3636\n390\nL\nY\n-1.601713e-16\n\n\n\n\n7800 rows × 4 columns\n\n\n\n\n\n5.7.4 Identify Sites for Plotting\n\n\n\n\n\n\n\n\n\nsite\nwildtype\nmutation\nmutdiffsel\nsite_label\n\n\n\n\n6804\n40\nD\nA\n-0.657902\nD40\n\n\n126\n40\nD\nC\n2.386392\nD40\n\n\n6330\n40\nD\nE\n-0.275685\nD40\n\n\n5768\n40\nD\nF\n-0.053723\nD40\n\n\n392\n40\nD\nG\n0.457301\nD40\n\n\n...\n...\n...\n...\n...\n...\n\n\n6071\n241\nL\nS\n-0.160726\nL241\n\n\n6959\n241\nL\nT\n-1.025003\nL241\n\n\n6043\n241\nL\nV\n-0.152095\nL241\n\n\n6734\n241\nL\nW\n-0.573042\nL241\n\n\n1016\n241\nL\nY\n0.123828\nL241\n\n\n\n\n133 rows × 5 columns\n\n\n\n\n\n\n\n\n\n\n\n\nsite\nwildtype\nmutation\nmutdiffsel\nsite_label\n\n\n\n\n6850\n40\nD\nA\n-1.234171\nD40\n\n\n4009\n40\nD\nC\n-0.000064\nD40\n\n\n7449\n40\nD\nD\nNaN\nD40\n\n\n641\n40\nD\nE\n0.344012\nD40\n\n\n7056\n40\nD\nF\n-2.412958\nD40\n\n\n...\n...\n...\n...\n...\n...\n\n\n7140\n241\nL\nS\n-2.794302\nL241\n\n\n6844\n241\nL\nT\n-1.191166\nL241\n\n\n498\n241\nL\nV\n0.460759\nL241\n\n\n788\n241\nL\nW\n0.257530\nL241\n\n\n751\n241\nL\nY\n0.281082\nL241\n\n\n\n\n140 rows × 5 columns\n\n\n\n\n\n\n\n\n\n\n\n\nsite\nwildtype\nmutation\nmutdiffsel\nsite_label\n\n\n\n\n7484\n11\nA\nA\nNaN\nA11\n\n\n1719\n11\nA\nC\n0.000583\nA11\n\n\n1720\n11\nA\nD\n0.000583\nA11\n\n\n1727\n11\nA\nE\n0.000583\nA11\n\n\n1717\n11\nA\nF\n0.000583\nA11\n\n\n...\n...\n...\n...\n...\n...\n\n\n3143\n235\nW\nS\n0.000007\nW235\n\n\n3144\n235\nW\nT\n0.000007\nW235\n\n\n3145\n235\nW\nV\n0.000007\nW235\n\n\n7708\n235\nW\nW\nNaN\nW235\n\n\n3141\n235\nW\nY\n0.000007\nW235\n\n\n\n\n180 rows × 5 columns\n\n\n\n\n\n\n\n\n\n\n\n\nsite\nwildtype\nmutation\nmutdiffsel\nsite_label\n\n\n\n\n6666\n40\nD\nA\n-0.402091\nD40\n\n\n5\n40\nD\nC\n5.670516\nD40\n\n\n7449\n40\nD\nD\nNaN\nD40\n\n\n5831\n40\nD\nE\n-0.035732\nD40\n\n\n211\n40\nD\nF\n0.952949\nD40\n\n\n...\n...\n...\n...\n...\n...\n\n\n7260\n241\nL\nS\n-2.836240\nL241\n\n\n7001\n241\nL\nT\n-1.007714\nL241\n\n\n5571\n241\nL\nV\n-0.001727\nL241\n\n\n6378\n241\nL\nW\n-0.226428\nL241\n\n\n802\n241\nL\nY\n0.212435\nL241\n\n\n\n\n140 rows × 5 columns\n\n\n\n\n\n\n\n\n\n\n\n\nsite\nwildtype\nmutation\nmutdiffsel\nsite_label\n\n\n\n\n6171\n24\nE\nA\n-0.138181\nE24\n\n\n6693\n24\nE\nC\n-0.422121\nE24\n\n\n5313\n24\nE\nD\n-0.000595\nE24\n\n\n7497\n24\nE\nE\nNaN\nE24\n\n\n5670\n24\nE\nF\n-0.006693\nE24\n\n\n...\n...\n...\n...\n...\n...\n\n\n213\n221\nK\nS\n0.928970\nK221\n\n\n1615\n221\nK\nT\n0.000731\nK221\n\n\n5595\n221\nK\nV\n-0.002103\nK221\n\n\n1616\n221\nK\nW\n0.000731\nK221\n\n\n1617\n221\nK\nY\n0.000731\nK221\n\n\n\n\n1180 rows × 5 columns\n\n\n\n\n\n\n\n\n\n\n\n\nsite\nwildtype\nmutation\nmutdiffsel\nsite_label\n\n\n\n\n6171\n24\nE\nA\n0.000000\nE24\n\n\n6693\n24\nE\nC\n0.000000\nE24\n\n\n5313\n24\nE\nD\n0.000000\nE24\n\n\n7497\n24\nE\nE\nNaN\nE24\n\n\n5670\n24\nE\nF\n0.000000\nE24\n\n\n...\n...\n...\n...\n...\n...\n\n\n7595\n122\nS\nS\nNaN\nS122\n\n\n6271\n122\nS\nT\n0.000000\nS122\n\n\n6751\n122\nS\nV\n0.000000\nS122\n\n\n6414\n122\nS\nW\n0.000000\nS122\n\n\n1155\n122\nS\nY\n0.087626\nS122\n\n\n\n\n620 rows × 5 columns\n\n\n\n\n\n\n\n\n\n\n\n\nsite\nwildtype\nmutation\nmutdiffsel\nsite_label\n\n\n\n\n1774\n183\nQ\nA\n0.000491\nQ183\n\n\n6480\n183\nQ\nC\n0.000000\nQ183\n\n\n1775\n183\nQ\nD\n0.000491\nQ183\n\n\n263\n183\nQ\nE\n0.659820\nQ183\n\n\n1776\n183\nQ\nF\n0.000491\nQ183\n\n\n...\n...\n...\n...\n...\n...\n\n\n213\n221\nK\nS\n0.928970\nK221\n\n\n1615\n221\nK\nT\n0.000731\nK221\n\n\n5595\n221\nK\nV\n0.000000\nK221\n\n\n1616\n221\nK\nW\n0.000731\nK221\n\n\n1617\n221\nK\nY\n0.000731\nK221\n\n\n\n\n560 rows × 5 columns\n\n\n\n\n\n\n\n\n\n\n\n\nsite\nwildtype\nmutation\nmutdiffsel\nsite_label\nantibody\n\n\n\n\n6804\n40\nD\nA\n0.000000\nD40\nCHK-11\n\n\n126\n40\nD\nC\n2.386392\nD40\nCHK-11\n\n\n6330\n40\nD\nE\n0.000000\nD40\nCHK-11\n\n\n5768\n40\nD\nF\n0.000000\nD40\nCHK-11\n\n\n392\n40\nD\nG\n0.457301\nD40\nCHK-11\n\n\n...\n...\n...\n...\n...\n...\n...\n\n\n6071\n241\nL\nS\n0.000000\nL241\nCHK-11\n\n\n6959\n241\nL\nT\n0.000000\nL241\nCHK-11\n\n\n6043\n241\nL\nV\n0.000000\nL241\nCHK-11\n\n\n6734\n241\nL\nW\n0.000000\nL241\nCHK-11\n\n\n1016\n241\nL\nY\n0.123828\nL241\nCHK-11\n\n\n\n\n133 rows × 6 columns\n\n\n\n\n\n\n\n\n\n\nsite\nwildtype\nmutation\nmutdiffsel\nsite_label\nantibody\n\n\n\n\n6850\n40\nD\nA\n0.000000\nD40\nCHK-152\n\n\n4009\n40\nD\nC\n0.000000\nD40\nCHK-152\n\n\n7449\n40\nD\nD\nNaN\nD40\nCHK-152\n\n\n641\n40\nD\nE\n0.344012\nD40\nCHK-152\n\n\n7056\n40\nD\nF\n0.000000\nD40\nCHK-152\n\n\n...\n...\n...\n...\n...\n...\n...\n\n\n7140\n241\nL\nS\n0.000000\nL241\nCHK-152\n\n\n6844\n241\nL\nT\n0.000000\nL241\nCHK-152\n\n\n498\n241\nL\nV\n0.460759\nL241\nCHK-152\n\n\n788\n241\nL\nW\n0.257530\nL241\nCHK-152\n\n\n751\n241\nL\nY\n0.281082\nL241\nCHK-152\n\n\n\n\n140 rows × 6 columns\n\n\n\n\n\n\n\n\n\n\nsite\nwildtype\nmutation\nmutdiffsel\nsite_label\nantibody\n\n\n\n\n6666\n40\nD\nA\n0.000000\nD40\nCHK-265\n\n\n5\n40\nD\nC\n5.670516\nD40\nCHK-265\n\n\n7449\n40\nD\nD\nNaN\nD40\nCHK-265\n\n\n5831\n40\nD\nE\n0.000000\nD40\nCHK-265\n\n\n211\n40\nD\nF\n0.952949\nD40\nCHK-265\n\n\n...\n...\n...\n...\n...\n...\n...\n\n\n7260\n241\nL\nS\n0.000000\nL241\nCHK-265\n\n\n7001\n241\nL\nT\n0.000000\nL241\nCHK-265\n\n\n5571\n241\nL\nV\n0.000000\nL241\nCHK-265\n\n\n6378\n241\nL\nW\n0.000000\nL241\nCHK-265\n\n\n802\n241\nL\nY\n0.212435\nL241\nCHK-265\n\n\n\n\n140 rows × 6 columns\n\n\n\n\n\nAfter merging:\n\n\n\n\n\n\n\n\n\nsite\nwildtype\nmutation\nmutdiffsel\nsite_label\nantibody\n\n\n\n\n6804\n40\nD\nA\n0.000000\nD40\nCHK-11\n\n\n126\n40\nD\nC\n2.386392\nD40\nCHK-11\n\n\n6330\n40\nD\nE\n0.000000\nD40\nCHK-11\n\n\n5768\n40\nD\nF\n0.000000\nD40\nCHK-11\n\n\n392\n40\nD\nG\n0.457301\nD40\nCHK-11\n\n\n...\n...\n...\n...\n...\n...\n...\n\n\n7260\n241\nL\nS\n0.000000\nL241\nCHK-265\n\n\n7001\n241\nL\nT\n0.000000\nL241\nCHK-265\n\n\n5571\n241\nL\nV\n0.000000\nL241\nCHK-265\n\n\n6378\n241\nL\nW\n0.000000\nL241\nCHK-265\n\n\n802\n241\nL\nY\n0.212435\nL241\nCHK-265\n\n\n\n\n413 rows × 6 columns\n\n\n\n\n\n\n\n\n\n\n\n\nsite\nwildtype\nmutation\nmutdiffsel\nsite_label\nantibody\n\n\n\n\n7484\n11\nA\nA\nNaN\nA11\nCHK-152\n\n\n1719\n11\nA\nC\n0.000583\nA11\nCHK-152\n\n\n1720\n11\nA\nD\n0.000583\nA11\nCHK-152\n\n\n1727\n11\nA\nE\n0.000583\nA11\nCHK-152\n\n\n1717\n11\nA\nF\n0.000583\nA11\nCHK-152\n\n\n...\n...\n...\n...\n...\n...\n...\n\n\n3143\n235\nW\nS\n0.000007\nW235\nCHK-152\n\n\n3144\n235\nW\nT\n0.000007\nW235\nCHK-152\n\n\n3145\n235\nW\nV\n0.000007\nW235\nCHK-152\n\n\n7708\n235\nW\nW\nNaN\nW235\nCHK-152\n\n\n3141\n235\nW\nY\n0.000007\nW235\nCHK-152\n\n\n\n\n180 rows × 6 columns\n\n\n\n\n\n\n\n\n\n\nsite\nwildtype\nmutation\nmutdiffsel\nsite_label\nantibody\n\n\n\n\n6171\n24\nE\nA\n0.000000\nE24\nCHK-265 (A domain)\n\n\n6693\n24\nE\nC\n0.000000\nE24\nCHK-265 (A domain)\n\n\n5313\n24\nE\nD\n0.000000\nE24\nCHK-265 (A domain)\n\n\n7497\n24\nE\nE\nNaN\nE24\nCHK-265 (A domain)\n\n\n5670\n24\nE\nF\n0.000000\nE24\nCHK-265 (A domain)\n\n\n...\n...\n...\n...\n...\n...\n...\n\n\n7595\n122\nS\nS\nNaN\nS122\nCHK-265 (A domain)\n\n\n6271\n122\nS\nT\n0.000000\nS122\nCHK-265 (A domain)\n\n\n6751\n122\nS\nV\n0.000000\nS122\nCHK-265 (A domain)\n\n\n6414\n122\nS\nW\n0.000000\nS122\nCHK-265 (A domain)\n\n\n1155\n122\nS\nY\n0.087626\nS122\nCHK-265 (A domain)\n\n\n\n\n620 rows × 6 columns\n\n\n\n\n\n\n\n\n\n\nsite\nwildtype\nmutation\nmutdiffsel\nsite_label\nantibody\n\n\n\n\n1774\n183\nQ\nA\n0.000491\nQ183\nCHK-265 (B domain)\n\n\n6480\n183\nQ\nC\n0.000000\nQ183\nCHK-265 (B domain)\n\n\n1775\n183\nQ\nD\n0.000491\nQ183\nCHK-265 (B domain)\n\n\n263\n183\nQ\nE\n0.659820\nQ183\nCHK-265 (B domain)\n\n\n1776\n183\nQ\nF\n0.000491\nQ183\nCHK-265 (B domain)\n\n\n...\n...\n...\n...\n...\n...\n...\n\n\n213\n221\nK\nS\n0.928970\nK221\nCHK-265 (B domain)\n\n\n1615\n221\nK\nT\n0.000731\nK221\nCHK-265 (B domain)\n\n\n5595\n221\nK\nV\n0.000000\nK221\nCHK-265 (B domain)\n\n\n1616\n221\nK\nW\n0.000731\nK221\nCHK-265 (B domain)\n\n\n1617\n221\nK\nY\n0.000731\nK221\nCHK-265 (B domain)\n\n\n\n\n560 rows × 6 columns\n\n\n\n\n\nAfter merging:\n\n\n\n\n\n\n\n\n\nsite\nwildtype\nmutation\nmutdiffsel\nsite_label\nantibody\n\n\n\n\n7484\n11\nA\nA\nNaN\nA11\nCHK-152\n\n\n1719\n11\nA\nC\n0.000583\nA11\nCHK-152\n\n\n1720\n11\nA\nD\n0.000583\nA11\nCHK-152\n\n\n1727\n11\nA\nE\n0.000583\nA11\nCHK-152\n\n\n1717\n11\nA\nF\n0.000583\nA11\nCHK-152\n\n\n...\n...\n...\n...\n...\n...\n...\n\n\n213\n221\nK\nS\n0.928970\nK221\nCHK-265 (B domain)\n\n\n1615\n221\nK\nT\n0.000731\nK221\nCHK-265 (B domain)\n\n\n5595\n221\nK\nV\n0.000000\nK221\nCHK-265 (B domain)\n\n\n1616\n221\nK\nW\n0.000731\nK221\nCHK-265 (B domain)\n\n\n1617\n221\nK\nY\n0.000731\nK221\nCHK-265 (B domain)\n\n\n\n\n1360 rows × 6 columns\n\n\n\n\n\n5.7.5 Plot logoplots using dmslogo\n\n\n\n\n\n\n\n\n\n\n\nSaving figure to output_files/chk11_all_newaxis.png\nHere is a rendering of the saved figure:\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nSaving figure to output_files/chk152_all_newaxis.png\nHere is a rendering of the saved figure:\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nSaving figure to output_files/chk152_contacts_newaxis.png\nHere is a rendering of the saved figure:\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nSaving figure to output_files/chk265_all_newaxis.png\nHere is a rendering of the saved figure:\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nSaving figure to output_files/zoomed_concat_newaxis.png\nHere is a rendering of the saved figure:\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nSaving figure to output_files/chk265_contacts_adom_newaxis.png\nHere is a rendering of the saved figure:\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nSaving figure to output_files/chk265_contacts_bdom_newaxis.png\nHere is a rendering of the saved figure:\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nExpand to View Code Blocks\n\n\n\nImport Packages\n\n# Logoplot Generation\nimport os\nimport random\n\nfrom IPython.display import display, Image\n\nimport matplotlib.pyplot as plt\n\nimport numpy\n\nimport pandas as pd\n\nimport dmslogo\nfrom dmslogo.colorschemes import CBPALETTE\n\n\n# Set preferences for logoplot displays\npd.set_option(\"display.max_columns\", 20)\npd.set_option(\"display.width\", 500)\n\n\n\nImport Data\n\ndata_chk11 = (pd.read_csv('~/dms_data/summary_CHK-11-meanmutdiffsel.csv'))\n\ndata_chk11 = data_chk11.sort_values(by=['site', 'mutation'])\n\ndata_chk11\n\n\n\n\n\n\n\n\n\nsite\n\n\nwildtype\n\n\nmutation\n\n\nmutdiffsel\n\n\n\n\n\n\n3013\n\n\n1\n\n\nS\n\n\nA\n\n\n0.000022\n\n\n\n\n3004\n\n\n1\n\n\nS\n\n\nC\n\n\n0.000022\n\n\n\n\n2999\n\n\n1\n\n\nS\n\n\nD\n\n\n0.000022\n\n\n\n\n3002\n\n\n1\n\n\nS\n\n\nE\n\n\n0.000022\n\n\n\n\n3005\n\n\n1\n\n\nS\n\n\nF\n\n\n0.000022\n\n\n\n\n…\n\n\n…\n\n\n…\n\n\n…\n\n\n…\n\n\n\n\n3094\n\n\n390\n\n\nL\n\n\nS\n\n\n0.000013\n\n\n\n\n3084\n\n\n390\n\n\nL\n\n\nT\n\n\n0.000013\n\n\n\n\n3091\n\n\n390\n\n\nL\n\n\nV\n\n\n0.000013\n\n\n\n\n3095\n\n\n390\n\n\nL\n\n\nW\n\n\n0.000013\n\n\n\n\n3097\n\n\n390\n\n\nL\n\n\nY\n\n\n0.000013\n\n\n\n\n\n7410 rows × 4 columns\n\n\n\ndata_chk152 = (pd.read_csv('~/dms_data/summary_CHK-152-meanmutdiffsel.csv'))\n\ndata_chk152 = data_chk152.sort_values(by=['site', 'mutation'])\n\ndata_chk152\n\n\n\n\n\n\n\n\n\nsite\n\n\nwildtype\n\n\nmutation\n\n\nmutdiffsel\n\n\n\n\n\n\n3070\n\n\n1\n\n\nS\n\n\nA\n\n\n1.293007e-05\n\n\n\n\n3069\n\n\n1\n\n\nS\n\n\nC\n\n\n1.293007e-05\n\n\n\n\n3080\n\n\n1\n\n\nS\n\n\nD\n\n\n1.293007e-05\n\n\n\n\n3072\n\n\n1\n\n\nS\n\n\nE\n\n\n1.293007e-05\n\n\n\n\n3071\n\n\n1\n\n\nS\n\n\nF\n\n\n1.293007e-05\n\n\n\n\n…\n\n\n…\n\n\n…\n\n\n…\n\n\n…\n\n\n\n\n3361\n\n\n390\n\n\nL\n\n\nS\n\n\n1.601713e-16\n\n\n\n\n3362\n\n\n390\n\n\nL\n\n\nT\n\n\n1.601713e-16\n\n\n\n\n3363\n\n\n390\n\n\nL\n\n\nV\n\n\n1.601713e-16\n\n\n\n\n3364\n\n\n390\n\n\nL\n\n\nW\n\n\n1.601713e-16\n\n\n\n\n3347\n\n\n390\n\n\nL\n\n\nY\n\n\n1.601713e-16\n\n\n\n\n\n7800 rows × 4 columns\n\n\n\ndata_chk265 = (pd.read_csv('~/dms_data/summary_CHK-265-meanmutdiffsel.csv'))\n\ndata_chk265 = data_chk265.sort_values(by=['site', 'mutation'])\n\ndata_chk265\n\n\n\n\n\n\n\n\n\nsite\n\n\nwildtype\n\n\nmutation\n\n\nmutdiffsel\n\n\n\n\n\n\n3125\n\n\n1\n\n\nS\n\n\nA\n\n\n2.401568e-05\n\n\n\n\n3124\n\n\n1\n\n\nS\n\n\nC\n\n\n2.401568e-05\n\n\n\n\n3126\n\n\n1\n\n\nS\n\n\nD\n\n\n2.401568e-05\n\n\n\n\n3128\n\n\n1\n\n\nS\n\n\nE\n\n\n2.401568e-05\n\n\n\n\n3129\n\n\n1\n\n\nS\n\n\nF\n\n\n2.401568e-05\n\n\n\n\n…\n\n\n…\n\n\n…\n\n\n…\n\n\n…\n\n\n\n\n3637\n\n\n390\n\n\nL\n\n\nS\n\n\n-1.601713e-16\n\n\n\n\n3639\n\n\n390\n\n\nL\n\n\nT\n\n\n-1.601713e-16\n\n\n\n\n3640\n\n\n390\n\n\nL\n\n\nV\n\n\n-1.601713e-16\n\n\n\n\n3641\n\n\n390\n\n\nL\n\n\nW\n\n\n-1.601713e-16\n\n\n\n\n3636\n\n\n390\n\n\nL\n\n\nY\n\n\n-1.601713e-16\n\n\n\n\n\n7800 rows × 4 columns\n\n\n\n\nIdentify Sites for Plotting\n\n# Just showing sites we chose to mutate (using p62 numbering)\nsites = list([40]+[49]+[139]+[143]+[243]+[283]+[305])\nsites152 = list([75]+[123]+[138]+[257]+[258]+[276]+[296]+[297]+[299])\nsites265 = list([88]+[90]+[91]+[92]+[93]+[121]+[122]+[123]+[128]+[129]+[136]+[137]+[138]+[141]+[143]+[145]+[146]+[148]+[150]+[152]+[154]+[156]+[157]+[168]+[171]+[173]+[174]+[183]+[184]+[185]+[186]+[247]+[248]+[249]+[250]+[251]+[253]+[254]+[257]+[258]+[261]+[263]+[267]+[268]+[269]+[270]+[272]+[273]+[274]+[276]+[277]+[278]+[279]+[280]+[281]+[282]+[283]+[284]+[285])\n\n# Extract those sites\nzoomed_df_11 = (data_chk11.loc[data_chk11['site'].isin(sites)]\n                )\n# Renumber based on E3/E2 numbering not p62 numbering (E3 numbering maintained, E2 changed)\nzoomed_df_11 = zoomed_df_11.replace(143, 79)\nzoomed_df_11 = zoomed_df_11.replace(305, 241)\nzoomed_df_11 = zoomed_df_11.replace(139, 75)\nzoomed_df_11 = zoomed_df_11.replace(243, 179)\nzoomed_df_11 = zoomed_df_11.replace(283, 219)\n\n# Combine new numbering with wildtype reside for label\nzoomed_df_11 = zoomed_df_11.assign(site_label = lambda x: x['wildtype'] + x['site'].astype(str))\n\nzoomed_df_11\n\n\n\n\n\n\n\n\n\nsite\n\n\nwildtype\n\n\nmutation\n\n\nmutdiffsel\n\n\nsite_label\n\n\n\n\n\n\n6804\n\n\n40\n\n\nD\n\n\nA\n\n\n-0.657902\n\n\nD40\n\n\n\n\n126\n\n\n40\n\n\nD\n\n\nC\n\n\n2.386392\n\n\nD40\n\n\n\n\n6330\n\n\n40\n\n\nD\n\n\nE\n\n\n-0.275685\n\n\nD40\n\n\n\n\n5768\n\n\n40\n\n\nD\n\n\nF\n\n\n-0.053723\n\n\nD40\n\n\n\n\n392\n\n\n40\n\n\nD\n\n\nG\n\n\n0.457301\n\n\nD40\n\n\n\n\n…\n\n\n…\n\n\n…\n\n\n…\n\n\n…\n\n\n…\n\n\n\n\n6071\n\n\n241\n\n\nL\n\n\nS\n\n\n-0.160726\n\n\nL241\n\n\n\n\n6959\n\n\n241\n\n\nL\n\n\nT\n\n\n-1.025003\n\n\nL241\n\n\n\n\n6043\n\n\n241\n\n\nL\n\n\nV\n\n\n-0.152095\n\n\nL241\n\n\n\n\n6734\n\n\n241\n\n\nL\n\n\nW\n\n\n-0.573042\n\n\nL241\n\n\n\n\n1016\n\n\n241\n\n\nL\n\n\nY\n\n\n0.123828\n\n\nL241\n\n\n\n\n\n133 rows × 5 columns\n\n\n\nzoomed_df_152 = (data_chk152.loc[data_chk152['site'].isin(sites)]\n                )\n\nzoomed_df_152 = zoomed_df_152.replace(143, 79)\nzoomed_df_152 = zoomed_df_152.replace(305, 241)\nzoomed_df_152 = zoomed_df_152.replace(139, 75)\nzoomed_df_152 = zoomed_df_152.replace(243, 179)\nzoomed_df_152 = zoomed_df_152.replace(283, 219)\n\nzoomed_df_152 = zoomed_df_152.assign(site_label = lambda x: x['wildtype'] + x['site'].astype(str))\n\nzoomed_df_152\n\n\n\n\n\n\n\n\n\nsite\n\n\nwildtype\n\n\nmutation\n\n\nmutdiffsel\n\n\nsite_label\n\n\n\n\n\n\n6850\n\n\n40\n\n\nD\n\n\nA\n\n\n-1.234171\n\n\nD40\n\n\n\n\n4009\n\n\n40\n\n\nD\n\n\nC\n\n\n-0.000064\n\n\nD40\n\n\n\n\n7449\n\n\n40\n\n\nD\n\n\nD\n\n\nNaN\n\n\nD40\n\n\n\n\n641\n\n\n40\n\n\nD\n\n\nE\n\n\n0.344012\n\n\nD40\n\n\n\n\n7056\n\n\n40\n\n\nD\n\n\nF\n\n\n-2.412958\n\n\nD40\n\n\n\n\n…\n\n\n…\n\n\n…\n\n\n…\n\n\n…\n\n\n…\n\n\n\n\n7140\n\n\n241\n\n\nL\n\n\nS\n\n\n-2.794302\n\n\nL241\n\n\n\n\n6844\n\n\n241\n\n\nL\n\n\nT\n\n\n-1.191166\n\n\nL241\n\n\n\n\n498\n\n\n241\n\n\nL\n\n\nV\n\n\n0.460759\n\n\nL241\n\n\n\n\n788\n\n\n241\n\n\nL\n\n\nW\n\n\n0.257530\n\n\nL241\n\n\n\n\n751\n\n\n241\n\n\nL\n\n\nY\n\n\n0.281082\n\n\nL241\n\n\n\n\n\n140 rows × 5 columns\n\n\n\ncontacts_df_152 = (data_chk152.loc[data_chk152['site'].isin(sites152)]\n                )\n\ncontacts_df_152 = contacts_df_152.replace(75, 11)\ncontacts_df_152 = contacts_df_152.replace(123, 59)\ncontacts_df_152 = contacts_df_152.replace(138, 74)\ncontacts_df_152 = contacts_df_152.replace(257, 193)\ncontacts_df_152 = contacts_df_152.replace(258, 194)\ncontacts_df_152 = contacts_df_152.replace(276, 212)\ncontacts_df_152 = contacts_df_152.replace(296, 232)\ncontacts_df_152 = contacts_df_152.replace(299, 235)\ncontacts_df_152 = contacts_df_152.replace(297, 233)\n\ncontacts_df_152 = contacts_df_152.assign(site_label = lambda x: x['wildtype'] + x['site'].astype(str))\n\ncontacts_df_152\n\n\n\n\n\n\n\n\n\nsite\n\n\nwildtype\n\n\nmutation\n\n\nmutdiffsel\n\n\nsite_label\n\n\n\n\n\n\n7484\n\n\n11\n\n\nA\n\n\nA\n\n\nNaN\n\n\nA11\n\n\n\n\n1719\n\n\n11\n\n\nA\n\n\nC\n\n\n0.000583\n\n\nA11\n\n\n\n\n1720\n\n\n11\n\n\nA\n\n\nD\n\n\n0.000583\n\n\nA11\n\n\n\n\n1727\n\n\n11\n\n\nA\n\n\nE\n\n\n0.000583\n\n\nA11\n\n\n\n\n1717\n\n\n11\n\n\nA\n\n\nF\n\n\n0.000583\n\n\nA11\n\n\n\n\n…\n\n\n…\n\n\n…\n\n\n…\n\n\n…\n\n\n…\n\n\n\n\n3143\n\n\n235\n\n\nW\n\n\nS\n\n\n0.000007\n\n\nW235\n\n\n\n\n3144\n\n\n235\n\n\nW\n\n\nT\n\n\n0.000007\n\n\nW235\n\n\n\n\n3145\n\n\n235\n\n\nW\n\n\nV\n\n\n0.000007\n\n\nW235\n\n\n\n\n7708\n\n\n235\n\n\nW\n\n\nW\n\n\nNaN\n\n\nW235\n\n\n\n\n3141\n\n\n235\n\n\nW\n\n\nY\n\n\n0.000007\n\n\nW235\n\n\n\n\n\n180 rows × 5 columns\n\n\n\nzoomed_df_265 = (data_chk265.loc[data_chk265['site'].isin(sites)]\n                )\n\nzoomed_df_265 = zoomed_df_265.replace(143, 79)\nzoomed_df_265 = zoomed_df_265.replace(305, 241)\nzoomed_df_265 = zoomed_df_265.replace(139, 75)\nzoomed_df_265 = zoomed_df_265.replace(243, 179)\nzoomed_df_265 = zoomed_df_265.replace(283, 219)\n\nzoomed_df_265 = zoomed_df_265.assign(site_label = lambda x: x['wildtype'] + x['site'].astype(str))\n\nzoomed_df_265\n\n\n\n\n\n\n\n\n\nsite\n\n\nwildtype\n\n\nmutation\n\n\nmutdiffsel\n\n\nsite_label\n\n\n\n\n\n\n6666\n\n\n40\n\n\nD\n\n\nA\n\n\n-0.402091\n\n\nD40\n\n\n\n\n5\n\n\n40\n\n\nD\n\n\nC\n\n\n5.670516\n\n\nD40\n\n\n\n\n7449\n\n\n40\n\n\nD\n\n\nD\n\n\nNaN\n\n\nD40\n\n\n\n\n5831\n\n\n40\n\n\nD\n\n\nE\n\n\n-0.035732\n\n\nD40\n\n\n\n\n211\n\n\n40\n\n\nD\n\n\nF\n\n\n0.952949\n\n\nD40\n\n\n\n\n…\n\n\n…\n\n\n…\n\n\n…\n\n\n…\n\n\n…\n\n\n\n\n7260\n\n\n241\n\n\nL\n\n\nS\n\n\n-2.836240\n\n\nL241\n\n\n\n\n7001\n\n\n241\n\n\nL\n\n\nT\n\n\n-1.007714\n\n\nL241\n\n\n\n\n5571\n\n\n241\n\n\nL\n\n\nV\n\n\n-0.001727\n\n\nL241\n\n\n\n\n6378\n\n\n241\n\n\nL\n\n\nW\n\n\n-0.226428\n\n\nL241\n\n\n\n\n802\n\n\n241\n\n\nL\n\n\nY\n\n\n0.212435\n\n\nL241\n\n\n\n\n\n140 rows × 5 columns\n\n\n\ncontacts_df_265 = (data_chk265.loc[data_chk265['site'].isin(sites265)]\n                )\n\n# Correct site numbers for p62 numbering (-64)\ncontacts_df_265 = contacts_df_265.replace(88,24)\ncontacts_df_265 = contacts_df_265.replace(90,26)\ncontacts_df_265 = contacts_df_265.replace(91,27)\ncontacts_df_265 = contacts_df_265.replace(92,28)\ncontacts_df_265 = contacts_df_265.replace(93,29)\ncontacts_df_265 = contacts_df_265.replace(121,57)\ncontacts_df_265 = contacts_df_265.replace(122,58)\ncontacts_df_265 = contacts_df_265.replace(123,59)\ncontacts_df_265 = contacts_df_265.replace(128,64)\ncontacts_df_265 = contacts_df_265.replace(129,65)\ncontacts_df_265 = contacts_df_265.replace(136,72)\ncontacts_df_265 = contacts_df_265.replace(137,73)\ncontacts_df_265 = contacts_df_265.replace(138,74)\ncontacts_df_265 = contacts_df_265.replace(141,77)\ncontacts_df_265 = contacts_df_265.replace(143,79)\ncontacts_df_265 = contacts_df_265.replace(145,81)\ncontacts_df_265 = contacts_df_265.replace(146,82)\ncontacts_df_265 = contacts_df_265.replace(148,84)\ncontacts_df_265 = contacts_df_265.replace(150,86)\ncontacts_df_265 = contacts_df_265.replace(152,88)\ncontacts_df_265 = contacts_df_265.replace(154,90)\ncontacts_df_265 = contacts_df_265.replace(156,92)\ncontacts_df_265 = contacts_df_265.replace(157,93)\ncontacts_df_265 = contacts_df_265.replace(168,104)\ncontacts_df_265 = contacts_df_265.replace(171,107)\ncontacts_df_265 = contacts_df_265.replace(173,109)\ncontacts_df_265 = contacts_df_265.replace(174,110)\ncontacts_df_265 = contacts_df_265.replace(183,119)\ncontacts_df_265 = contacts_df_265.replace(184,120)\ncontacts_df_265 = contacts_df_265.replace(185,121)\ncontacts_df_265 = contacts_df_265.replace(186,122)\ncontacts_df_265 = contacts_df_265.replace(247,183)\ncontacts_df_265 = contacts_df_265.replace(248,184)\ncontacts_df_265 = contacts_df_265.replace(249,185)\ncontacts_df_265 = contacts_df_265.replace(250,186)\ncontacts_df_265 = contacts_df_265.replace(251,187)\ncontacts_df_265 = contacts_df_265.replace(253,189)\ncontacts_df_265 = contacts_df_265.replace(254,190)\ncontacts_df_265 = contacts_df_265.replace(257,193)\ncontacts_df_265 = contacts_df_265.replace(258,194)\ncontacts_df_265 = contacts_df_265.replace(261,197)\ncontacts_df_265 = contacts_df_265.replace(263,199)\ncontacts_df_265 = contacts_df_265.replace(267,203)\ncontacts_df_265 = contacts_df_265.replace(268,204)\ncontacts_df_265 = contacts_df_265.replace(269,205)\ncontacts_df_265 = contacts_df_265.replace(270,206)\ncontacts_df_265 = contacts_df_265.replace(272,208)\ncontacts_df_265 = contacts_df_265.replace(273,209)\ncontacts_df_265 = contacts_df_265.replace(274,210)\ncontacts_df_265 = contacts_df_265.replace(276,212)\ncontacts_df_265 = contacts_df_265.replace(277,213)\ncontacts_df_265 = contacts_df_265.replace(278,214)\ncontacts_df_265 = contacts_df_265.replace(279,215)\ncontacts_df_265 = contacts_df_265.replace(280,216)\ncontacts_df_265 = contacts_df_265.replace(281,217)\ncontacts_df_265 = contacts_df_265.replace(282,218)\ncontacts_df_265 = contacts_df_265.replace(283,219)\ncontacts_df_265 = contacts_df_265.replace(284,220)\ncontacts_df_265 = contacts_df_265.replace(285,221)\n\ncontacts_df_265 = contacts_df_265.assign(site_label = lambda x: x['wildtype'] + x['site'].astype(str))\n\ncontacts_df_265\n\n\n\n\n\n\n\n\n\nsite\n\n\nwildtype\n\n\nmutation\n\n\nmutdiffsel\n\n\nsite_label\n\n\n\n\n\n\n6171\n\n\n24\n\n\nE\n\n\nA\n\n\n-0.138181\n\n\nE24\n\n\n\n\n6693\n\n\n24\n\n\nE\n\n\nC\n\n\n-0.422121\n\n\nE24\n\n\n\n\n5313\n\n\n24\n\n\nE\n\n\nD\n\n\n-0.000595\n\n\nE24\n\n\n\n\n7497\n\n\n24\n\n\nE\n\n\nE\n\n\nNaN\n\n\nE24\n\n\n\n\n5670\n\n\n24\n\n\nE\n\n\nF\n\n\n-0.006693\n\n\nE24\n\n\n\n\n…\n\n\n…\n\n\n…\n\n\n…\n\n\n…\n\n\n…\n\n\n\n\n213\n\n\n221\n\n\nK\n\n\nS\n\n\n0.928970\n\n\nK221\n\n\n\n\n1615\n\n\n221\n\n\nK\n\n\nT\n\n\n0.000731\n\n\nK221\n\n\n\n\n5595\n\n\n221\n\n\nK\n\n\nV\n\n\n-0.002103\n\n\nK221\n\n\n\n\n1616\n\n\n221\n\n\nK\n\n\nW\n\n\n0.000731\n\n\nK221\n\n\n\n\n1617\n\n\n221\n\n\nK\n\n\nY\n\n\n0.000731\n\n\nK221\n\n\n\n\n\n1180 rows × 5 columns\n\n\n\n# Exclude all non positive mutdiffsel scores\nzoomed_df_11['mutdiffsel'] = zoomed_df_11['mutdiffsel'].mask(zoomed_df_11['mutdiffsel'].lt(0),0)\n\nzoomed_df_152['mutdiffsel'] = zoomed_df_152['mutdiffsel'].mask(zoomed_df_152['mutdiffsel'].lt(0),0)\n\ncontacts_df_152['mutdiffsel'] = contacts_df_152['mutdiffsel'].mask(contacts_df_152['mutdiffsel'].lt(0),0)\n\nzoomed_df_265['mutdiffsel'] = zoomed_df_265['mutdiffsel'].mask(zoomed_df_265['mutdiffsel'].lt(0),0)\n\ncontacts_df_265['mutdiffsel'] = contacts_df_265['mutdiffsel'].mask(contacts_df_265['mutdiffsel'].lt(0),0)\n\n\ncontacts_df_265_adom = contacts_df_265[contacts_df_265['site'] &lt;= 134]\ncontacts_df_265_bdom = contacts_df_265[contacts_df_265['site'] &gt;= 135]\n\ncontacts_df_265_adom\n\n\n\n\n\n\n\n\n\nsite\n\n\nwildtype\n\n\nmutation\n\n\nmutdiffsel\n\n\nsite_label\n\n\n\n\n\n\n6171\n\n\n24\n\n\nE\n\n\nA\n\n\n0.000000\n\n\nE24\n\n\n\n\n6693\n\n\n24\n\n\nE\n\n\nC\n\n\n0.000000\n\n\nE24\n\n\n\n\n5313\n\n\n24\n\n\nE\n\n\nD\n\n\n0.000000\n\n\nE24\n\n\n\n\n7497\n\n\n24\n\n\nE\n\n\nE\n\n\nNaN\n\n\nE24\n\n\n\n\n5670\n\n\n24\n\n\nE\n\n\nF\n\n\n0.000000\n\n\nE24\n\n\n\n\n…\n\n\n…\n\n\n…\n\n\n…\n\n\n…\n\n\n…\n\n\n\n\n7595\n\n\n122\n\n\nS\n\n\nS\n\n\nNaN\n\n\nS122\n\n\n\n\n6271\n\n\n122\n\n\nS\n\n\nT\n\n\n0.000000\n\n\nS122\n\n\n\n\n6751\n\n\n122\n\n\nS\n\n\nV\n\n\n0.000000\n\n\nS122\n\n\n\n\n6414\n\n\n122\n\n\nS\n\n\nW\n\n\n0.000000\n\n\nS122\n\n\n\n\n1155\n\n\n122\n\n\nS\n\n\nY\n\n\n0.087626\n\n\nS122\n\n\n\n\n\n620 rows × 5 columns\n\n\n\ncontacts_df_265_bdom\n\n\n\n\n\n\n\n\n\nsite\n\n\nwildtype\n\n\nmutation\n\n\nmutdiffsel\n\n\nsite_label\n\n\n\n\n\n\n1774\n\n\n183\n\n\nQ\n\n\nA\n\n\n0.000491\n\n\nQ183\n\n\n\n\n6480\n\n\n183\n\n\nQ\n\n\nC\n\n\n0.000000\n\n\nQ183\n\n\n\n\n1775\n\n\n183\n\n\nQ\n\n\nD\n\n\n0.000491\n\n\nQ183\n\n\n\n\n263\n\n\n183\n\n\nQ\n\n\nE\n\n\n0.659820\n\n\nQ183\n\n\n\n\n1776\n\n\n183\n\n\nQ\n\n\nF\n\n\n0.000491\n\n\nQ183\n\n\n\n\n…\n\n\n…\n\n\n…\n\n\n…\n\n\n…\n\n\n…\n\n\n\n\n213\n\n\n221\n\n\nK\n\n\nS\n\n\n0.928970\n\n\nK221\n\n\n\n\n1615\n\n\n221\n\n\nK\n\n\nT\n\n\n0.000731\n\n\nK221\n\n\n\n\n5595\n\n\n221\n\n\nK\n\n\nV\n\n\n0.000000\n\n\nK221\n\n\n\n\n1616\n\n\n221\n\n\nK\n\n\nW\n\n\n0.000731\n\n\nK221\n\n\n\n\n1617\n\n\n221\n\n\nK\n\n\nY\n\n\n0.000731\n\n\nK221\n\n\n\n\n\n560 rows × 5 columns\n\n\n\n# Append antibody/domain info to each dataframe then combine\n## ZOOMED\nzoomed_df_11['antibody'] = 'CHK-11'\nzoomed_df_152['antibody'] = 'CHK-152'\nzoomed_df_265['antibody'] = 'CHK-265'\n\ndisplay(zoomed_df_11)\ndisplay(zoomed_df_152)\ndisplay(zoomed_df_265)\n\n\n\n\n\n\n\n\n\nsite\n\n\nwildtype\n\n\nmutation\n\n\nmutdiffsel\n\n\nsite_label\n\n\nantibody\n\n\n\n\n\n\n6804\n\n\n40\n\n\nD\n\n\nA\n\n\n0.000000\n\n\nD40\n\n\nCHK-11\n\n\n\n\n126\n\n\n40\n\n\nD\n\n\nC\n\n\n2.386392\n\n\nD40\n\n\nCHK-11\n\n\n\n\n6330\n\n\n40\n\n\nD\n\n\nE\n\n\n0.000000\n\n\nD40\n\n\nCHK-11\n\n\n\n\n5768\n\n\n40\n\n\nD\n\n\nF\n\n\n0.000000\n\n\nD40\n\n\nCHK-11\n\n\n\n\n392\n\n\n40\n\n\nD\n\n\nG\n\n\n0.457301\n\n\nD40\n\n\nCHK-11\n\n\n\n\n…\n\n\n…\n\n\n…\n\n\n…\n\n\n…\n\n\n…\n\n\n…\n\n\n\n\n6071\n\n\n241\n\n\nL\n\n\nS\n\n\n0.000000\n\n\nL241\n\n\nCHK-11\n\n\n\n\n6959\n\n\n241\n\n\nL\n\n\nT\n\n\n0.000000\n\n\nL241\n\n\nCHK-11\n\n\n\n\n6043\n\n\n241\n\n\nL\n\n\nV\n\n\n0.000000\n\n\nL241\n\n\nCHK-11\n\n\n\n\n6734\n\n\n241\n\n\nL\n\n\nW\n\n\n0.000000\n\n\nL241\n\n\nCHK-11\n\n\n\n\n1016\n\n\n241\n\n\nL\n\n\nY\n\n\n0.123828\n\n\nL241\n\n\nCHK-11\n\n\n\n\n\n133 rows × 6 columns\n\n\n\n\n\n\n\n\n\n\nsite\n\n\nwildtype\n\n\nmutation\n\n\nmutdiffsel\n\n\nsite_label\n\n\nantibody\n\n\n\n\n\n\n6850\n\n\n40\n\n\nD\n\n\nA\n\n\n0.000000\n\n\nD40\n\n\nCHK-152\n\n\n\n\n4009\n\n\n40\n\n\nD\n\n\nC\n\n\n0.000000\n\n\nD40\n\n\nCHK-152\n\n\n\n\n7449\n\n\n40\n\n\nD\n\n\nD\n\n\nNaN\n\n\nD40\n\n\nCHK-152\n\n\n\n\n641\n\n\n40\n\n\nD\n\n\nE\n\n\n0.344012\n\n\nD40\n\n\nCHK-152\n\n\n\n\n7056\n\n\n40\n\n\nD\n\n\nF\n\n\n0.000000\n\n\nD40\n\n\nCHK-152\n\n\n\n\n…\n\n\n…\n\n\n…\n\n\n…\n\n\n…\n\n\n…\n\n\n…\n\n\n\n\n7140\n\n\n241\n\n\nL\n\n\nS\n\n\n0.000000\n\n\nL241\n\n\nCHK-152\n\n\n\n\n6844\n\n\n241\n\n\nL\n\n\nT\n\n\n0.000000\n\n\nL241\n\n\nCHK-152\n\n\n\n\n498\n\n\n241\n\n\nL\n\n\nV\n\n\n0.460759\n\n\nL241\n\n\nCHK-152\n\n\n\n\n788\n\n\n241\n\n\nL\n\n\nW\n\n\n0.257530\n\n\nL241\n\n\nCHK-152\n\n\n\n\n751\n\n\n241\n\n\nL\n\n\nY\n\n\n0.281082\n\n\nL241\n\n\nCHK-152\n\n\n\n\n\n140 rows × 6 columns\n\n\n\n\n\n\n\n\n\n\nsite\n\n\nwildtype\n\n\nmutation\n\n\nmutdiffsel\n\n\nsite_label\n\n\nantibody\n\n\n\n\n\n\n6666\n\n\n40\n\n\nD\n\n\nA\n\n\n0.000000\n\n\nD40\n\n\nCHK-265\n\n\n\n\n5\n\n\n40\n\n\nD\n\n\nC\n\n\n5.670516\n\n\nD40\n\n\nCHK-265\n\n\n\n\n7449\n\n\n40\n\n\nD\n\n\nD\n\n\nNaN\n\n\nD40\n\n\nCHK-265\n\n\n\n\n5831\n\n\n40\n\n\nD\n\n\nE\n\n\n0.000000\n\n\nD40\n\n\nCHK-265\n\n\n\n\n211\n\n\n40\n\n\nD\n\n\nF\n\n\n0.952949\n\n\nD40\n\n\nCHK-265\n\n\n\n\n…\n\n\n…\n\n\n…\n\n\n…\n\n\n…\n\n\n…\n\n\n…\n\n\n\n\n7260\n\n\n241\n\n\nL\n\n\nS\n\n\n0.000000\n\n\nL241\n\n\nCHK-265\n\n\n\n\n7001\n\n\n241\n\n\nL\n\n\nT\n\n\n0.000000\n\n\nL241\n\n\nCHK-265\n\n\n\n\n5571\n\n\n241\n\n\nL\n\n\nV\n\n\n0.000000\n\n\nL241\n\n\nCHK-265\n\n\n\n\n6378\n\n\n241\n\n\nL\n\n\nW\n\n\n0.000000\n\n\nL241\n\n\nCHK-265\n\n\n\n\n802\n\n\n241\n\n\nL\n\n\nY\n\n\n0.212435\n\n\nL241\n\n\nCHK-265\n\n\n\n\n\n140 rows × 6 columns\n\n\n\nzoomed_df_concat = pd.concat([zoomed_df_11, zoomed_df_152, zoomed_df_265], axis = 0)\nprint(\"After merging:\")\ndisplay(zoomed_df_concat)\n\nAfter merging:\n\n\n\n\n\n\n\n\nsite\n\n\nwildtype\n\n\nmutation\n\n\nmutdiffsel\n\n\nsite_label\n\n\nantibody\n\n\n\n\n\n\n6804\n\n\n40\n\n\nD\n\n\nA\n\n\n0.000000\n\n\nD40\n\n\nCHK-11\n\n\n\n\n126\n\n\n40\n\n\nD\n\n\nC\n\n\n2.386392\n\n\nD40\n\n\nCHK-11\n\n\n\n\n6330\n\n\n40\n\n\nD\n\n\nE\n\n\n0.000000\n\n\nD40\n\n\nCHK-11\n\n\n\n\n5768\n\n\n40\n\n\nD\n\n\nF\n\n\n0.000000\n\n\nD40\n\n\nCHK-11\n\n\n\n\n392\n\n\n40\n\n\nD\n\n\nG\n\n\n0.457301\n\n\nD40\n\n\nCHK-11\n\n\n\n\n…\n\n\n…\n\n\n…\n\n\n…\n\n\n…\n\n\n…\n\n\n…\n\n\n\n\n7260\n\n\n241\n\n\nL\n\n\nS\n\n\n0.000000\n\n\nL241\n\n\nCHK-265\n\n\n\n\n7001\n\n\n241\n\n\nL\n\n\nT\n\n\n0.000000\n\n\nL241\n\n\nCHK-265\n\n\n\n\n5571\n\n\n241\n\n\nL\n\n\nV\n\n\n0.000000\n\n\nL241\n\n\nCHK-265\n\n\n\n\n6378\n\n\n241\n\n\nL\n\n\nW\n\n\n0.000000\n\n\nL241\n\n\nCHK-265\n\n\n\n\n802\n\n\n241\n\n\nL\n\n\nY\n\n\n0.212435\n\n\nL241\n\n\nCHK-265\n\n\n\n\n\n413 rows × 6 columns\n\n\n\n# Append antibody/domain info to each dataframe then combine\n# CONTACTS\ncontacts_df_152['antibody'] = 'CHK-152'\ncontacts_df_265_adom['antibody'] = 'CHK-265 (A domain)'\ncontacts_df_265_bdom['antibody'] = 'CHK-265 (B domain)'\n\ndisplay(contacts_df_152)\ndisplay(contacts_df_265_adom)\ndisplay(contacts_df_265_bdom)\n\n\n\n\n\n\n\n\n\nsite\n\n\nwildtype\n\n\nmutation\n\n\nmutdiffsel\n\n\nsite_label\n\n\nantibody\n\n\n\n\n\n\n7484\n\n\n11\n\n\nA\n\n\nA\n\n\nNaN\n\n\nA11\n\n\nCHK-152\n\n\n\n\n1719\n\n\n11\n\n\nA\n\n\nC\n\n\n0.000583\n\n\nA11\n\n\nCHK-152\n\n\n\n\n1720\n\n\n11\n\n\nA\n\n\nD\n\n\n0.000583\n\n\nA11\n\n\nCHK-152\n\n\n\n\n1727\n\n\n11\n\n\nA\n\n\nE\n\n\n0.000583\n\n\nA11\n\n\nCHK-152\n\n\n\n\n1717\n\n\n11\n\n\nA\n\n\nF\n\n\n0.000583\n\n\nA11\n\n\nCHK-152\n\n\n\n\n…\n\n\n…\n\n\n…\n\n\n…\n\n\n…\n\n\n…\n\n\n…\n\n\n\n\n3143\n\n\n235\n\n\nW\n\n\nS\n\n\n0.000007\n\n\nW235\n\n\nCHK-152\n\n\n\n\n3144\n\n\n235\n\n\nW\n\n\nT\n\n\n0.000007\n\n\nW235\n\n\nCHK-152\n\n\n\n\n3145\n\n\n235\n\n\nW\n\n\nV\n\n\n0.000007\n\n\nW235\n\n\nCHK-152\n\n\n\n\n7708\n\n\n235\n\n\nW\n\n\nW\n\n\nNaN\n\n\nW235\n\n\nCHK-152\n\n\n\n\n3141\n\n\n235\n\n\nW\n\n\nY\n\n\n0.000007\n\n\nW235\n\n\nCHK-152\n\n\n\n\n\n180 rows × 6 columns\n\n\n\n\n\n\n\n\n\n\nsite\n\n\nwildtype\n\n\nmutation\n\n\nmutdiffsel\n\n\nsite_label\n\n\nantibody\n\n\n\n\n\n\n6171\n\n\n24\n\n\nE\n\n\nA\n\n\n0.000000\n\n\nE24\n\n\nCHK-265 (A domain)\n\n\n\n\n6693\n\n\n24\n\n\nE\n\n\nC\n\n\n0.000000\n\n\nE24\n\n\nCHK-265 (A domain)\n\n\n\n\n5313\n\n\n24\n\n\nE\n\n\nD\n\n\n0.000000\n\n\nE24\n\n\nCHK-265 (A domain)\n\n\n\n\n7497\n\n\n24\n\n\nE\n\n\nE\n\n\nNaN\n\n\nE24\n\n\nCHK-265 (A domain)\n\n\n\n\n5670\n\n\n24\n\n\nE\n\n\nF\n\n\n0.000000\n\n\nE24\n\n\nCHK-265 (A domain)\n\n\n\n\n…\n\n\n…\n\n\n…\n\n\n…\n\n\n…\n\n\n…\n\n\n…\n\n\n\n\n7595\n\n\n122\n\n\nS\n\n\nS\n\n\nNaN\n\n\nS122\n\n\nCHK-265 (A domain)\n\n\n\n\n6271\n\n\n122\n\n\nS\n\n\nT\n\n\n0.000000\n\n\nS122\n\n\nCHK-265 (A domain)\n\n\n\n\n6751\n\n\n122\n\n\nS\n\n\nV\n\n\n0.000000\n\n\nS122\n\n\nCHK-265 (A domain)\n\n\n\n\n6414\n\n\n122\n\n\nS\n\n\nW\n\n\n0.000000\n\n\nS122\n\n\nCHK-265 (A domain)\n\n\n\n\n1155\n\n\n122\n\n\nS\n\n\nY\n\n\n0.087626\n\n\nS122\n\n\nCHK-265 (A domain)\n\n\n\n\n\n620 rows × 6 columns\n\n\n\n\n\n\n\n\n\n\nsite\n\n\nwildtype\n\n\nmutation\n\n\nmutdiffsel\n\n\nsite_label\n\n\nantibody\n\n\n\n\n\n\n1774\n\n\n183\n\n\nQ\n\n\nA\n\n\n0.000491\n\n\nQ183\n\n\nCHK-265 (B domain)\n\n\n\n\n6480\n\n\n183\n\n\nQ\n\n\nC\n\n\n0.000000\n\n\nQ183\n\n\nCHK-265 (B domain)\n\n\n\n\n1775\n\n\n183\n\n\nQ\n\n\nD\n\n\n0.000491\n\n\nQ183\n\n\nCHK-265 (B domain)\n\n\n\n\n263\n\n\n183\n\n\nQ\n\n\nE\n\n\n0.659820\n\n\nQ183\n\n\nCHK-265 (B domain)\n\n\n\n\n1776\n\n\n183\n\n\nQ\n\n\nF\n\n\n0.000491\n\n\nQ183\n\n\nCHK-265 (B domain)\n\n\n\n\n…\n\n\n…\n\n\n…\n\n\n…\n\n\n…\n\n\n…\n\n\n…\n\n\n\n\n213\n\n\n221\n\n\nK\n\n\nS\n\n\n0.928970\n\n\nK221\n\n\nCHK-265 (B domain)\n\n\n\n\n1615\n\n\n221\n\n\nK\n\n\nT\n\n\n0.000731\n\n\nK221\n\n\nCHK-265 (B domain)\n\n\n\n\n5595\n\n\n221\n\n\nK\n\n\nV\n\n\n0.000000\n\n\nK221\n\n\nCHK-265 (B domain)\n\n\n\n\n1616\n\n\n221\n\n\nK\n\n\nW\n\n\n0.000731\n\n\nK221\n\n\nCHK-265 (B domain)\n\n\n\n\n1617\n\n\n221\n\n\nK\n\n\nY\n\n\n0.000731\n\n\nK221\n\n\nCHK-265 (B domain)\n\n\n\n\n\n560 rows × 6 columns\n\n\n\ncontacts_df_concat = pd.concat([contacts_df_152, contacts_df_265_adom, contacts_df_265_bdom], axis = 0)\nprint(\"After merging:\")\ndisplay(contacts_df_concat)\n\nAfter merging:\n\n\n\n\n\n\n\n\nsite\n\n\nwildtype\n\n\nmutation\n\n\nmutdiffsel\n\n\nsite_label\n\n\nantibody\n\n\n\n\n\n\n7484\n\n\n11\n\n\nA\n\n\nA\n\n\nNaN\n\n\nA11\n\n\nCHK-152\n\n\n\n\n1719\n\n\n11\n\n\nA\n\n\nC\n\n\n0.000583\n\n\nA11\n\n\nCHK-152\n\n\n\n\n1720\n\n\n11\n\n\nA\n\n\nD\n\n\n0.000583\n\n\nA11\n\n\nCHK-152\n\n\n\n\n1727\n\n\n11\n\n\nA\n\n\nE\n\n\n0.000583\n\n\nA11\n\n\nCHK-152\n\n\n\n\n1717\n\n\n11\n\n\nA\n\n\nF\n\n\n0.000583\n\n\nA11\n\n\nCHK-152\n\n\n\n\n…\n\n\n…\n\n\n…\n\n\n…\n\n\n…\n\n\n…\n\n\n…\n\n\n\n\n213\n\n\n221\n\n\nK\n\n\nS\n\n\n0.928970\n\n\nK221\n\n\nCHK-265 (B domain)\n\n\n\n\n1615\n\n\n221\n\n\nK\n\n\nT\n\n\n0.000731\n\n\nK221\n\n\nCHK-265 (B domain)\n\n\n\n\n5595\n\n\n221\n\n\nK\n\n\nV\n\n\n0.000000\n\n\nK221\n\n\nCHK-265 (B domain)\n\n\n\n\n1616\n\n\n221\n\n\nK\n\n\nW\n\n\n0.000731\n\n\nK221\n\n\nCHK-265 (B domain)\n\n\n\n\n1617\n\n\n221\n\n\nK\n\n\nY\n\n\n0.000731\n\n\nK221\n\n\nCHK-265 (B domain)\n\n\n\n\n\n1360 rows × 6 columns\n\n\n\n\nPlot logoplots using dmslogo\n\n# Draw logoplot for each antibody\nylim_setter = dmslogo.utils.AxLimSetter(min_upperlim=16)\n\nfig, axes = dmslogo.draw_logo(\n        data=zoomed_df_11,\n        x_col='site',\n        letter_col='mutation',\n        letter_height_col='mutdiffsel',\n        addbreaks=True,\n        xtick_col='site_label',\n        ylabel = 'differential selection\\nscore (log$_{2}$)',\n        xlabel = 'mutation site',\n        title = \"CHK-11\",\n        ylim_setter = ylim_setter\n    )\n\n\n# Export image to png file\noutputdir = \"output_files\"\nos.makedirs(outputdir, exist_ok=True)\npngfile = os.path.join(outputdir, \"chk11_all_newaxis.png\")\n\nprint(f\"Saving figure to {pngfile}\")\nfig.savefig(pngfile, dpi=450, bbox_inches=\"tight\")\n\nprint(f\"Here is a rendering of the saved figure:\")\ndisplay(Image(pngfile, width=200))\n\nSaving figure to output_files/chk11_all_newaxis.png\nHere is a rendering of the saved figure:\n\n\nfig, axes = dmslogo.draw_logo(\n        data=zoomed_df_152,\n        x_col='site',\n        letter_col='mutation',\n        letter_height_col='mutdiffsel',\n        addbreaks=True,\n        xtick_col='site_label',\n        ylabel = 'differential selection\\nscore (log$_{2}$)',\n        xlabel = 'mutation site',\n        title = \"CHK-152\",\n        ylim_setter = ylim_setter\n    )\n\n\noutputdir = \"output_files\"\nos.makedirs(outputdir, exist_ok=True)\npngfile = os.path.join(outputdir, \"chk152_all_newaxis.png\")\n\nprint(f\"Saving figure to {pngfile}\")\nfig.savefig(pngfile, dpi=450, bbox_inches=\"tight\")\n\nprint(f\"Here is a rendering of the saved figure:\")\ndisplay(Image(pngfile, width=200))\n\nSaving figure to output_files/chk152_all_newaxis.png\nHere is a rendering of the saved figure:\n\n\nfig, axes = dmslogo.draw_logo(\n        data=contacts_df_152,\n        x_col='site',\n        letter_col='mutation',\n        letter_height_col='mutdiffsel',\n        addbreaks=True,\n        xtick_col='site_label',\n        ylabel = 'differential selection\\nscore (log$_{2}$)',\n        xlabel = 'published site',\n        title = \"CHK-152\",\n        ylim_setter = ylim_setter\n    )\n\n\n# Export image to png file\noutputdir = \"output_files\"\nos.makedirs(outputdir, exist_ok=True)\npngfile = os.path.join(outputdir, \"chk152_contacts_newaxis.png\")\n\nprint(f\"Saving figure to {pngfile}\")\nfig.savefig(pngfile, dpi=450, bbox_inches=\"tight\")\n\nprint(f\"Here is a rendering of the saved figure:\")\ndisplay(Image(pngfile, width=200))\n\nSaving figure to output_files/chk152_contacts_newaxis.png\nHere is a rendering of the saved figure:\n\n\nfig, axes = dmslogo.draw_logo(\n        data=zoomed_df_265,\n        x_col='site',\n        letter_col='mutation',\n        letter_height_col='mutdiffsel',\n        addbreaks=True,\n        xtick_col='site_label',\n        ylabel = 'differential selection\\nscore (log$_{2}$)',\n        xlabel = 'mutation site',\n        title = \"CHK-265\",\n        ylim_setter = ylim_setter\n    )\n\n\noutputdir = \"output_files\"\nos.makedirs(outputdir, exist_ok=True)\npngfile = os.path.join(outputdir, \"chk265_all_newaxis.png\")\n\nprint(f\"Saving figure to {pngfile}\")\nfig.savefig(pngfile, dpi=450, bbox_inches=\"tight\")\n\nprint(f\"Here is a rendering of the saved figure:\")\ndisplay(Image(pngfile, width=200))\n\nSaving figure to output_files/chk265_all_newaxis.png\nHere is a rendering of the saved figure:\n\n\n# Combine into one plot\nfig, axes = dmslogo.facet_plot(\n    data = zoomed_df_concat,\n    gridrow_col = \"antibody\",\n    x_col = \"site\",\n    show_col = None,\n    draw_logo_kwargs={\n        \"letter_col\": \"mutation\",\n        \"letter_height_col\": \"mutdiffsel\",\n        \"xtick_col\": \"site_label\",\n        \"xlabel\": \"mutation site\",\n        \"ylabel\": \"differential selection\\nscore (log$_{2}$)\",\n        \"clip_negative_heights\": True,\n    },\n    share_ylabel = True,\n    share_xlabel = True,\n    share_ylim_across_rows = True,\n)\n\n\noutputdir = \"output_files\"\nos.makedirs(outputdir, exist_ok=True)\npngfile = os.path.join(outputdir, \"zoomed_concat_newaxis.png\")\n\nprint(f\"Saving figure to {pngfile}\")\nfig.savefig(pngfile, dpi=450, bbox_inches=\"tight\")\n\nprint(f\"Here is a rendering of the saved figure:\")\ndisplay(Image(pngfile, width=200))\n\nSaving figure to output_files/zoomed_concat_newaxis.png\nHere is a rendering of the saved figure:\n\n\nfig, axes = dmslogo.draw_logo(\n        data=contacts_df_265_adom,\n        x_col='site',\n        letter_col='mutation',\n        letter_height_col='mutdiffsel',\n        addbreaks=True,\n        xtick_col='site_label',\n        ylabel = 'differential selection\\nscore (log$_{2}$)',\n        xlabel = 'published site',\n        title = \"CHK-265 (A domain)\",\n        ylim_setter = ylim_setter\n    )\n\n\noutputdir = \"output_files\"\nos.makedirs(outputdir, exist_ok=True)\npngfile = os.path.join(outputdir, \"chk265_contacts_adom_newaxis.png\")\n\nprint(f\"Saving figure to {pngfile}\")\nfig.savefig(pngfile, dpi=450, bbox_inches=\"tight\")\n\nprint(f\"Here is a rendering of the saved figure:\")\ndisplay(Image(pngfile, width=200))\n\nSaving figure to output_files/chk265_contacts_adom_newaxis.png\nHere is a rendering of the saved figure:\n\n\nfig, axes = dmslogo.draw_logo(\n        data=contacts_df_265_bdom,\n        x_col='site',\n        letter_col='mutation',\n        letter_height_col='mutdiffsel',\n        addbreaks=True,\n        xtick_col='site_label',\n        ylabel = 'differential selection\\nscore (log$_{2}$)',\n        xlabel = 'published site',\n        title = \"CHK-265 (B domain)\",\n        ylim_setter = ylim_setter\n    )\n\n\noutputdir = \"output_files\"\nos.makedirs(outputdir, exist_ok=True)\npngfile = os.path.join(outputdir, \"chk265_contacts_bdom_newaxis.png\")\n\nprint(f\"Saving figure to {pngfile}\")\nfig.savefig(pngfile, dpi=450, bbox_inches=\"tight\")\n\nprint(f\"Here is a rendering of the saved figure:\")\ndisplay(Image(pngfile, width=200))\n\nSaving figure to output_files/chk265_contacts_bdom_newaxis.png\nHere is a rendering of the saved figure:"
  },
  {
    "objectID": "docs/index.html#citation",
    "href": "docs/index.html#citation",
    "title": "Deep mutationally scanned (DMS) CHIKV E3/E2 virus library maps viral amino acid preferences and predicts viral escape mutants of neutralizing CHIKV antibodies",
    "section": "Citation",
    "text": "Citation\nThe following citation can be used to reference this Wiki document."
  },
  {
    "objectID": "docs/dmslogo.html",
    "href": "docs/dmslogo.html",
    "title": "chikvdms-mAb-paper",
    "section": "",
    "text": "Jupyter analysis notebook for analyzing differential selection data using dmslogo software for logoplot generation.\n\nImport Packages\n\n# Logoplot Generation\nimport os\nimport random\n\nfrom IPython.display import display, Image\n\nimport matplotlib.pyplot as plt\n\nimport numpy\n\nimport pandas as pd\n\nimport dmslogo\nfrom dmslogo.colorschemes import CBPALETTE\n\n\n# Set preferences for logoplot displays\npd.set_option(\"display.max_columns\", 20)\npd.set_option(\"display.width\", 500)\n\n\n\nImport Data\n\ndata_chk11 = (pd.read_csv('~/dms_data/summary_CHK-11-meanmutdiffsel.csv'))\n\ndata_chk11 = data_chk11.sort_values(by=['site', 'mutation'])\n\ndata_chk11\n\n\n\n\n\n\n\n\nsite\nwildtype\nmutation\nmutdiffsel\n\n\n\n\n3013\n1\nS\nA\n0.000022\n\n\n3004\n1\nS\nC\n0.000022\n\n\n2999\n1\nS\nD\n0.000022\n\n\n3002\n1\nS\nE\n0.000022\n\n\n3005\n1\nS\nF\n0.000022\n\n\n...\n...\n...\n...\n...\n\n\n3094\n390\nL\nS\n0.000013\n\n\n3084\n390\nL\nT\n0.000013\n\n\n3091\n390\nL\nV\n0.000013\n\n\n3095\n390\nL\nW\n0.000013\n\n\n3097\n390\nL\nY\n0.000013\n\n\n\n\n7410 rows × 4 columns\n\n\n\n\ndata_chk152 = (pd.read_csv('~/dms_data/summary_CHK-152-meanmutdiffsel.csv'))\n\ndata_chk152 = data_chk152.sort_values(by=['site', 'mutation'])\n\ndata_chk152\n\n\n\n\n\n\n\n\nsite\nwildtype\nmutation\nmutdiffsel\n\n\n\n\n3070\n1\nS\nA\n1.293007e-05\n\n\n3069\n1\nS\nC\n1.293007e-05\n\n\n3080\n1\nS\nD\n1.293007e-05\n\n\n3072\n1\nS\nE\n1.293007e-05\n\n\n3071\n1\nS\nF\n1.293007e-05\n\n\n...\n...\n...\n...\n...\n\n\n3361\n390\nL\nS\n1.601713e-16\n\n\n3362\n390\nL\nT\n1.601713e-16\n\n\n3363\n390\nL\nV\n1.601713e-16\n\n\n3364\n390\nL\nW\n1.601713e-16\n\n\n3347\n390\nL\nY\n1.601713e-16\n\n\n\n\n7800 rows × 4 columns\n\n\n\n\ndata_chk265 = (pd.read_csv('~/dms_data/summary_CHK-265-meanmutdiffsel.csv'))\n\ndata_chk265 = data_chk265.sort_values(by=['site', 'mutation'])\n\ndata_chk265\n\n\n\n\n\n\n\n\nsite\nwildtype\nmutation\nmutdiffsel\n\n\n\n\n3125\n1\nS\nA\n2.401568e-05\n\n\n3124\n1\nS\nC\n2.401568e-05\n\n\n3126\n1\nS\nD\n2.401568e-05\n\n\n3128\n1\nS\nE\n2.401568e-05\n\n\n3129\n1\nS\nF\n2.401568e-05\n\n\n...\n...\n...\n...\n...\n\n\n3637\n390\nL\nS\n-1.601713e-16\n\n\n3639\n390\nL\nT\n-1.601713e-16\n\n\n3640\n390\nL\nV\n-1.601713e-16\n\n\n3641\n390\nL\nW\n-1.601713e-16\n\n\n3636\n390\nL\nY\n-1.601713e-16\n\n\n\n\n7800 rows × 4 columns\n\n\n\n\n\nIdentify Sites for Plotting\n\n# Just showing sites we chose to mutate (using p62 numbering)\nsites = list([40]+[49]+[139]+[143]+[243]+[283]+[305])\nsites152 = list([75]+[123]+[138]+[257]+[258]+[276]+[296]+[297]+[299])\nsites265 = list([88]+[90]+[91]+[92]+[93]+[121]+[122]+[123]+[128]+[129]+[136]+[137]+[138]+[141]+[143]+[145]+[146]+[148]+[150]+[152]+[154]+[156]+[157]+[168]+[171]+[173]+[174]+[183]+[184]+[185]+[186]+[247]+[248]+[249]+[250]+[251]+[253]+[254]+[257]+[258]+[261]+[263]+[267]+[268]+[269]+[270]+[272]+[273]+[274]+[276]+[277]+[278]+[279]+[280]+[281]+[282]+[283]+[284]+[285])\n\n# Extract those sites\nzoomed_df_11 = (data_chk11.loc[data_chk11['site'].isin(sites)]\n                )\n# Renumber based on E3/E2 numbering not p62 numbering (E3 numbering maintained, E2 changed)\nzoomed_df_11 = zoomed_df_11.replace(143, 79)\nzoomed_df_11 = zoomed_df_11.replace(305, 241)\nzoomed_df_11 = zoomed_df_11.replace(139, 75)\nzoomed_df_11 = zoomed_df_11.replace(243, 179)\nzoomed_df_11 = zoomed_df_11.replace(283, 219)\n\n# Combine new numbering with wildtype reside for label\nzoomed_df_11 = zoomed_df_11.assign(site_label = lambda x: x['wildtype'] + x['site'].astype(str))\n\nzoomed_df_11\n\n\n\n\n\n\n\n\nsite\nwildtype\nmutation\nmutdiffsel\nsite_label\n\n\n\n\n6804\n40\nD\nA\n-0.657902\nD40\n\n\n126\n40\nD\nC\n2.386392\nD40\n\n\n6330\n40\nD\nE\n-0.275685\nD40\n\n\n5768\n40\nD\nF\n-0.053723\nD40\n\n\n392\n40\nD\nG\n0.457301\nD40\n\n\n...\n...\n...\n...\n...\n...\n\n\n6071\n241\nL\nS\n-0.160726\nL241\n\n\n6959\n241\nL\nT\n-1.025003\nL241\n\n\n6043\n241\nL\nV\n-0.152095\nL241\n\n\n6734\n241\nL\nW\n-0.573042\nL241\n\n\n1016\n241\nL\nY\n0.123828\nL241\n\n\n\n\n133 rows × 5 columns\n\n\n\n\nzoomed_df_152 = (data_chk152.loc[data_chk152['site'].isin(sites)]\n                )\n\nzoomed_df_152 = zoomed_df_152.replace(143, 79)\nzoomed_df_152 = zoomed_df_152.replace(305, 241)\nzoomed_df_152 = zoomed_df_152.replace(139, 75)\nzoomed_df_152 = zoomed_df_152.replace(243, 179)\nzoomed_df_152 = zoomed_df_152.replace(283, 219)\n\nzoomed_df_152 = zoomed_df_152.assign(site_label = lambda x: x['wildtype'] + x['site'].astype(str))\n\nzoomed_df_152\n\n\n\n\n\n\n\n\nsite\nwildtype\nmutation\nmutdiffsel\nsite_label\n\n\n\n\n6850\n40\nD\nA\n-1.234171\nD40\n\n\n4009\n40\nD\nC\n-0.000064\nD40\n\n\n7449\n40\nD\nD\nNaN\nD40\n\n\n641\n40\nD\nE\n0.344012\nD40\n\n\n7056\n40\nD\nF\n-2.412958\nD40\n\n\n...\n...\n...\n...\n...\n...\n\n\n7140\n241\nL\nS\n-2.794302\nL241\n\n\n6844\n241\nL\nT\n-1.191166\nL241\n\n\n498\n241\nL\nV\n0.460759\nL241\n\n\n788\n241\nL\nW\n0.257530\nL241\n\n\n751\n241\nL\nY\n0.281082\nL241\n\n\n\n\n140 rows × 5 columns\n\n\n\n\ncontacts_df_152 = (data_chk152.loc[data_chk152['site'].isin(sites152)]\n                )\n\ncontacts_df_152 = contacts_df_152.replace(75, 11)\ncontacts_df_152 = contacts_df_152.replace(123, 59)\ncontacts_df_152 = contacts_df_152.replace(138, 74)\ncontacts_df_152 = contacts_df_152.replace(257, 193)\ncontacts_df_152 = contacts_df_152.replace(258, 194)\ncontacts_df_152 = contacts_df_152.replace(276, 212)\ncontacts_df_152 = contacts_df_152.replace(296, 232)\ncontacts_df_152 = contacts_df_152.replace(299, 235)\ncontacts_df_152 = contacts_df_152.replace(297, 233)\n\ncontacts_df_152 = contacts_df_152.assign(site_label = lambda x: x['wildtype'] + x['site'].astype(str))\n\ncontacts_df_152\n\n\n\n\n\n\n\n\nsite\nwildtype\nmutation\nmutdiffsel\nsite_label\n\n\n\n\n7484\n11\nA\nA\nNaN\nA11\n\n\n1719\n11\nA\nC\n0.000583\nA11\n\n\n1720\n11\nA\nD\n0.000583\nA11\n\n\n1727\n11\nA\nE\n0.000583\nA11\n\n\n1717\n11\nA\nF\n0.000583\nA11\n\n\n...\n...\n...\n...\n...\n...\n\n\n3143\n235\nW\nS\n0.000007\nW235\n\n\n3144\n235\nW\nT\n0.000007\nW235\n\n\n3145\n235\nW\nV\n0.000007\nW235\n\n\n7708\n235\nW\nW\nNaN\nW235\n\n\n3141\n235\nW\nY\n0.000007\nW235\n\n\n\n\n180 rows × 5 columns\n\n\n\n\nzoomed_df_265 = (data_chk265.loc[data_chk265['site'].isin(sites)]\n                )\n\nzoomed_df_265 = zoomed_df_265.replace(143, 79)\nzoomed_df_265 = zoomed_df_265.replace(305, 241)\nzoomed_df_265 = zoomed_df_265.replace(139, 75)\nzoomed_df_265 = zoomed_df_265.replace(243, 179)\nzoomed_df_265 = zoomed_df_265.replace(283, 219)\n\nzoomed_df_265 = zoomed_df_265.assign(site_label = lambda x: x['wildtype'] + x['site'].astype(str))\n\nzoomed_df_265\n\n\n\n\n\n\n\n\nsite\nwildtype\nmutation\nmutdiffsel\nsite_label\n\n\n\n\n6666\n40\nD\nA\n-0.402091\nD40\n\n\n5\n40\nD\nC\n5.670516\nD40\n\n\n7449\n40\nD\nD\nNaN\nD40\n\n\n5831\n40\nD\nE\n-0.035732\nD40\n\n\n211\n40\nD\nF\n0.952949\nD40\n\n\n...\n...\n...\n...\n...\n...\n\n\n7260\n241\nL\nS\n-2.836240\nL241\n\n\n7001\n241\nL\nT\n-1.007714\nL241\n\n\n5571\n241\nL\nV\n-0.001727\nL241\n\n\n6378\n241\nL\nW\n-0.226428\nL241\n\n\n802\n241\nL\nY\n0.212435\nL241\n\n\n\n\n140 rows × 5 columns\n\n\n\n\ncontacts_df_265 = (data_chk265.loc[data_chk265['site'].isin(sites265)]\n                )\n\ncontacts_df_265 = contacts_df_265.replace(88,24)\ncontacts_df_265 = contacts_df_265.replace(90,26)\ncontacts_df_265 = contacts_df_265.replace(91,27)\ncontacts_df_265 = contacts_df_265.replace(92,28)\ncontacts_df_265 = contacts_df_265.replace(93,29)\ncontacts_df_265 = contacts_df_265.replace(121,57)\ncontacts_df_265 = contacts_df_265.replace(122,58)\ncontacts_df_265 = contacts_df_265.replace(123,59)\ncontacts_df_265 = contacts_df_265.replace(128,64)\ncontacts_df_265 = contacts_df_265.replace(129,65)\ncontacts_df_265 = contacts_df_265.replace(136,72)\ncontacts_df_265 = contacts_df_265.replace(137,73)\ncontacts_df_265 = contacts_df_265.replace(138,74)\ncontacts_df_265 = contacts_df_265.replace(141,77)\ncontacts_df_265 = contacts_df_265.replace(143,79)\ncontacts_df_265 = contacts_df_265.replace(145,81)\ncontacts_df_265 = contacts_df_265.replace(146,82)\ncontacts_df_265 = contacts_df_265.replace(148,84)\ncontacts_df_265 = contacts_df_265.replace(150,86)\ncontacts_df_265 = contacts_df_265.replace(152,88)\ncontacts_df_265 = contacts_df_265.replace(154,90)\ncontacts_df_265 = contacts_df_265.replace(156,92)\ncontacts_df_265 = contacts_df_265.replace(157,93)\ncontacts_df_265 = contacts_df_265.replace(168,104)\ncontacts_df_265 = contacts_df_265.replace(171,107)\ncontacts_df_265 = contacts_df_265.replace(173,109)\ncontacts_df_265 = contacts_df_265.replace(174,110)\ncontacts_df_265 = contacts_df_265.replace(183,119)\ncontacts_df_265 = contacts_df_265.replace(184,120)\ncontacts_df_265 = contacts_df_265.replace(185,121)\ncontacts_df_265 = contacts_df_265.replace(186,122)\ncontacts_df_265 = contacts_df_265.replace(247,183)\ncontacts_df_265 = contacts_df_265.replace(248,184)\ncontacts_df_265 = contacts_df_265.replace(249,185)\ncontacts_df_265 = contacts_df_265.replace(250,186)\ncontacts_df_265 = contacts_df_265.replace(251,187)\ncontacts_df_265 = contacts_df_265.replace(253,189)\ncontacts_df_265 = contacts_df_265.replace(254,190)\ncontacts_df_265 = contacts_df_265.replace(257,193)\ncontacts_df_265 = contacts_df_265.replace(258,194)\ncontacts_df_265 = contacts_df_265.replace(261,197)\ncontacts_df_265 = contacts_df_265.replace(263,199)\ncontacts_df_265 = contacts_df_265.replace(267,203)\ncontacts_df_265 = contacts_df_265.replace(268,204)\ncontacts_df_265 = contacts_df_265.replace(269,205)\ncontacts_df_265 = contacts_df_265.replace(270,206)\ncontacts_df_265 = contacts_df_265.replace(272,208)\ncontacts_df_265 = contacts_df_265.replace(273,209)\ncontacts_df_265 = contacts_df_265.replace(274,210)\ncontacts_df_265 = contacts_df_265.replace(276,212)\ncontacts_df_265 = contacts_df_265.replace(277,213)\ncontacts_df_265 = contacts_df_265.replace(278,214)\ncontacts_df_265 = contacts_df_265.replace(279,215)\ncontacts_df_265 = contacts_df_265.replace(280,216)\ncontacts_df_265 = contacts_df_265.replace(281,217)\ncontacts_df_265 = contacts_df_265.replace(282,218)\ncontacts_df_265 = contacts_df_265.replace(283,219)\ncontacts_df_265 = contacts_df_265.replace(284,220)\ncontacts_df_265 = contacts_df_265.replace(285,221)\n\ncontacts_df_265 = contacts_df_265.assign(site_label = lambda x: x['wildtype'] + x['site'].astype(str))\n\ncontacts_df_265\n\n\n\n\n\n\n\n\nsite\nwildtype\nmutation\nmutdiffsel\nsite_label\n\n\n\n\n6171\n24\nE\nA\n-0.138181\nE24\n\n\n6693\n24\nE\nC\n-0.422121\nE24\n\n\n5313\n24\nE\nD\n-0.000595\nE24\n\n\n7497\n24\nE\nE\nNaN\nE24\n\n\n5670\n24\nE\nF\n-0.006693\nE24\n\n\n...\n...\n...\n...\n...\n...\n\n\n213\n221\nK\nS\n0.928970\nK221\n\n\n1615\n221\nK\nT\n0.000731\nK221\n\n\n5595\n221\nK\nV\n-0.002103\nK221\n\n\n1616\n221\nK\nW\n0.000731\nK221\n\n\n1617\n221\nK\nY\n0.000731\nK221\n\n\n\n\n1180 rows × 5 columns\n\n\n\n\n# Exclude all non positive mutdiffsel scores\nzoomed_df_11['mutdiffsel'] = zoomed_df_11['mutdiffsel'].mask(zoomed_df_11['mutdiffsel'].lt(0),0)\n\nzoomed_df_152['mutdiffsel'] = zoomed_df_152['mutdiffsel'].mask(zoomed_df_152['mutdiffsel'].lt(0),0)\n\ncontacts_df_152['mutdiffsel'] = contacts_df_152['mutdiffsel'].mask(contacts_df_152['mutdiffsel'].lt(0),0)\n\nzoomed_df_265['mutdiffsel'] = zoomed_df_265['mutdiffsel'].mask(zoomed_df_265['mutdiffsel'].lt(0),0)\n\ncontacts_df_265['mutdiffsel'] = contacts_df_265['mutdiffsel'].mask(contacts_df_265['mutdiffsel'].lt(0),0)\n\n\ncontacts_df_265_adom = contacts_df_265[contacts_df_265['site'] &lt;= 134]\ncontacts_df_265_bdom = contacts_df_265[contacts_df_265['site'] &gt;= 135]\n\ncontacts_df_265_adom\n\n\n\n\n\n\n\n\nsite\nwildtype\nmutation\nmutdiffsel\nsite_label\n\n\n\n\n6171\n24\nE\nA\n0.000000\nE24\n\n\n6693\n24\nE\nC\n0.000000\nE24\n\n\n5313\n24\nE\nD\n0.000000\nE24\n\n\n7497\n24\nE\nE\nNaN\nE24\n\n\n5670\n24\nE\nF\n0.000000\nE24\n\n\n...\n...\n...\n...\n...\n...\n\n\n7595\n122\nS\nS\nNaN\nS122\n\n\n6271\n122\nS\nT\n0.000000\nS122\n\n\n6751\n122\nS\nV\n0.000000\nS122\n\n\n6414\n122\nS\nW\n0.000000\nS122\n\n\n1155\n122\nS\nY\n0.087626\nS122\n\n\n\n\n620 rows × 5 columns\n\n\n\n\ncontacts_df_265_bdom\n\n\n\n\n\n\n\n\nsite\nwildtype\nmutation\nmutdiffsel\nsite_label\n\n\n\n\n1774\n183\nQ\nA\n0.000491\nQ183\n\n\n6480\n183\nQ\nC\n0.000000\nQ183\n\n\n1775\n183\nQ\nD\n0.000491\nQ183\n\n\n263\n183\nQ\nE\n0.659820\nQ183\n\n\n1776\n183\nQ\nF\n0.000491\nQ183\n\n\n...\n...\n...\n...\n...\n...\n\n\n213\n221\nK\nS\n0.928970\nK221\n\n\n1615\n221\nK\nT\n0.000731\nK221\n\n\n5595\n221\nK\nV\n0.000000\nK221\n\n\n1616\n221\nK\nW\n0.000731\nK221\n\n\n1617\n221\nK\nY\n0.000731\nK221\n\n\n\n\n560 rows × 5 columns\n\n\n\n\n# Append antibody/domain info to each dataframe then combine\n## ZOOMED\nzoomed_df_11['antibody'] = 'CHK-11'\nzoomed_df_152['antibody'] = 'CHK-152'\nzoomed_df_265['antibody'] = 'CHK-265'\n\ndisplay(zoomed_df_11)\ndisplay(zoomed_df_152)\ndisplay(zoomed_df_265)\n\n\n\n\n\n\n\n\nsite\nwildtype\nmutation\nmutdiffsel\nsite_label\nantibody\n\n\n\n\n6804\n40\nD\nA\n0.000000\nD40\nCHK-11\n\n\n126\n40\nD\nC\n2.386392\nD40\nCHK-11\n\n\n6330\n40\nD\nE\n0.000000\nD40\nCHK-11\n\n\n5768\n40\nD\nF\n0.000000\nD40\nCHK-11\n\n\n392\n40\nD\nG\n0.457301\nD40\nCHK-11\n\n\n...\n...\n...\n...\n...\n...\n...\n\n\n6071\n241\nL\nS\n0.000000\nL241\nCHK-11\n\n\n6959\n241\nL\nT\n0.000000\nL241\nCHK-11\n\n\n6043\n241\nL\nV\n0.000000\nL241\nCHK-11\n\n\n6734\n241\nL\nW\n0.000000\nL241\nCHK-11\n\n\n1016\n241\nL\nY\n0.123828\nL241\nCHK-11\n\n\n\n\n133 rows × 6 columns\n\n\n\n\n\n\n\n\n\n\nsite\nwildtype\nmutation\nmutdiffsel\nsite_label\nantibody\n\n\n\n\n6850\n40\nD\nA\n0.000000\nD40\nCHK-152\n\n\n4009\n40\nD\nC\n0.000000\nD40\nCHK-152\n\n\n7449\n40\nD\nD\nNaN\nD40\nCHK-152\n\n\n641\n40\nD\nE\n0.344012\nD40\nCHK-152\n\n\n7056\n40\nD\nF\n0.000000\nD40\nCHK-152\n\n\n...\n...\n...\n...\n...\n...\n...\n\n\n7140\n241\nL\nS\n0.000000\nL241\nCHK-152\n\n\n6844\n241\nL\nT\n0.000000\nL241\nCHK-152\n\n\n498\n241\nL\nV\n0.460759\nL241\nCHK-152\n\n\n788\n241\nL\nW\n0.257530\nL241\nCHK-152\n\n\n751\n241\nL\nY\n0.281082\nL241\nCHK-152\n\n\n\n\n140 rows × 6 columns\n\n\n\n\n\n\n\n\n\n\nsite\nwildtype\nmutation\nmutdiffsel\nsite_label\nantibody\n\n\n\n\n6666\n40\nD\nA\n0.000000\nD40\nCHK-265\n\n\n5\n40\nD\nC\n5.670516\nD40\nCHK-265\n\n\n7449\n40\nD\nD\nNaN\nD40\nCHK-265\n\n\n5831\n40\nD\nE\n0.000000\nD40\nCHK-265\n\n\n211\n40\nD\nF\n0.952949\nD40\nCHK-265\n\n\n...\n...\n...\n...\n...\n...\n...\n\n\n7260\n241\nL\nS\n0.000000\nL241\nCHK-265\n\n\n7001\n241\nL\nT\n0.000000\nL241\nCHK-265\n\n\n5571\n241\nL\nV\n0.000000\nL241\nCHK-265\n\n\n6378\n241\nL\nW\n0.000000\nL241\nCHK-265\n\n\n802\n241\nL\nY\n0.212435\nL241\nCHK-265\n\n\n\n\n140 rows × 6 columns\n\n\n\n\nzoomed_df_concat = pd.concat([zoomed_df_11, zoomed_df_152, zoomed_df_265], axis = 0)\nprint(\"After merging:\")\ndisplay(zoomed_df_concat)\n\nAfter merging:\n\n\n\n\n\n\n\n\n\nsite\nwildtype\nmutation\nmutdiffsel\nsite_label\nantibody\n\n\n\n\n6804\n40\nD\nA\n0.000000\nD40\nCHK-11\n\n\n126\n40\nD\nC\n2.386392\nD40\nCHK-11\n\n\n6330\n40\nD\nE\n0.000000\nD40\nCHK-11\n\n\n5768\n40\nD\nF\n0.000000\nD40\nCHK-11\n\n\n392\n40\nD\nG\n0.457301\nD40\nCHK-11\n\n\n...\n...\n...\n...\n...\n...\n...\n\n\n7260\n241\nL\nS\n0.000000\nL241\nCHK-265\n\n\n7001\n241\nL\nT\n0.000000\nL241\nCHK-265\n\n\n5571\n241\nL\nV\n0.000000\nL241\nCHK-265\n\n\n6378\n241\nL\nW\n0.000000\nL241\nCHK-265\n\n\n802\n241\nL\nY\n0.212435\nL241\nCHK-265\n\n\n\n\n413 rows × 6 columns\n\n\n\n\n# Append antibody/domain info to each dataframe then combine\n# CONTACTS\ncontacts_df_152['antibody'] = 'CHK-152'\ncontacts_df_265_adom['antibody'] = 'CHK-265 (A domain)'\ncontacts_df_265_bdom['antibody'] = 'CHK-265 (B domain)'\n\ndisplay(contacts_df_152)\ndisplay(contacts_df_265_adom)\ndisplay(contacts_df_265_bdom)\n\n/var/folders/42/lk7h5l9s4gg49b0x2tkpx0kh0000gn/T/ipykernel_39358/4275625501.py:4: SettingWithCopyWarning: \nA value is trying to be set on a copy of a slice from a DataFrame.\nTry using .loc[row_indexer,col_indexer] = value instead\n\nSee the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n  contacts_df_265_adom['antibody'] = 'CHK-265 (A domain)'\n/var/folders/42/lk7h5l9s4gg49b0x2tkpx0kh0000gn/T/ipykernel_39358/4275625501.py:5: SettingWithCopyWarning: \nA value is trying to be set on a copy of a slice from a DataFrame.\nTry using .loc[row_indexer,col_indexer] = value instead\n\nSee the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n  contacts_df_265_bdom['antibody'] = 'CHK-265 (B domain)'\n\n\n\n\n\n\n\n\n\nsite\nwildtype\nmutation\nmutdiffsel\nsite_label\nantibody\n\n\n\n\n7484\n11\nA\nA\nNaN\nA11\nCHK-152\n\n\n1719\n11\nA\nC\n0.000583\nA11\nCHK-152\n\n\n1720\n11\nA\nD\n0.000583\nA11\nCHK-152\n\n\n1727\n11\nA\nE\n0.000583\nA11\nCHK-152\n\n\n1717\n11\nA\nF\n0.000583\nA11\nCHK-152\n\n\n...\n...\n...\n...\n...\n...\n...\n\n\n3143\n235\nW\nS\n0.000007\nW235\nCHK-152\n\n\n3144\n235\nW\nT\n0.000007\nW235\nCHK-152\n\n\n3145\n235\nW\nV\n0.000007\nW235\nCHK-152\n\n\n7708\n235\nW\nW\nNaN\nW235\nCHK-152\n\n\n3141\n235\nW\nY\n0.000007\nW235\nCHK-152\n\n\n\n\n180 rows × 6 columns\n\n\n\n\n\n\n\n\n\n\nsite\nwildtype\nmutation\nmutdiffsel\nsite_label\nantibody\n\n\n\n\n6171\n24\nE\nA\n0.000000\nE24\nCHK-265 (A domain)\n\n\n6693\n24\nE\nC\n0.000000\nE24\nCHK-265 (A domain)\n\n\n5313\n24\nE\nD\n0.000000\nE24\nCHK-265 (A domain)\n\n\n7497\n24\nE\nE\nNaN\nE24\nCHK-265 (A domain)\n\n\n5670\n24\nE\nF\n0.000000\nE24\nCHK-265 (A domain)\n\n\n...\n...\n...\n...\n...\n...\n...\n\n\n7595\n122\nS\nS\nNaN\nS122\nCHK-265 (A domain)\n\n\n6271\n122\nS\nT\n0.000000\nS122\nCHK-265 (A domain)\n\n\n6751\n122\nS\nV\n0.000000\nS122\nCHK-265 (A domain)\n\n\n6414\n122\nS\nW\n0.000000\nS122\nCHK-265 (A domain)\n\n\n1155\n122\nS\nY\n0.087626\nS122\nCHK-265 (A domain)\n\n\n\n\n620 rows × 6 columns\n\n\n\n\n\n\n\n\n\n\nsite\nwildtype\nmutation\nmutdiffsel\nsite_label\nantibody\n\n\n\n\n1774\n183\nQ\nA\n0.000491\nQ183\nCHK-265 (B domain)\n\n\n6480\n183\nQ\nC\n0.000000\nQ183\nCHK-265 (B domain)\n\n\n1775\n183\nQ\nD\n0.000491\nQ183\nCHK-265 (B domain)\n\n\n263\n183\nQ\nE\n0.659820\nQ183\nCHK-265 (B domain)\n\n\n1776\n183\nQ\nF\n0.000491\nQ183\nCHK-265 (B domain)\n\n\n...\n...\n...\n...\n...\n...\n...\n\n\n213\n221\nK\nS\n0.928970\nK221\nCHK-265 (B domain)\n\n\n1615\n221\nK\nT\n0.000731\nK221\nCHK-265 (B domain)\n\n\n5595\n221\nK\nV\n0.000000\nK221\nCHK-265 (B domain)\n\n\n1616\n221\nK\nW\n0.000731\nK221\nCHK-265 (B domain)\n\n\n1617\n221\nK\nY\n0.000731\nK221\nCHK-265 (B domain)\n\n\n\n\n560 rows × 6 columns\n\n\n\n\ncontacts_df_concat = pd.concat([contacts_df_152, contacts_df_265_adom, contacts_df_265_bdom], axis = 0)\nprint(\"After merging:\")\ndisplay(contacts_df_concat)\n\nAfter merging:\n\n\n\n\n\n\n\n\n\nsite\nwildtype\nmutation\nmutdiffsel\nsite_label\nantibody\n\n\n\n\n7484\n11\nA\nA\nNaN\nA11\nCHK-152\n\n\n1719\n11\nA\nC\n0.000583\nA11\nCHK-152\n\n\n1720\n11\nA\nD\n0.000583\nA11\nCHK-152\n\n\n1727\n11\nA\nE\n0.000583\nA11\nCHK-152\n\n\n1717\n11\nA\nF\n0.000583\nA11\nCHK-152\n\n\n...\n...\n...\n...\n...\n...\n...\n\n\n213\n221\nK\nS\n0.928970\nK221\nCHK-265 (B domain)\n\n\n1615\n221\nK\nT\n0.000731\nK221\nCHK-265 (B domain)\n\n\n5595\n221\nK\nV\n0.000000\nK221\nCHK-265 (B domain)\n\n\n1616\n221\nK\nW\n0.000731\nK221\nCHK-265 (B domain)\n\n\n1617\n221\nK\nY\n0.000731\nK221\nCHK-265 (B domain)\n\n\n\n\n1360 rows × 6 columns\n\n\n\n\n\nPlot logoplots using dmslogo\n\n# Draw logoplot for each antibody\nylim_setter = dmslogo.utils.AxLimSetter(min_upperlim=16)\n\nfig, axes = dmslogo.draw_logo(\n        data=zoomed_df_11,\n        x_col='site',\n        letter_col='mutation',\n        letter_height_col='mutdiffsel',\n        addbreaks=True,\n        xtick_col='site_label',\n        ylabel = 'differential selection\\nscore (log$_{2}$)',\n        xlabel = 'mutation site',\n        title = \"CHK-11\",\n        ylim_setter = ylim_setter\n        # colorscheme = colorwheel\n    )\n\n\n\n\n\n\n\n\n\n# Export image to png file\noutputdir = \"output_files\"\nos.makedirs(outputdir, exist_ok=True)\npngfile = os.path.join(outputdir, \"chk11_all_newaxis.png\")\n\nprint(f\"Saving figure to {pngfile}\")\nfig.savefig(pngfile, dpi=450, bbox_inches=\"tight\")\n\nprint(f\"Here is a rendering of the saved figure:\")\ndisplay(Image(pngfile, width=200))\n\nSaving figure to output_files/chk11_all_newaxis.png\nHere is a rendering of the saved figure:\n\n\n\n\n\n\n\n\n\n\nfig, axes = dmslogo.draw_logo(\n        data=zoomed_df_152,\n        x_col='site',\n        letter_col='mutation',\n        letter_height_col='mutdiffsel',\n        addbreaks=True,\n        xtick_col='site_label',\n        ylabel = 'differential selection\\nscore (log$_{2}$)',\n        xlabel = 'mutation site',\n        title = \"CHK-152\",\n        ylim_setter = ylim_setter\n        # colorscheme = colorwheel\n    )\n\n\n\n\n\n\n\n\n\noutputdir = \"output_files\"\nos.makedirs(outputdir, exist_ok=True)\npngfile = os.path.join(outputdir, \"chk152_all_newaxis.png\")\n\nprint(f\"Saving figure to {pngfile}\")\nfig.savefig(pngfile, dpi=450, bbox_inches=\"tight\")\n\nprint(f\"Here is a rendering of the saved figure:\")\ndisplay(Image(pngfile, width=200))\n\nSaving figure to output_files/chk152_all_newaxis.png\nHere is a rendering of the saved figure:\n\n\n\n\n\n\n\n\n\n\nfig, axes = dmslogo.draw_logo(\n        data=contacts_df_152,\n        x_col='site',\n        letter_col='mutation',\n        letter_height_col='mutdiffsel',\n        addbreaks=True,\n        xtick_col='site_label',\n        ylabel = 'differential selection\\nscore (log$_{2}$)',\n        xlabel = 'published site',\n        title = \"CHK-152\",\n        ylim_setter = ylim_setter\n        # colorscheme = colorwheel\n    )\n\n\n\n\n\n\n\n\n\n# Export image to png file\noutputdir = \"output_files\"\nos.makedirs(outputdir, exist_ok=True)\npngfile = os.path.join(outputdir, \"chk152_contacts_newaxis.png\")\n\nprint(f\"Saving figure to {pngfile}\")\nfig.savefig(pngfile, dpi=450, bbox_inches=\"tight\")\n\nprint(f\"Here is a rendering of the saved figure:\")\ndisplay(Image(pngfile, width=200))\n\nSaving figure to output_files/chk152_contacts_newaxis.png\nHere is a rendering of the saved figure:\n\n\n\n\n\n\n\n\n\n\nfig, axes = dmslogo.draw_logo(\n        data=zoomed_df_265,\n        x_col='site',\n        letter_col='mutation',\n        letter_height_col='mutdiffsel',\n        addbreaks=True,\n        xtick_col='site_label',\n        ylabel = 'differential selection\\nscore (log$_{2}$)',\n        xlabel = 'mutation site',\n        title = \"CHK-265\",\n        ylim_setter = ylim_setter\n        # colorscheme = colorwheel\n    )\n\n\n\n\n\n\n\n\n\noutputdir = \"output_files\"\nos.makedirs(outputdir, exist_ok=True)\npngfile = os.path.join(outputdir, \"chk265_all_newaxis.png\")\n\nprint(f\"Saving figure to {pngfile}\")\nfig.savefig(pngfile, dpi=450, bbox_inches=\"tight\")\n\nprint(f\"Here is a rendering of the saved figure:\")\ndisplay(Image(pngfile, width=200))\n\nSaving figure to output_files/chk265_all_newaxis.png\nHere is a rendering of the saved figure:\n\n\n\n\n\n\n\n\n\n\n# Combine into one plot\nfig, axes = dmslogo.facet_plot(\n    data = zoomed_df_concat,\n    gridrow_col = \"antibody\",\n    x_col = \"site\",\n    show_col = None,\n    draw_logo_kwargs={\n        \"letter_col\": \"mutation\",\n        \"letter_height_col\": \"mutdiffsel\",\n        \"xtick_col\": \"site_label\",\n        \"xlabel\": \"mutation site\",\n        \"ylabel\": \"differential selection\\nscore (log$_{2}$)\",\n        \"clip_negative_heights\": True,\n    },\n    share_ylabel = True,\n    share_xlabel = True,\n    share_ylim_across_rows = True,\n)\n\n\n\n\n\n\n\n\n\noutputdir = \"output_files\"\nos.makedirs(outputdir, exist_ok=True)\npngfile = os.path.join(outputdir, \"zoomed_concat_newaxis.png\")\n\nprint(f\"Saving figure to {pngfile}\")\nfig.savefig(pngfile, dpi=450, bbox_inches=\"tight\")\n\nprint(f\"Here is a rendering of the saved figure:\")\ndisplay(Image(pngfile, width=200))\n\nSaving figure to output_files/zoomed_concat_newaxis.png\nHere is a rendering of the saved figure:\n\n\n\n\n\n\n\n\n\n\nfig, axes = dmslogo.draw_logo(\n        data=contacts_df_265_adom,\n        x_col='site',\n        letter_col='mutation',\n        letter_height_col='mutdiffsel',\n        addbreaks=True,\n        xtick_col='site_label',\n        ylabel = 'differential selection\\nscore (log$_{2}$)',\n        xlabel = 'published site',\n        title = \"CHK-265 (A domain)\",\n        ylim_setter = ylim_setter\n        # colorscheme = colorwheel\n    )\n\n\n\n\n\n\n\n\n\noutputdir = \"output_files\"\nos.makedirs(outputdir, exist_ok=True)\npngfile = os.path.join(outputdir, \"chk265_contacts_adom_newaxis.png\")\n\nprint(f\"Saving figure to {pngfile}\")\nfig.savefig(pngfile, dpi=450, bbox_inches=\"tight\")\n\nprint(f\"Here is a rendering of the saved figure:\")\ndisplay(Image(pngfile, width=200))\n\nSaving figure to output_files/chk265_contacts_adom_newaxis.png\nHere is a rendering of the saved figure:\n\n\n\n\n\n\n\n\n\n\nfig, axes = dmslogo.draw_logo(\n        data=contacts_df_265_bdom,\n        x_col='site',\n        letter_col='mutation',\n        letter_height_col='mutdiffsel',\n        addbreaks=True,\n        xtick_col='site_label',\n        ylabel = 'differential selection\\nscore (log$_{2}$)',\n        xlabel = 'published site',\n        title = \"CHK-265 (B domain)\",\n        ylim_setter = ylim_setter\n        # colorscheme = colorwheel\n    )\n\n\n\n\n\n\n\n\n\noutputdir = \"output_files\"\nos.makedirs(outputdir, exist_ok=True)\npngfile = os.path.join(outputdir, \"chk265_contacts_bdom_newaxis.png\")\n\nprint(f\"Saving figure to {pngfile}\")\nfig.savefig(pngfile, dpi=450, bbox_inches=\"tight\")\n\nprint(f\"Here is a rendering of the saved figure:\")\ndisplay(Image(pngfile, width=200))\n\nSaving figure to output_files/chk265_contacts_bdom_newaxis.png\nHere is a rendering of the saved figure:"
  }
]